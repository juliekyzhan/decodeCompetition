<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kunya Zhan">
<meta name="dcterms.date" content="2025-10-28">

<title>descriptive analysis_decodingCompetition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="descriptive analysis_decodingCompetition_files/libs/clipboard/clipboard.min.js"></script>
<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/popper.min.js"></script>
<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/anchor.min.js"></script>
<link href="descriptive analysis_decodingCompetition_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="descriptive analysis_decodingCompetition_files/libs/quarto-html/quarto-syntax-highlighting-fe91322616dd2b9cea8bc6bfc6aa44e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="descriptive analysis_decodingCompetition_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="descriptive analysis_decodingCompetition_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="descriptive analysis_decodingCompetition_files/libs/bootstrap/bootstrap-6f1071c4549ec1672fc8885a20292773.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="descriptive analysis_decodingCompetition_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="descriptive analysis_decodingCompetition_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link active" data-scroll-target="#descriptive-analysis"><span class="header-section-number">1</span> Descriptive Analysis</a></li>
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up"><span class="header-section-number">2</span> Set up</a>
  <ul class="collapse">
  <li><a href="#packages-installing-if-not-already-installed" id="toc-packages-installing-if-not-already-installed" class="nav-link" data-scroll-target="#packages-installing-if-not-already-installed"><span class="header-section-number">2.0.1</span> Packages Installing if not already installed</a></li>
  </ul></li>
  <li><a href="#data-cleansing" id="toc-data-cleansing" class="nav-link" data-scroll-target="#data-cleansing"><span class="header-section-number">3</span> Data cleansing</a>
  <ul class="collapse">
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition"><span class="header-section-number">3.1</span> data acquisition</a></li>
  <li><a href="#matching-variables-and-special-patch" id="toc-matching-variables-and-special-patch" class="nav-link" data-scroll-target="#matching-variables-and-special-patch"><span class="header-section-number">3.2</span> matching variables and special patch</a></li>
  <li><a href="#name-cleansing" id="toc-name-cleansing" class="nav-link" data-scroll-target="#name-cleansing"><span class="header-section-number">3.3</span> name cleansing</a>
  <ul class="collapse">
  <li><a href="#preparing-bioguide-as-matching-map" id="toc-preparing-bioguide-as-matching-map" class="nav-link" data-scroll-target="#preparing-bioguide-as-matching-map"><span class="header-section-number">3.3.1</span> preparing bioguide as matching map</a></li>
  <li><a href="#name-cleansing-adver_sum-legis_sum-and-special-patches" id="toc-name-cleansing-adver_sum-legis_sum-and-special-patches" class="nav-link" data-scroll-target="#name-cleansing-adver_sum-legis_sum-and-special-patches"><span class="header-section-number">3.3.2</span> name cleansing adver_sum &amp; legis_sum and special patches</a></li>
  <li><a href="#name-mapping" id="toc-name-mapping" class="nav-link" data-scroll-target="#name-mapping"><span class="header-section-number">3.3.3</span> name mapping</a></li>
  </ul></li>
  <li><a href="#ideology-update" id="toc-ideology-update" class="nav-link" data-scroll-target="#ideology-update"><span class="header-section-number">3.4</span> ideology update</a></li>
  </ul></li>
  <li><a href="#data-aggregation-and-generation" id="toc-data-aggregation-and-generation" class="nav-link" data-scroll-target="#data-aggregation-and-generation"><span class="header-section-number">4</span> data aggregation and generation</a>
  <ul class="collapse">
  <li><a href="#individual-level-aggregation" id="toc-individual-level-aggregation" class="nav-link" data-scroll-target="#individual-level-aggregation"><span class="header-section-number">4.1</span> individual level aggregation</a></li>
  <li><a href="#topic-level-aggregation" id="toc-topic-level-aggregation" class="nav-link" data-scroll-target="#topic-level-aggregation"><span class="header-section-number">4.2</span> topic level aggregation</a></li>
  </ul></li>
  <li><a href="#overall-descriptive-analysis-for-individual" id="toc-overall-descriptive-analysis-for-individual" class="nav-link" data-scroll-target="#overall-descriptive-analysis-for-individual"><span class="header-section-number">5</span> overall descriptive analysis for individual</a>
  <ul class="collapse">
  <li><a href="#distribution-plots" id="toc-distribution-plots" class="nav-link" data-scroll-target="#distribution-plots"><span class="header-section-number">5.1</span> distribution plots</a></li>
  <li><a href="#distribution-map" id="toc-distribution-map" class="nav-link" data-scroll-target="#distribution-map"><span class="header-section-number">5.2</span> distribution map</a>
  <ul class="collapse">
  <li><a href="#map-dataset-generation-and-cleansing" id="toc-map-dataset-generation-and-cleansing" class="nav-link" data-scroll-target="#map-dataset-generation-and-cleansing"><span class="header-section-number">5.2.1</span> map dataset generation and cleansing</a></li>
  <li><a href="#flip-key-construction" id="toc-flip-key-construction" class="nav-link" data-scroll-target="#flip-key-construction"><span class="header-section-number">5.2.2</span> flip-key construction</a></li>
  <li><a href="#house-map-generation-function" id="toc-house-map-generation-function" class="nav-link" data-scroll-target="#house-map-generation-function"><span class="header-section-number">5.2.3</span> house map generation function</a></li>
  <li><a href="#senate-map-function-need-further-debug" id="toc-senate-map-function-need-further-debug" class="nav-link" data-scroll-target="#senate-map-function-need-further-debug"><span class="header-section-number">5.2.4</span> senate map function (need further debug)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#overall-descriptive-analysis-for-issues" id="toc-overall-descriptive-analysis-for-issues" class="nav-link" data-scroll-target="#overall-descriptive-analysis-for-issues"><span class="header-section-number">6</span> overall descriptive analysis for issues</a>
  <ul class="collapse">
  <li><a href="#analysis-based-on-original-data" id="toc-analysis-based-on-original-data" class="nav-link" data-scroll-target="#analysis-based-on-original-data"><span class="header-section-number">6.1</span> analysis based on original data</a>
  <ul class="collapse">
  <li><a href="#news_data" id="toc-news_data" class="nav-link" data-scroll-target="#news_data"><span class="header-section-number">6.1.1</span> news_data</a></li>
  <li><a href="#bills-data" id="toc-bills-data" class="nav-link" data-scroll-target="#bills-data"><span class="header-section-number">6.1.2</span> bills data</a></li>
  </ul></li>
  <li><a href="#issue-analysis-using-adver_tp-and-legis_tp" id="toc-issue-analysis-using-adver_tp-and-legis_tp" class="nav-link" data-scroll-target="#issue-analysis-using-adver_tp-and-legis_tp"><span class="header-section-number">6.2</span> issue analysis using adver_tp and legis_tp</a>
  <ul class="collapse">
  <li><a href="#issue-heatmap-by-congress" id="toc-issue-heatmap-by-congress" class="nav-link" data-scroll-target="#issue-heatmap-by-congress"><span class="header-section-number">6.2.1</span> issue heatmap by congress</a></li>
  <li><a href="#focal-issue-of-each-congress" id="toc-focal-issue-of-each-congress" class="nav-link" data-scroll-target="#focal-issue-of-each-congress"><span class="header-section-number">6.2.2</span> focal issue of each congress</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lgbm-features-importance-analysis" id="toc-lgbm-features-importance-analysis" class="nav-link" data-scroll-target="#lgbm-features-importance-analysis"><span class="header-section-number">7</span> lgbm features importance analysis</a></li>
  <li><a href="#key-characteristics-analysis" id="toc-key-characteristics-analysis" class="nav-link" data-scroll-target="#key-characteristics-analysis"><span class="header-section-number">8</span> key characteristics analysis</a>
  <ul class="collapse">
  <li><a href="#dependent-variables-is.dom" id="toc-dependent-variables-is.dom" class="nav-link" data-scroll-target="#dependent-variables-is.dom"><span class="header-section-number">8.1</span> dependent variables: is.dom</a>
  <ul class="collapse">
  <li><a href="#data-cleansing-1" id="toc-data-cleansing-1" class="nav-link" data-scroll-target="#data-cleansing-1"><span class="header-section-number">8.1.1</span> data cleansing</a></li>
  <li><a href="#multiple-variables-logit-model" id="toc-multiple-variables-logit-model" class="nav-link" data-scroll-target="#multiple-variables-logit-model"><span class="header-section-number">8.1.2</span> multiple variables logit model</a></li>
  <li><a href="#single-variable-logit-model" id="toc-single-variable-logit-model" class="nav-link" data-scroll-target="#single-variable-logit-model"><span class="header-section-number">8.1.3</span> single variable logit model</a></li>
  </ul></li>
  <li><a href="#dependent-variables-dom_percentage" id="toc-dependent-variables-dom_percentage" class="nav-link" data-scroll-target="#dependent-variables-dom_percentage"><span class="header-section-number">8.2</span> dependent variables: dom_percentage</a>
  <ul class="collapse">
  <li><a href="#multiple-variables-regression-model" id="toc-multiple-variables-regression-model" class="nav-link" data-scroll-target="#multiple-variables-regression-model"><span class="header-section-number">8.2.1</span> multiple variables regression model</a></li>
  <li><a href="#single-variable-regression-model" id="toc-single-variable-regression-model" class="nav-link" data-scroll-target="#single-variable-regression-model"><span class="header-section-number">8.2.2</span> single variable regression model</a></li>
  <li><a href="#robustness-check" id="toc-robustness-check" class="nav-link" data-scroll-target="#robustness-check"><span class="header-section-number">8.2.3</span> robustness check</a></li>
  </ul></li>
  <li><a href="#interaction-model" id="toc-interaction-model" class="nav-link" data-scroll-target="#interaction-model"><span class="header-section-number">8.3</span> interaction model</a>
  <ul class="collapse">
  <li><a href="#dependent-variable-is.dom" id="toc-dependent-variable-is.dom" class="nav-link" data-scroll-target="#dependent-variable-is.dom"><span class="header-section-number">8.3.1</span> dependent variable: is.dom</a></li>
  <li><a href="#dependent-variable-dom_percentage" id="toc-dependent-variable-dom_percentage" class="nav-link" data-scroll-target="#dependent-variable-dom_percentage"><span class="header-section-number">8.3.2</span> dependent variable: dom_percentage</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">descriptive analysis_decodingCompetition</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kunya Zhan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="descriptive-analysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Descriptive Analysis</h1>
<p>This quarto document aims at reorganizing the codes at ‘descriptive analysis 1021.Rmd’. It has two major parts:</p>
<p>1. overall descriptive analysis of original decodeCompetition data;</p>
<p>2. key characteristics identification through regression model and logistic model.</p>
</section>
<section id="set-up" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Set up</h1>
<section id="packages-installing-if-not-already-installed" class="level3" data-number="2.0.1">
<h3 data-number="2.0.1" class="anchored" data-anchor-id="packages-installing-if-not-already-installed"><span class="header-section-number">2.0.1</span> Packages Installing if not already installed</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: dplyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stringr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: readr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: readxl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: scales</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: showtext</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sysfonts</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: showtextdb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: skimr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plm'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, lag, lead</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: glmnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rtsne</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: networkD3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: cluster</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: factoextra</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pROC</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lme4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MuMIn</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: DHARMa</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tigris</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To enable caching of data, set `options(tigris_use_cache = TRUE)`
in your R script or .Rprofile.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggeffects</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stargazer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: htmltools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyverse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ purrr     1.1.0
✔ lubridate 1.9.4     ✔ tibble    3.3.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ plm::between()       masks dplyr::between()
✖ scales::col_factor() masks readr::col_factor()
✖ purrr::discard()     masks scales::discard()
✖ Matrix::expand()     masks tidyr::expand()
✖ dplyr::filter()      masks stats::filter()
✖ plm::lag()           masks dplyr::lag(), stats::lag()
✖ plm::lead()          masks dplyr::lead()
✖ Matrix::pack()       masks tidyr::pack()
✖ car::recode()        masks dplyr::recode()
✖ purrr::some()        masks car::some()
✖ Matrix::unpack()     masks tidyr::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Loading required package: ggcorrplot

Loading required package: broom.mixed

Registered S3 methods overwritten by 'broom':
  method        from 
  nobs.fitdistr MuMIn
  nobs.multinom MuMIn

Loading required package: performance

Loading required package: lattice

Loading required package: fmsb

Registered S3 methods overwritten by 'fmsb':
  method    from
  print.roc pROC
  plot.roc  pROC


Attaching package: 'fmsb'


The following object is masked from 'package:pROC':

    roc


Loading required package: kableExtra


Attaching package: 'kableExtra'


The following object is masked from 'package:dplyr':

    group_rows


Loading required package: broom

Loading required package: knitr

Loading required package: ggnewscale

Loading required package: modelsummary

Loading required package: pscl

Classes and Methods for R originally developed in the
Political Science Computational Laboratory
Department of Political Science
Stanford University (2002-2015),
by and under the direction of Simon Jackman.
hurdle and zeroinfl functions by Achim Zeileis.

Loading required package: ggfortify

Loading required package: rlang


Attaching package: 'rlang'


The following objects are masked from 'package:purrr':

    %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,
    flatten_raw, invoke, splice


Loading required package: patchwork

Loading required package: segmented

Loading required package: MASS


Attaching package: 'MASS'


The following object is masked from 'package:patchwork':

    area


The following object is masked from 'package:dplyr':

    select


Loading required package: nlme


Attaching package: 'nlme'


The following object is masked from 'package:lme4':

    lmList


The following object is masked from 'package:dplyr':

    collapse


Loading required package: tidytext

Loading required package: mgcv

This is mgcv 1.9-3. For overview type 'help("mgcv-package")'.


Attaching package: 'mgcv'


The following object is masked from 'package:nnet':

    multinom


Loading required package: splines

Loading required package: interactions

Loading required package: RColorBrewer

Loading required package: cowplot


Attaching package: 'cowplot'


The following object is masked from 'package:patchwork':

    align_plots


The following object is masked from 'package:lubridate':

    stamp


The following object is masked from 'package:ggeffects':

    get_title


Loading required package: ggbreak

ggbreak v0.1.6 Learn more at https://yulab-smu.top/



If you use ggbreak in published research, please cite the following
paper:

S Xu, M Chen, T Feng, L Zhan, L Zhou, G Yu. Use ggbreak to effectively
utilize plotting space to deal with large datasets and outliers.
Frontiers in Genetics. 2021, 12:774846. doi: 10.3389/fgene.2021.774846

Loading required package: randomcoloR

Loading required package: marginaleffects</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[2]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[3]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[4]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[5]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[6]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[7]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[8]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[9]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[10]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[11]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[12]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[13]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[14]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[15]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[16]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[17]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[18]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[19]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[20]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[21]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[22]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[23]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[24]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[25]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[26]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[27]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[28]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[29]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[30]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[31]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[32]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[33]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[34]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[35]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[36]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[37]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[38]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[39]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[40]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[41]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[42]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[43]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[44]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[45]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[46]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[47]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[48]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[49]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[50]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[51]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[52]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           

[[53]]
 [1] "marginaleffects" "randomcoloR"     "ggbreak"         "cowplot"        
 [5] "RColorBrewer"    "interactions"    "splines"         "mgcv"           
 [9] "tidytext"        "segmented"       "nlme"            "MASS"           
[13] "patchwork"       "rlang"           "ggfortify"       "pscl"           
[17] "modelsummary"    "ggnewscale"      "knitr"           "broom"          
[21] "kableExtra"      "fmsb"            "lattice"         "performance"    
[25] "broom.mixed"     "ggcorrplot"      "lubridate"       "forcats"        
[29] "purrr"           "tibble"          "tidyverse"       "htmltools"      
[33] "stargazer"       "ggeffects"       "tigris"          "DHARMa"         
[37] "nnet"            "MuMIn"           "lme4"            "pROC"           
[41] "factoextra"      "cluster"         "networkD3"       "Rtsne"          
[45] "glmnet"          "Matrix"          "car"             "carData"        
[49] "plm"             "skimr"           "showtext"        "showtextdb"     
[53] "sysfonts"        "scales"          "readxl"          "tidyr"          
[57] "ggplot2"         "readr"           "stringr"         "dplyr"          
[61] "Rcpp"            "stats"           "graphics"        "grDevices"      
[65] "utils"           "datasets"        "methods"         "base"           </code></pre>
</div>
</div>
</section>
</section>
<section id="data-cleansing" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data cleansing</h1>
<section id="data-acquisition" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-acquisition"><span class="header-section-number">3.1</span> data acquisition</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 57600 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (30): issue, state_code, s_committee_tp1, s_committee_tp2, s_committee_t...
dbl (23): leverage, party_tp_score, congress, age, gender, seniority, ideolo...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 47203 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (30): issue, state_code, s_committee_tp1, s_committee_tp2, s_committee_t...
dbl (23): leverage, party_tp_score, congress, age, gender, seniority, ideolo...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 302908 Columns: 25
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (19): bioguide_id, full_name, direct_order_name, chinese_name, chamber, ...
dbl  (6): district, birth_year, death_year, age_at_death, district_congress,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 99 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (5): rank_from_low, rank_from_high, percentile, ideology, id
lgl (1): district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 438 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (6): rank_from_low, rank_from_high, percentile, ideology, id, district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 100 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (5): rank_from_low, rank_from_high, percentile, ideology, id
lgl (1): district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 436 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (6): rank_from_low, rank_from_high, percentile, ideology, id, district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 100 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (5): rank_from_low, rank_from_high, percentile, ideology, id
lgl (1): district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 436 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (6): rank_from_low, rank_from_high, percentile, ideology, id, district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 100 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (5): rank_from_low, rank_from_high, percentile, ideology, id
lgl (1): district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 435 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): bioguide_id, state, name
dbl (6): rank_from_low, rank_from_high, percentile, ideology, id, district

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 37738 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): publish_date, category, issue, mid
dbl (2): new_id, congress

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 8214 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): search_key, type, effective_date, month, bioguide_id, issue
dbl (3): number, congress, year

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="matching-variables-and-special-patch" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="matching-variables-and-special-patch"><span class="header-section-number">3.2</span> matching variables and special patch</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., adver_data_raw %&gt;% dplyr::select(full_name, issue, : Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 37 of `x` matches multiple rows in `y`.
ℹ Row 787 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<section id="special-clean-for-legis_sum-and-legis-data" class="level4" data-number="3.2.0.1">
<h4 data-number="3.2.0.1" class="anchored" data-anchor-id="special-clean-for-legis_sum-and-legis-data"><span class="header-section-number">3.2.0.1</span> special clean for legis_sum and legis data</h4>
</section>
</section>
<section id="name-cleansing" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="name-cleansing"><span class="header-section-number">3.3</span> name cleansing</h2>
<section id="preparing-bioguide-as-matching-map" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="preparing-bioguide-as-matching-map"><span class="header-section-number">3.3.1</span> preparing bioguide as matching map</h3>
<p>name cleansing: addressing issues that some full_name are missing</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Number of remaining missing full_name: 0 </code></pre>
</div>
</div>
<p>district cleansing: matching district code in main databases</p>
<p>age cleansing: create age_to_date to match ages in main database and prepare age_to_congress to replace ages in main databases</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>✅ Age calculation completed.</code></pre>
</div>
</div>
</section>
<section id="name-cleansing-adver_sum-legis_sum-and-special-patches" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="name-cleansing-adver_sum-legis_sum-and-special-patches"><span class="header-section-number">3.3.2</span> name cleansing adver_sum &amp; legis_sum and special patches</h3>
<p>main database name extracting</p>
<section id="special-patches" class="level4" data-number="3.3.2.1">
<h4 data-number="3.3.2.1" class="anchored" data-anchor-id="special-patches"><span class="header-section-number">3.3.2.1</span> * special patches</h4>
<p>The database has a override problem with some congress members. For example, Sen.&nbsp;Blunt Rochester, Lisa [D-DE] was elected as senator in 119th congress, but the database mistakebly override her information before as senator, while she was a representative. Those who are identified will be corrected as a special path in this chuck.</p>
<p>special patch1: patch for “Sen.&nbsp;Blunt Rochester, Lisa [D-DE]”</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ⚠️ 有多个匹配记录，请确认是否需要限制特定 Congress（例如 118）！</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["full_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["congress"],"name":[2],"type":["chr"],"align":["left"]},{"label":["chamber"],"name":[3],"type":["chr"],"align":["left"]},{"label":["district"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["full_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["congress"],"name":[2],"type":["chr"],"align":["left"]},{"label":["chamber"],"name":[3],"type":["chr"],"align":["left"]},{"label":["district"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"115","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"118","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"116","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"},{"1":"Sen. Blunt Rochester, Lisa [D-DE]","2":"117","3":"House of Representatives","4":"At Large"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>special patch2: for congressmen “Sen.&nbsp;Menendez, Robert [D-NJ]” and “Rep.&nbsp;Menendez, Robert [D-NJ-8]”, since they have different eng_name but extracting from full_name cannot automatically discern the difference</p>
</section>
</section>
<section id="name-mapping" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="name-mapping"><span class="header-section-number">3.3.3</span> name mapping</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>🔍 共有 0 组 full_name 缺失记录无法唯一标识议员。</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>📊 总计 unique 组合数： 44 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["congress"],"name":[1],"type":["chr"],"align":["left"]},{"label":["party"],"name":[2],"type":["chr"],"align":["left"]},{"label":["chamber"],"name":[3],"type":["chr"],"align":["left"]},{"label":["state_code"],"name":[4],"type":["chr"],"align":["left"]},{"label":["district"],"name":[5],"type":["chr"],"align":["left"]},{"label":["n_rows"],"name":[6],"type":["int"],"align":["right"]},{"label":["n_issue"],"name":[7],"type":["int"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>define name matching function</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Step 1 matched: 55648 / 57600 
Step 2 matched: 55776 / 57600 
Step 3 (stable key) matched: 57312 / 57600 
Step 4 (normalized + middle name removed) matched: 57600 / 57600 
✅ Bioguide ID matching complete.
Remaining NA bioguide_id: 0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 1 matched: 45294 / 47203 
Step 2 matched: 46483 / 47203 
Step 4 (normalized + middle name removed) matched: 46754 / 47203 
✅ Bioguide ID matching complete.
Remaining NA bioguide_id: 449 </code></pre>
</div>
</div>
<p>address missing name issues</p>
</section>
</section>
<section id="ideology-update" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="ideology-update"><span class="header-section-number">3.4</span> ideology update</h2>
<p>The original ideology data in the main database is standardized. We use ideology data at [GovTrack](<a href="https://www.govtrack.us/about/analysis#ideology" class="uri">https://www.govtrack.us/about/analysis#ideology</a>) to replace them. ref: <a href="http://razor.occams.info/">Tauberer, Joshua</a>. 2012. Observing the Unobservables in the U.S. Congress, presented at Law Via the Internet 2012, Cornell Law School, October 2012.</p>
<p>ideology cleansing</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  115.0   115.0   116.0   116.5   117.0   118.0 </code></pre>
</div>
</div>
<p>ideology merge</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>✅ Merge complete. Remaining NA ideology: 1536 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Merge complete. Remaining NA ideology: 731 </code></pre>
</div>
</div>
<p>ideology missing distribution: missing at random</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>✅ adver_sum1 total missing: 1536 / 57600 

Missing by party:

Democratic Republican 
       448       1088 

Missing by state:

 AL  AZ  CA  CO  FL  GA  IN  KS  LA  MI  MN  MO  MS  MT  NC  ND  NE  NM  NV  NY 
 64 128 192  32  64  96  32  32  32  32  64  32  32  32  32  32  64  32  32  64 
 OH  OK  PA  RI  SC  TX  UT  WI  WV 
 64  32  96  32  32  32  64  32  32 

Missing by chamber:

house of representatives                   senate 
                    1056                      480 

Missing by party x chamber:
            
             house of representatives senate
  Democratic                      256    192
  Republican                      800    288</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ legis_sum1 total missing: 731 / 47203 

Missing by party:

Democratic Republican 
       167        564 

Missing by state:

 AL  AZ  CA  CO  FL  MI  MN  MS  NJ  NM  NY  OH  PA  RI  UT  WI  WV 
 34 101  65  32  32  33  34  33  33  34  70  33  32  33  65  34  33 

Missing by chamber:

house of representatives                   senate 
                     563                      168 

Missing by party x chamber:
            
             house of representatives senate
  Democratic                      133     34
  Republican                      430    134</code></pre>
</div>
</div>
</section>
</section>
<section id="data-aggregation-and-generation" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> data aggregation and generation</h1>
<section id="individual-level-aggregation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="individual-level-aggregation"><span class="header-section-number">4.1</span> individual level aggregation</h2>
<p>generate function: generate_decision_with_traits()</p>
<blockquote class="blockquote">
<p>This function aggregates prediction and importance metrics for each legislator across different datasets, such as train, test,or merged. It computes the relative importance of 3 behavioral modes - intl, dom, and prof, and assigns each legislator a dominant decision category based on their most prominent behavior. It finally merges these aggregated results with demographic and institutional traits like gender, party, and ideology.</p>
</blockquote>
</section>
<section id="topic-level-aggregation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="topic-level-aggregation"><span class="header-section-number">4.2</span> topic level aggregation</h2>
<p>generate function: generate_decision_with_issue()</p>
<blockquote class="blockquote">
<p>This function processes legislative data to summarize each legislator’s issue-level decision pattern (international, domestic, or professional). It groups the data by legislator, Congress session, and issue, aggregates importance scores, and calculates the dominant decision type for each group.</p>
</blockquote>
</section>
</section>
<section id="overall-descriptive-analysis-for-individual" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> overall descriptive analysis for individual</h1>
<p>This block visualizes the distribution of legislators’ decision types (intl/dom/prof) in both adver and legis datasets. It includes overall bar plots and congress-specific facet plots. Additionally, it inspects label distributions across congress, party, chamber, gender, and committee.</p>
<section id="distribution-plots" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="distribution-plots"><span class="header-section-number">5.1</span> distribution plots</h2>
<p>overall</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/overall%20barplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/overall%20barplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>by congress</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adver_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> congress, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen adver"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decision Mode"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number"</span>) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/overall%20barplot%20by%20congress-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(legis_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> congress, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen legis"</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decision Mode"</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number"</span>) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/overall%20barplot%20by%20congress-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-map" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="distribution-map"><span class="header-section-number">5.2</span> distribution map</h2>
<section id="map-dataset-generation-and-cleansing" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="map-dataset-generation-and-cleansing"><span class="header-section-number">5.2.1</span> map dataset generation and cleansing</h3>
<p>district cleansing</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in
unique(adver_cg_heatmap$district[is.na(as.integer(adver_cg_heatmap$district))]):
NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "At Large"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `district_clean = case_when(...)`.
Caused by warning in `sprintf()`:
! NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in
unique(legis_cg_heatmap$district[is.na(as.integer(legis_cg_heatmap$district))]):
NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "At Large"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `district_clean = case_when(...)`.
Caused by warning in `sprintf()`:
! NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
</section>
<section id="flip-key-construction" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="flip-key-construction"><span class="header-section-number">5.2.2</span> flip-key construction</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AL"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CT"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ME"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RI"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CA"</code></pre>
</div>
</div>
</section>
<section id="house-map-generation-function" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="house-map-generation-function"><span class="header-section-number">5.2.3</span> house map generation function</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 115th Congress...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>HTTP download failed, trying FTP as fallback...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 116th Congress...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>HTTP download failed, trying FTP as fallback...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 117th Congress...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 118th Congress...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     
Downloading: 1.9 kB     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>HTTP download failed, trying FTP as fallback...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 115th Congress...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 116th Congress...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 117th Congress...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>🗺️ Loading congressional district map for 118th Congress...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/map%20function-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="senate-map-function-need-further-debug" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="senate-map-function-need-further-debug"><span class="header-section-number">5.2.4</span> senate map function (need further debug)</h3>
</section>
</section>
</section>
<section id="overall-descriptive-analysis-for-issues" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> overall descriptive analysis for issues</h1>
<section id="analysis-based-on-original-data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="analysis-based-on-original-data"><span class="header-section-number">6.1</span> analysis based on original data</h2>
<section id="news_data" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="news_data"><span class="header-section-number">6.1.1</span> news_data</h3>
<p>hereby using original data news_data and bills_data to depict issues</p>
<p>issues have major change on news data from 115th to 118th congress</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RColorBrewer::brewer.pal(n, pal): n too large, allowed maximum for palette Dark2 is 8
Returning the palette you asked for with that many colors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 8 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 8 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<p>trends plot for all issues</p>
<p>issue attention by gender and party</p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["congress"],"name":[1],"type":["int"],"align":["right"]},{"label":["gender"],"name":[2],"type":["fct"],"align":["left"]},{"label":["party"],"name":[3],"type":["chr"],"align":["left"]},{"label":["issue"],"name":[4],"type":["chr"],"align":["left"]},{"label":["total_mentions"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"115","2":"Female","3":"Democratic","4":"Foreign Affairs","5":"150"},{"1":"115","2":"Female","3":"Democratic","4":"International Trade","5":"113"},{"1":"115","2":"Female","3":"Democratic","4":"Congressional political operations","5":"84"},{"1":"115","2":"Female","3":"Democratic","4":"Government Operations and Politics","5":"59"},{"1":"115","2":"Female","3":"Democratic","4":"Civil Rights and Liberties, Minority Issues","5":"38"},{"1":"115","2":"Female","3":"Independent","4":"Immigration","5":"2"},{"1":"115","2":"Female","3":"Independent","4":"Civil Rights and Liberties, Minority Issues","5":"1"},{"1":"115","2":"Female","3":"Independent","4":"Congressional political operations","5":"1"},{"1":"115","2":"Female","3":"Independent","4":"Crime and Law Enforcement","5":"1"},{"1":"115","2":"Female","3":"Independent","4":"Human Rights","5":"1"},{"1":"115","2":"Female","3":"Republican","4":"Foreign Affairs","5":"390"},{"1":"115","2":"Female","3":"Republican","4":"International Trade","5":"183"},{"1":"115","2":"Female","3":"Republican","4":"Congressional political operations","5":"126"},{"1":"115","2":"Female","3":"Republican","4":"Government Operations and Politics","5":"108"},{"1":"115","2":"Female","3":"Republican","4":"Civil Rights and Liberties, Minority Issues","5":"67"},{"1":"115","2":"Male","3":"Democratic","4":"Foreign Affairs","5":"195"},{"1":"115","2":"Male","3":"Democratic","4":"International Trade","5":"127"},{"1":"115","2":"Male","3":"Democratic","4":"Congressional political operations","5":"91"},{"1":"115","2":"Male","3":"Democratic","4":"Government Operations and Politics","5":"44"},{"1":"115","2":"Male","3":"Democratic","4":"National Security","5":"31"},{"1":"115","2":"Male","3":"Independent","4":"Foreign Affairs","5":"14"},{"1":"115","2":"Male","3":"Independent","4":"Congressional political operations","5":"12"},{"1":"115","2":"Male","3":"Independent","4":"International Trade","5":"11"},{"1":"115","2":"Male","3":"Independent","4":"Commerce","5":"10"},{"1":"115","2":"Male","3":"Independent","4":"Government Operations and Politics","5":"7"},{"1":"115","2":"Male","3":"Republican","4":"Foreign Affairs","5":"924"},{"1":"115","2":"Male","3":"Republican","4":"International Trade","5":"389"},{"1":"115","2":"Male","3":"Republican","4":"Human Rights","5":"202"},{"1":"115","2":"Male","3":"Republican","4":"Congressional political operations","5":"186"},{"1":"115","2":"Male","3":"Republican","4":"Government Operations and Politics","5":"158"},{"1":"116","2":"Female","3":"Democratic","4":"Foreign Affairs","5":"317"},{"1":"116","2":"Female","3":"Democratic","4":"Congressional political operations","5":"284"},{"1":"116","2":"Female","3":"Democratic","4":"International Trade","5":"246"},{"1":"116","2":"Female","3":"Democratic","4":"Economics and Public Finance","5":"237"},{"1":"116","2":"Female","3":"Democratic","4":"Government Operations and Politics","5":"172"},{"1":"116","2":"Female","3":"Independent","4":"Congressional political operations","5":"3"},{"1":"116","2":"Female","3":"Independent","4":"Government Operations and Politics","5":"2"},{"1":"116","2":"Female","3":"Independent","4":"Agriculture and Food","5":"1"},{"1":"116","2":"Female","3":"Independent","4":"Armed Forces","5":"1"},{"1":"116","2":"Female","3":"Independent","4":"Foreign Affairs","5":"1"},{"1":"116","2":"Female","3":"Republican","4":"Foreign Affairs","5":"219"},{"1":"116","2":"Female","3":"Republican","4":"Government Operations and Politics","5":"86"},{"1":"116","2":"Female","3":"Republican","4":"International Trade","5":"81"},{"1":"116","2":"Female","3":"Republican","4":"Congressional political operations","5":"78"},{"1":"116","2":"Female","3":"Republican","4":"Economics and Public Finance","5":"24"},{"1":"116","2":"Male","3":"Democratic","4":"Foreign Affairs","5":"275"},{"1":"116","2":"Male","3":"Democratic","4":"Congressional political operations","5":"209"},{"1":"116","2":"Male","3":"Democratic","4":"International Trade","5":"157"},{"1":"116","2":"Male","3":"Democratic","4":"Government Operations and Politics","5":"88"},{"1":"116","2":"Male","3":"Democratic","4":"Human Rights","5":"88"},{"1":"116","2":"Male","3":"Independent","4":"Economics and Public Finance","5":"48"},{"1":"116","2":"Male","3":"Independent","4":"Congressional political operations","5":"39"},{"1":"116","2":"Male","3":"Independent","4":"Foreign Affairs","5":"29"},{"1":"116","2":"Male","3":"Independent","4":"International Trade","5":"26"},{"1":"116","2":"Male","3":"Independent","4":"Health","5":"20"},{"1":"116","2":"Male","3":"Republican","4":"Foreign Affairs","5":"1165"},{"1":"116","2":"Male","3":"Republican","4":"International Trade","5":"640"},{"1":"116","2":"Male","3":"Republican","4":"Government Operations and Politics","5":"502"},{"1":"116","2":"Male","3":"Republican","4":"Congressional political operations","5":"456"},{"1":"116","2":"Male","3":"Republican","4":"Human Rights","5":"294"},{"1":"117","2":"Female","3":"Democratic","4":"Foreign Affairs","5":"1098"},{"1":"117","2":"Female","3":"Democratic","4":"Alliance and Collective Security","5":"273"},{"1":"117","2":"Female","3":"Democratic","4":"Government Operations and Politics","5":"249"},{"1":"117","2":"Female","3":"Democratic","4":"Economics and Public Finance","5":"208"},{"1":"117","2":"Female","3":"Democratic","4":"Armed Forces","5":"190"},{"1":"117","2":"Female","3":"Independent","4":"Foreign Affairs","5":"36"},{"1":"117","2":"Female","3":"Independent","4":"Economics and Public Finance","5":"16"},{"1":"117","2":"Female","3":"Independent","4":"Government Operations and Politics","5":"13"},{"1":"117","2":"Female","3":"Independent","4":"Alliance and Collective Security","5":"11"},{"1":"117","2":"Female","3":"Independent","4":"Congressional political operations","5":"10"},{"1":"117","2":"Female","3":"Republican","4":"Foreign Affairs","5":"159"},{"1":"117","2":"Female","3":"Republican","4":"Congressional political operations","5":"56"},{"1":"117","2":"Female","3":"Republican","4":"Armed Forces","5":"42"},{"1":"117","2":"Female","3":"Republican","4":"Government Operations and Politics","5":"40"},{"1":"117","2":"Female","3":"Republican","4":"Civil Rights and Liberties, Minority Issues","5":"30"},{"1":"117","2":"Male","3":"Democratic","4":"Foreign Affairs","5":"1355"},{"1":"117","2":"Male","3":"Democratic","4":"Alliance and Collective Security","5":"429"},{"1":"117","2":"Male","3":"Democratic","4":"Government Operations and Politics","5":"290"},{"1":"117","2":"Male","3":"Democratic","4":"Armed Forces","5":"220"},{"1":"117","2":"Male","3":"Democratic","4":"International Trade","5":"208"},{"1":"117","2":"Male","3":"Independent","4":"Foreign Affairs","5":"28"},{"1":"117","2":"Male","3":"Independent","4":"Government Operations and Politics","5":"12"},{"1":"117","2":"Male","3":"Independent","4":"International Trade","5":"8"},{"1":"117","2":"Male","3":"Independent","4":"Congressional political operations","5":"3"},{"1":"117","2":"Male","3":"Independent","4":"Armed Forces","5":"2"},{"1":"117","2":"Male","3":"Republican","4":"Foreign Affairs","5":"470"},{"1":"117","2":"Male","3":"Republican","4":"Congressional political operations","5":"216"},{"1":"117","2":"Male","3":"Republican","4":"Armed Forces","5":"188"},{"1":"117","2":"Male","3":"Republican","4":"Economics and Public Finance","5":"158"},{"1":"117","2":"Male","3":"Republican","4":"Government Operations and Politics","5":"139"},{"1":"118","2":"Female","3":"Democratic","4":"Government Operations and Politics","5":"417"},{"1":"118","2":"Female","3":"Democratic","4":"Foreign Affairs","5":"233"},{"1":"118","2":"Female","3":"Democratic","4":"Congressional political operations","5":"132"},{"1":"118","2":"Female","3":"Democratic","4":"International Trade","5":"69"},{"1":"118","2":"Female","3":"Democratic","4":"Civil Rights and Liberties, Minority Issues","5":"56"},{"1":"118","2":"Female","3":"Independent","4":"Congressional political operations","5":"4"},{"1":"118","2":"Female","3":"Independent","4":"Government Operations and Politics","5":"4"},{"1":"118","2":"Female","3":"Independent","4":"Civil Rights and Liberties, Minority Issues","5":"2"},{"1":"118","2":"Female","3":"Independent","4":"Economics and Public Finance","5":"2"},{"1":"118","2":"Female","3":"Independent","4":"Foreign Affairs","5":"2"},{"1":"118","2":"Female","3":"Republican","4":"Government Operations and Politics","5":"58"},{"1":"118","2":"Female","3":"Republican","4":"Congressional political operations","5":"51"},{"1":"118","2":"Female","3":"Republican","4":"Foreign Affairs","5":"50"},{"1":"118","2":"Female","3":"Republican","4":"International Trade","5":"23"},{"1":"118","2":"Female","3":"Republican","4":"Armed Forces","5":"18"},{"1":"118","2":"Male","3":"Democratic","4":"Government Operations and Politics","5":"673"},{"1":"118","2":"Male","3":"Democratic","4":"Foreign Affairs","5":"201"},{"1":"118","2":"Male","3":"Democratic","4":"Congressional political operations","5":"169"},{"1":"118","2":"Male","3":"Democratic","4":"International Trade","5":"80"},{"1":"118","2":"Male","3":"Democratic","4":"Economics and Public Finance","5":"71"},{"1":"118","2":"Male","3":"Independent","4":"Government Operations and Politics","5":"28"},{"1":"118","2":"Male","3":"Independent","4":"Congressional political operations","5":"3"},{"1":"118","2":"Male","3":"Independent","4":"Foreign Affairs","5":"3"},{"1":"118","2":"Male","3":"Independent","4":"Health","5":"3"},{"1":"118","2":"Male","3":"Independent","4":"Civil Rights and Liberties, Minority Issues","5":"1"},{"1":"118","2":"Male","3":"Republican","4":"Foreign Affairs","5":"546"},{"1":"118","2":"Male","3":"Republican","4":"Congressional political operations","5":"390"},{"1":"118","2":"Male","3":"Republican","4":"Government Operations and Politics","5":"243"},{"1":"118","2":"Male","3":"Republican","4":"Economics and Public Finance","5":"197"},{"1":"118","2":"Male","3":"Republican","4":"International Trade","5":"170"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>calculating shanon-entropy for issue news</p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mid"],"name":[1],"type":["chr"],"align":["left"]},{"label":["congress"],"name":[2],"type":["int"],"align":["right"]},{"label":["gender"],"name":[3],"type":["fct"],"align":["left"]},{"label":["chamber"],"name":[4],"type":["chr"],"align":["left"]},{"label":["party"],"name":[5],"type":["chr"],"align":["left"]},{"label":["shannon_entropy"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["n_issues"],"name":[7],"type":["int"],"align":["right"]},{"label":["total_news"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"A000055","2":"115","3":"Male","4":"house of representatives","5":"Republican","6":"0.6931472","7":"2","8":"2"},{"1":"A000055","2":"116","3":"Male","4":"house of representatives","5":"Republican","6":"0.9502705","7":"3","8":"5"},{"1":"A000055","2":"117","3":"Male","4":"house of representatives","5":"Republican","6":"0.0000000","7":"1","8":"1"},{"1":"A000055","2":"118","3":"Male","4":"house of representatives","5":"Republican","6":"1.0986123","7":"3","8":"3"},{"1":"A000148","2":"117","3":"Male","4":"house of representatives","5":"Democratic","6":"1.7478681","7":"6","8":"7"},{"1":"A000148","2":"118","3":"Male","4":"house of representatives","5":"Democratic","6":"1.8594288","7":"8","8":"15"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="bills-data" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="bills-data"><span class="header-section-number">6.1.2</span> bills data</h3>
<p>bills data cleansing</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  search_key            type               number         congress    
 Length:8214        Length:8214        Min.   :    1   Min.   :115.0  
 Class :character   Class :character   1st Qu.:  579   1st Qu.:115.0  
 Mode  :character   Mode  :character   Median : 1627   Median :116.0  
                                       Mean   : 2116   Mean   :116.2  
                                       3rd Qu.: 2878   3rd Qu.:117.0  
                                       Max.   :10559   Max.   :118.0  
 effective_date          year         month           bioguide_id       
 Length:8214        Min.   :2017   Length:8214        Length:8214       
 Class :character   1st Qu.:2018   Class :character   Class :character  
 Mode  :character   Median :2019   Mode  :character   Mode  :character  
                    Mean   :2020                                        
                    3rd Qu.:2021                                        
                    Max.   :2024                                        
    issue             chamber             gender        party          
 Length:8214        Length:8214        Female:2100   Length:8214       
 Class :character   Class :character   Male  :6050   Class :character  
 Mode  :character   Mode  :character   NA's  :  64   Mode  :character  
                                                                       
                                                                       
                                                                       
 committee_el      
 Length:8214       
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64</code></pre>
</div>
</div>
<p>issues have major change on bills data from 115th to 118th congress</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<p>bills trends plot for all issues</p>
<p>calculating shanon-entropy for bills news</p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["bioguide_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["congress"],"name":[2],"type":["int"],"align":["right"]},{"label":["gender"],"name":[3],"type":["fct"],"align":["left"]},{"label":["chamber"],"name":[4],"type":["chr"],"align":["left"]},{"label":["party"],"name":[5],"type":["chr"],"align":["left"]},{"label":["shannon_entropy"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["n_issues"],"name":[7],"type":["int"],"align":["right"]},{"label":["total_news"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"A000055","2":"115","3":"Male","4":"house of representatives","5":"Republican","6":"0.6365142","7":"2","8":"3"},{"1":"A000055","2":"118","3":"Male","4":"house of representatives","5":"Republican","6":"0.6931472","7":"2","8":"2"},{"1":"A000148","2":"117","3":"Male","4":"house of representatives","5":"Democratic","6":"0.0000000","7":"1","8":"1"},{"1":"A000148","2":"118","3":"Male","4":"house of representatives","5":"Democratic","6":"0.0000000","7":"1","8":"1"},{"1":"A000360","2":"115","3":"Male","4":"senate","5":"Republican","6":"1.3862944","7":"4","8":"4"},{"1":"A000360","2":"116","3":"Male","4":"senate","5":"Republican","6":"0.0000000","7":"1","8":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/issues%20shanon%20entropy%20bills-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="issue-analysis-using-adver_tp-and-legis_tp" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="issue-analysis-using-adver_tp-and-legis_tp"><span class="header-section-number">6.2</span> issue analysis using adver_tp and legis_tp</h2>
<section id="issue-heatmap-by-congress" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="issue-heatmap-by-congress"><span class="header-section-number">6.2.1</span> issue heatmap by congress</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/issue%20heatmap%20by%20congress-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/issue%20heatmap%20by%20congress-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="focal-issue-of-each-congress" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="focal-issue-of-each-congress"><span class="header-section-number">6.2.2</span> focal issue of each congress</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/congress%20focal%20issue-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/congress%20focal%20issue-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="lgbm-features-importance-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> lgbm features importance analysis</h1>
</section>
<section id="key-characteristics-analysis" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> key characteristics analysis</h1>
<p>this part will use regression and logistic model to see the key relationship between legislators’ personal characteristics and decision mode</p>
<section id="dependent-variables-is.dom" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="dependent-variables-is.dom"><span class="header-section-number">8.1</span> dependent variables: is.dom</h2>
<section id="data-cleansing-1" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="data-cleansing-1"><span class="header-section-number">8.1.1</span> data cleansing</h3>
<p>check co-linearity</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6297385</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6194612</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  adver_cg$ideology and adver_cg$is.republican
t = 6.2945, df = 1715, p-value = 3.908e-10
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1036999 0.1961806
sample estimates:
      cor 
0.1502689 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(x, y): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  adver_cg$ideology and adver_cg$chamber_numeric
t = NA, df = 1715, p-value = NA
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 NA NA
sample estimates:
cor 
 NA </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20co-linerality%20check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  adver_cg$ideology and adver_cg$gender_numeric
t = -0.45113, df = 1715, p-value = 0.652
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.05816926  0.03643201
sample estimates:
      cor 
-0.010893 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    house of representatives senate
  0                      677    206
  1                      678    204</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(adver_cg$is.republican, adver_cg$chamber)
X-squared = 0.0018725, df = 1, p-value = 0.9655</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    house of representatives senate
  0                      478    185
  1                      511    204</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(legis_cg$is.republican, legis_cg$chamber)
X-squared = 0.039554, df = 1, p-value = 0.8424</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    Female Male
  0    370  513
  1    166  716</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(adver_cg$is.republican, adver_cg$chamber)
X-squared = 0.0018725, df = 1, p-value = 0.9655</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    house of representatives senate
  0                      478    185
  1                      511    204</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  table(legis_cg$is.republican, legis_cg$chamber)
X-squared = 0.039554, df = 1, p-value = 0.8424</code></pre>
</div>
</div>
</section>
<section id="multiple-variables-logit-model" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="multiple-variables-logit-model"><span class="header-section-number">8.1.2</span> multiple variables logit model</h3>
<p>lasso</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.005971891 
11 x 1 sparse Matrix of class "dgCMatrix"
                          lambda.min
(Intercept)            -0.0263980059
age                     0.0002821685
partyIndependent        .           
partyRepublican         0.3810981694
ideology                0.7661366093
chambersenate           0.4941048884
genderMale              0.3015890985
seniority               .           
as.factor(congress)116  .           
as.factor(congress)117 -0.8701101631
as.factor(congress)118 -0.6470542167</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.008080253 
11 x 1 sparse Matrix of class "dgCMatrix"
                          lambda.min
(Intercept)            -0.1353665396
age                     0.0018735138
partyIndependent        0.1233363518
partyRepublican         0.4111702624
ideology                0.8811002768
chambersenate           0.5256631485
genderMale              0.3436337216
seniority               0.0003219995
as.factor(congress)116 -0.0627813196
as.factor(congress)117 -0.9402626330
as.factor(congress)118 -0.7263969240</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.008232385 
11 x 1 sparse Matrix of class "dgCMatrix"
                          lambda.min
(Intercept)            -0.0799889940
age                     0.0009105941
partyIndependent        .           
partyRepublican         0.3876647358
ideology                0.8140246765
chambersenate           0.5013477217
genderMale              0.3132645185
seniority               .           
as.factor(congress)116  .           
as.factor(congress)117 -0.8728871763
as.factor(congress)118 -0.6544692599</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.006762827 
11 x 1 sparse Matrix of class "dgCMatrix"
                         lambda.min
(Intercept)            -0.625931503
age                     0.006151575
partyIndependent        .          
partyRepublican         0.368132620
ideology                0.887929738
chambersenate           0.109400359
genderMale              0.368696619
seniority               .          
as.factor(congress)116  .          
as.factor(congress)117 -1.843580921
as.factor(congress)118 -0.923174195</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.01457007 
11 x 1 sparse Matrix of class "dgCMatrix"
                         lambda.min
(Intercept)            -0.798770373
age                     0.007383310
partyIndependent       -0.233564295
partyRepublican         0.387219692
ideology                1.060662404
chambersenate           0.150593145
genderMale              0.409700533
seniority               0.001865630
as.factor(congress)116  0.004211573
as.factor(congress)117 -1.777932366
as.factor(congress)118 -0.922811674</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20logit%20mul1-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.009322708 
11 x 1 sparse Matrix of class "dgCMatrix"
                          lambda.min
(Intercept)            -0.6833706680
age                     0.0065977136
partyIndependent       -0.0074580459
partyRepublican         0.3748577549
ideology                0.9409294338
chambersenate           0.1217730786
genderMale              0.3808227137
seniority               0.0004725785
as.factor(congress)116  .           
as.factor(congress)117 -1.8199873614
as.factor(congress)118 -0.9217288544</code></pre>
</div>
</div>
<p>set reference</p>
<p>set analysis function to save time</p>
<p>models training - adver</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.732047  1        1.316073
is.republican       1.103038  1        1.050256
ideology            1.167333  1        1.080432
chamber             1.044644  1        1.022079
seniority           1.736523  1        1.317772
gender              1.069513  1        1.034173
as.factor(congress) 1.210926  3        1.032412</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.056902  1        1.028058
chamber             1.025128  1        1.012486
ideology            1.150683  1        1.072699
gender              1.008772  1        1.004376
as.factor(congress) 1.185725  3        1.028799</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.068270  1        1.033572
chamber             1.021733  1        1.010808
is.republican       1.074156  1        1.036415
gender              1.068062  1        1.033471
as.factor(congress) 1.040386  3        1.006620</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.066076  1        1.032509
chamber             1.038343  1        1.018991
is.republican       1.087172  1        1.042676
gender              1.066376  1        1.032655
as.factor(congress) 1.008514  3        1.001414</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.045829  1        1.022658
chamber             1.044352  1        1.021935
ideology            1.151218  1        1.072948
gender              1.009034  1        1.004507
as.factor(congress) 1.151215  3        1.023747</code></pre>
</div>
</div>
<p>models training - legis</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.732047  1        1.316073
is.republican       1.103038  1        1.050256
ideology            1.167333  1        1.080432
chamber             1.044644  1        1.022079
seniority           1.736523  1        1.317772
gender              1.069513  1        1.034173
as.factor(congress) 1.210926  3        1.032412</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.056902  1        1.028058
chamber             1.025128  1        1.012486
ideology            1.150683  1        1.072699
gender              1.008772  1        1.004376
as.factor(congress) 1.185725  3        1.028799</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.068270  1        1.033572
chamber             1.021733  1        1.010808
is.republican       1.074156  1        1.036415
gender              1.068062  1        1.033471
as.factor(congress) 1.040386  3        1.006620</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.066076  1        1.032509
chamber             1.038343  1        1.018991
is.republican       1.087172  1        1.042676
gender              1.066376  1        1.032655
as.factor(congress) 1.008514  3        1.001414</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.045829  1        1.022658
chamber             1.044352  1        1.021935
ideology            1.151218  1        1.072948
gender              1.009034  1        1.004507
as.factor(congress) 1.151215  3        1.023747</code></pre>
</div>
</div>
<section id="residual-check-for-logit-model" class="level4" data-number="8.1.2.1">
<h4 data-number="8.1.2.1" class="anchored" data-anchor-id="residual-check-for-logit-model"><span class="header-section-number">8.1.2.1</span> residual check for logit model</h4>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ 每个模型的所有 predictor 残差图已合并保存至： logit_residual_plots </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "predictor" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ 每个模型的所有 predictor 残差图已合并保存至： logit_residual_plots </code></pre>
</div>
</div>
</section>
</section>
<section id="single-variable-logit-model" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="single-variable-logit-model"><span class="header-section-number">8.1.3</span> single variable logit model</h3>
<p>models training - adver</p>
<p>models training - legis</p>
<p>coefficient plot</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `geom_errobarh()` was deprecated in ggplot2 4.0.0.
ℹ Please use the `orientation` argument of `geom_errorbar()` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`height` was translated to `width`.
`height` was translated to `width`.</code></pre>
</div>
</div>
</section>
</section>
<section id="dependent-variables-dom_percentage" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="dependent-variables-dom_percentage"><span class="header-section-number">8.2</span> dependent variables: dom_percentage</h2>
<section id="multiple-variables-regression-model" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="multiple-variables-regression-model"><span class="header-section-number">8.2.1</span> multiple variables regression model</h3>
<p>lasso</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.0006592697 
10 x 1 sparse Matrix of class "dgCMatrix"
                                  lambda.min
(Intercept)                      0.422711214
age                              .          
is.republican1                   0.010017710
ideology                         0.010591715
chamberhouse of representatives -0.012511715
genderMale                       0.006944198
seniority                        .          
as.factor(congress)116           .          
as.factor(congress)117          -0.028446880
as.factor(congress)118          -0.019553494</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.001074445 
10 x 1 sparse Matrix of class "dgCMatrix"
                                   lambda.min
(Intercept)                      4.255226e-01
age                             -3.636691e-05
is.republican1                   1.074906e-02
ideology                         1.278825e-02
chamberhouse of representatives -1.348836e-02
genderMale                       8.037863e-03
seniority                        7.127434e-05
as.factor(congress)116          -2.029682e-03
as.factor(congress)117          -3.078101e-02
as.factor(congress)118          -2.229444e-02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.001094675 
10 x 1 sparse Matrix of class "dgCMatrix"
                                  lambda.min
(Intercept)                      0.422588825
age                              .          
is.republican1                   0.010068071
ideology                         0.011276334
chamberhouse of representatives -0.012622792
genderMale                       0.007096057
seniority                        .          
as.factor(congress)116           .          
as.factor(congress)117          -0.028352727
as.factor(congress)118          -0.019583034</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.0008087886 
10 x 1 sparse Matrix of class "dgCMatrix"
                                 lambda.min
(Intercept)                      0.38370859
age                              .         
is.republican1                   0.01234021
ideology                         0.02228783
chamberhouse of representatives -0.01172991
genderMale                       0.01261531
seniority                        .         
as.factor(congress)116           .         
as.factor(congress)117          -0.02933386
as.factor(congress)118          -0.02004583</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.001318124 
10 x 1 sparse Matrix of class "dgCMatrix"
                                   lambda.min
(Intercept)                      3.868163e-01
age                             -2.635730e-05
is.republican1                   1.318057e-02
ideology                         2.468504e-02
chamberhouse of representatives -1.309409e-02
genderMale                       1.371822e-02
seniority                        1.472411e-06
as.factor(congress)116          -1.905249e-03
as.factor(congress)117          -3.202688e-02
as.factor(congress)118          -2.311674e-02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20lm%20mul1-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda: 0.001342941 
10 x 1 sparse Matrix of class "dgCMatrix"
                                 lambda.min
(Intercept)                      0.38363575
age                              .         
is.republican1                   0.01239826
ideology                         0.02293626
chamberhouse of representatives -0.01186181
genderMale                       0.01273647
seniority                        .         
as.factor(congress)116           .         
as.factor(congress)117          -0.02928112
as.factor(congress)118          -0.02011796</code></pre>
</div>
</div>
<p>models training - adver</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.732138  1        1.316107
is.republican       1.118637  1        1.057656
ideology            1.176846  1        1.084825
seniority           1.736402  1        1.317726
chamber             1.044211  1        1.021866
gender              1.075858  1        1.037236
as.factor(congress) 1.213252  3        1.032742</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.069899  1        1.034359
is.republican       1.082901  1        1.040625
chamber             1.023249  1        1.011558
gender              1.073721  1        1.036205
as.factor(congress) 1.043332  3        1.007095</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.057399  1        1.028299
ideology            1.151895  1        1.073264
chamber             1.023915  1        1.011887
gender              1.008192  1        1.004088
as.factor(congress) 1.185388  3        1.028751</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.046303  1        1.022890
ideology            1.152278  1        1.073442
chamber             1.043572  1        1.021554
gender              1.008416  1        1.004199
as.factor(congress) 1.151187  3        1.023743</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.066644  1        1.032785
is.republican       1.095841  1        1.046824
chamber             1.040549  1        1.020073
gender              1.072188  1        1.035465
as.factor(congress) 1.010093  3        1.001675</code></pre>
</div>
</div>
<p>models training - legis</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.725935  1        1.313749
is.republican       1.143865  1        1.069516
ideology            1.179116  1        1.085871
seniority           1.721335  1        1.311997
chamber             1.082873  1        1.040612
gender              1.089318  1        1.043704
as.factor(congress) 1.224366  3        1.034313</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.094331  1        1.046103
chamber             1.046055  1        1.022768
gender              1.082881  1        1.040616
is.republican       1.096397  1        1.047090
as.factor(congress) 1.062578  3        1.010168</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
age                 1.085324  1        1.041789
ideology            1.138854  1        1.067171
chamber             1.051897  1        1.025620
gender              1.014645  1        1.007296
as.factor(congress) 1.183086  3        1.028417</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.073702  1        1.036196
ideology            1.140355  1        1.067874
chamber             1.079989  1        1.039225
gender              1.015873  1        1.007905
as.factor(congress) 1.142110  3        1.022393</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
seniority           1.086299  1        1.042257
is.republican       1.105158  1        1.051265
chamber             1.071597  1        1.035180
gender              1.083053  1        1.040698
as.factor(congress) 1.026066  3        1.004298</code></pre>
</div>
</div>
<p>adver_lm0 marginal effects</p>
<p>legis_lm0 marginal effects</p>
</section>
<section id="single-variable-regression-model" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="single-variable-regression-model"><span class="header-section-number">8.2.2</span> single variable regression model</h3>
<p>models training - adver</p>
<p>models training - legis</p>
<p>single variable model coefficient plot</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`height` was translated to `width`.
`height` was translated to `width`.</code></pre>
</div>
</div>
</section>
<section id="robustness-check" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="robustness-check"><span class="header-section-number">8.2.3</span> robustness check</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fortify(&lt;lm&gt;)` was deprecated in ggplot2 3.6.0.
ℹ Please use `broom::augment(&lt;lm&gt;)` instead.
ℹ The deprecated feature was likely used in the ggplot2 package.
  Please report the issue at &lt;https://github.com/tidyverse/ggplot2/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>所有诊断图已保存至： lm_diagnostics_plots </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>所有诊断图已保存至： lm_diagnostics_plots </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>所有诊断图已保存至： lm_diagnostics_plots </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>所有诊断图已保存至： lm_diagnostics_plots </code></pre>
</div>
</div>
</section>
</section>
<section id="interaction-model" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="interaction-model"><span class="header-section-number">8.3</span> interaction model</h2>
<section id="dependent-variable-is.dom" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="dependent-variable-is.dom"><span class="header-section-number">8.3.1</span> dependent variable: is.dom</h3>
<p>adver</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + is.republican + chamber + 
    ideology * gender + as.factor(congress), family = binomial(), 
    data = adver_cg)

Coefficients:
                                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                      0.4754779  0.3814954   1.246   0.2126    
age                              0.0013578  0.0055040   0.247   0.8051    
seniority                        0.0006064  0.0068936   0.088   0.9299    
is.republican1                   0.4188404  0.1065681   3.930 8.49e-05 ***
chamberhouse of representatives -0.5507139  0.1254935  -4.388 1.14e-05 ***
ideology                         1.0044103  0.7026777   1.429   0.1529    
genderMale                       0.3739801  0.1338215   2.795   0.0052 ** 
as.factor(congress)116          -0.1213240  0.1563426  -0.776   0.4377    
as.factor(congress)117          -1.0240996  0.1549761  -6.608 3.89e-11 ***
as.factor(congress)118          -0.8025152  0.1512163  -5.307 1.11e-07 ***
ideology:genderMale             -0.2237474  0.8398577  -0.266   0.7899    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2368.0  on 1716  degrees of freedom
Residual deviance: 2219.4  on 1706  degrees of freedom
  (48 observations deleted due to missingness)
AIC: 2241.4

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term          estimate odds_ratio conf.low.or conf.high.or std.error  p.value
   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)    4.75e-1      1.61        0.762        3.40    0.381   2.13e- 1
 2 age            1.36e-3      1.00        0.991        1.01    0.00550 8.05e- 1
 3 seniority      6.06e-4      1.00        0.987        1.01    0.00689 9.30e- 1
 4 is.republica…  4.19e-1      1.52        1.23         1.87    0.107   8.49e- 5
 5 chamberhouse… -5.51e-1      0.577       0.450        0.736   0.125   1.14e- 5
 6 ideology       1.00e+0      2.73        0.732       11.8     0.703   1.53e- 1
 7 genderMale     3.74e-1      1.45        1.12         1.89    0.134   5.20e- 3
 8 as.factor(co… -1.21e-1      0.886       0.651        1.20    0.156   4.38e- 1
 9 as.factor(co… -1.02e+0      0.359       0.264        0.486   0.155   3.89e-11
10 as.factor(co… -8.03e-1      0.448       0.333        0.602   0.151   1.11e- 7
11 ideology:gen… -2.24e-1      0.800       0.147        4.06    0.840   7.90e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
          llh       llhNull            G2      McFadden          r2ML 
-1.109688e+03 -1.184004e+03  1.486312e+02  6.276634e-02  8.292357e-02 
         r2CU 
 1.108295e-01 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"0.4754778872","3":"1.6087828","4":"0.7622290","5":"3.4030594","6":"0.381495382","7":"2.126349e-01","8":""},{"1":"age","2":"0.0013577827","3":"1.0013587","4":"0.9906149","5":"1.0122303","6":"0.005504040","7":"8.051494e-01","8":""},{"1":"seniority","2":"0.0006063858","3":"1.0006066","4":"0.9871764","5":"1.0142326","6":"0.006893594","7":"9.299056e-01","8":""},{"1":"is.republican1","2":"0.4188403945","3":"1.5201977","4":"1.2339353","5":"1.8740028","6":"0.106568060","7":"8.485336e-05","8":"***"},{"1":"chamberhouse of representatives","2":"-0.5507139379","3":"0.5765381","4":"0.4500374","5":"0.7362381","6":"0.125493499","7":"1.141949e-05","8":"***"},{"1":"ideology","2":"1.0044103069","3":"2.7302968","4":"0.7319939","5":"11.7676804","6":"0.702677696","7":"1.528882e-01","8":""},{"1":"genderMale","2":"0.3739801284","3":"1.4535083","4":"1.1187005","5":"1.8908255","6":"0.133821466","7":"5.196077e-03","8":"**"},{"1":"as.factor(congress)116","2":"-0.1213239878","3":"0.8857469","4":"0.6514712","5":"1.2028509","6":"0.156342643","7":"4.377411e-01","8":""},{"1":"as.factor(congress)117","2":"-1.0240995512","3":"0.3591197","4":"0.2644878","5":"0.4857061","6":"0.154976087","7":"3.892486e-11","8":"***"},{"1":"as.factor(congress)118","2":"-0.8025152270","3":"0.4482002","4":"0.3326642","5":"0.6019591","6":"0.151216316","7":"1.114028e-07","8":"***"},{"1":"ideology:genderMale","2":"-0.2237473882","3":"0.7995171","4":"0.1474095","5":"4.0557830","6":"0.839857650","7":"7.899226e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + is.republican + gender + 
    chamber * ideology + as.factor(congress), family = binomial(), 
    data = adver_cg)

Coefficients:
                                           Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                               0.5680533  0.3960137   1.434 0.151450
age                                       0.0014214  0.0055052   0.258 0.796261
seniority                                 0.0005831  0.0068901   0.085 0.932555
is.republican1                            0.4210620  0.1063693   3.958 7.54e-05
genderMale                                0.3540765  0.1137889   3.112 0.001860
chamberhouse of representatives          -0.6459742  0.1814652  -3.560 0.000371
ideology                                 -0.0583991  1.2993561  -0.045 0.964151
as.factor(congress)116                   -0.1093846  0.1571986  -0.696 0.486531
as.factor(congress)117                   -1.0189194  0.1551325  -6.568 5.10e-11
as.factor(congress)118                   -0.8054487  0.1512087  -5.327 1.00e-07
chamberhouse of representatives:ideology  1.0146212  1.3760601   0.737 0.460917
                                            
(Intercept)                                 
age                                         
seniority                                   
is.republican1                           ***
genderMale                               ** 
chamberhouse of representatives          ***
ideology                                    
as.factor(congress)116                      
as.factor(congress)117                   ***
as.factor(congress)118                   ***
chamberhouse of representatives:ideology    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2368.0  on 1716  degrees of freedom
Residual deviance: 2218.9  on 1706  degrees of freedom
  (48 observations deleted due to missingness)
AIC: 2240.9

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term         estimate odds_ratio conf.low.or conf.high.or std.error   p.value
   &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)   5.68e-1      1.76       0.812         3.84    0.396   1.51 e- 1
 2 age           1.42e-3      1.00       0.991         1.01    0.00551 7.96 e- 1
 3 seniority     5.83e-4      1.00       0.987         1.01    0.00689 9.33 e- 1
 4 is.republic…  4.21e-1      1.52       1.24          1.88    0.106   7.54 e- 5
 5 genderMale    3.54e-1      1.42       1.14          1.78    0.114   1.86 e- 3
 6 chamberhous… -6.46e-1      0.524      0.369         0.756   0.181   3.71 e- 4
 7 ideology     -5.84e-2      0.943      0.0846       16.9     1.30    9.64 e- 1
 8 as.factor(c… -1.09e-1      0.896      0.658         1.22    0.157   4.87 e- 1
 9 as.factor(c… -1.02e+0      0.361      0.266         0.488   0.155   5.10 e-11
10 as.factor(c… -8.05e-1      0.447      0.332         0.600   0.151   1.000e- 7
11 chamberhous…  1.01e+0      2.76       0.136        36.2     1.38    4.61 e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
          llh       llhNull            G2      McFadden          r2ML 
-1.109470e+03 -1.184004e+03  1.490678e+02  6.295071e-02  8.315672e-02 
         r2CU 
 1.111411e-01 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"0.5680533365","3":"1.7648282","4":"0.81182721","5":"3.8382823","6":"0.396013666","7":"1.514500e-01","8":""},{"1":"age","2":"0.0014213845","3":"1.0014224","4":"0.99067584","5":"1.0122972","6":"0.005505199","7":"7.962607e-01","8":""},{"1":"seniority","2":"0.0005831154","3":"1.0005833","4":"0.98716057","5":"1.0142023","6":"0.006890068","7":"9.325545e-01","8":""},{"1":"is.republican1","2":"0.4210620416","3":"1.5235788","4":"1.23717463","5":"1.8774557","6":"0.106369314","7":"7.542458e-05","8":"***"},{"1":"genderMale","2":"0.3540765479","3":"1.4248643","4":"1.14021094","5":"1.7814641","6":"0.113788905","7":"1.860156e-03","8":"**"},{"1":"chamberhouse of representatives","2":"-0.6459741990","3":"0.5241517","4":"0.36872734","5":"0.7556884","6":"0.181465230","7":"3.711819e-04","8":"***"},{"1":"ideology","2":"-0.0583991220","3":"0.9432734","4":"0.08460625","5":"16.9088624","6":"1.299356120","7":"9.641514e-01","8":""},{"1":"as.factor(congress)116","2":"-0.1093846114","3":"0.8963856","4":"0.65815664","5":"1.2192830","6":"0.157198637","7":"4.865310e-01","8":""},{"1":"as.factor(congress)117","2":"-1.0189194360","3":"0.3609848","4":"0.26578131","5":"0.4883814","6":"0.155132500","7":"5.097529e-11","8":"***"},{"1":"as.factor(congress)118","2":"-0.8054486688","3":"0.4468874","4":"0.33169936","5":"0.6001937","6":"0.151208690","7":"9.999371e-08","8":"***"},{"1":"chamberhouse of representatives:ideology","2":"1.0146211999","3":"2.7583183","4":"0.13641044","5":"36.1969908","6":"1.376060095","7":"4.609169e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Error in tidy(): object 'legis_inter3' not found</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Error in tidy(): object 'legis_inter4' not found</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20adver-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of ideology when gender = Female: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  1.00   0.70     1.43   0.15

Slope of ideology when gender = Male: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.78   0.51     1.52   0.13</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20adver-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of ideology when chamber = senate: 

   Est.   S.E.   z val.      p
------- ------ -------- ------
  -0.06   1.30    -0.04   0.96

Slope of ideology when chamber = house of representatives: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.96   0.45     2.10   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20adver-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of is.republican when gender = Female: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.59   0.20     2.89   0.00

Slope of is.republican when gender = Male: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.36   0.12     2.90   0.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.
✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20adver-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data adver_cg from global environment. This could cause incorrect
results if adver_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of is.republican when chamber = senate: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.18   0.22     0.85   0.40

Slope of is.republican when chamber = house of representatives: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.49   0.12     4.08   0.00</code></pre>
</div>
</div>
<p>legis</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + is.republican + chamber + 
    ideology * gender + as.factor(congress), family = binomial(), 
    data = legis_cg)

Coefficients:
                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                     -0.441295   0.451567  -0.977 0.328444    
age                              0.006395   0.006521   0.981 0.326755    
seniority                        0.003224   0.007866   0.410 0.681943    
is.republican1                   0.435763   0.128067   3.403 0.000667 ***
chamberhouse of representatives -0.152993   0.136979  -1.117 0.264036    
ideology                         0.348497   0.696410   0.500 0.616780    
genderMale                       0.340574   0.160708   2.119 0.034073 *  
as.factor(congress)116          -0.130654   0.165539  -0.789 0.429958    
as.factor(congress)117          -2.062271   0.199731 -10.325  &lt; 2e-16 ***
as.factor(congress)118          -1.120000   0.169401  -6.612  3.8e-11 ***
ideology:genderMale              1.084085   0.911807   1.189 0.234463    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1854.8  on 1355  degrees of freedom
Residual deviance: 1628.1  on 1345  degrees of freedom
  (22 observations deleted due to missingness)
AIC: 1650.1

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term          estimate odds_ratio conf.low.or conf.high.or std.error  p.value
   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   -0.441        0.643      0.265         1.56    0.452   3.28e- 1
 2 age            0.00639      1.01       0.994         1.02    0.00652 3.27e- 1
 3 seniority      0.00322      1.00       0.988         1.02    0.00787 6.82e- 1
 4 is.republica…  0.436        1.55       1.20          1.99    0.128   6.67e- 4
 5 chamberhouse… -0.153        0.858      0.656         1.12    0.137   2.64e- 1
 6 ideology       0.348        1.42       0.371         5.86    0.696   6.17e- 1
 7 genderMale     0.341        1.41       1.03          1.93    0.161   3.41e- 2
 8 as.factor(co… -0.131        0.878      0.634         1.21    0.166   4.30e- 1
 9 as.factor(co… -2.06         0.127      0.0853        0.187   0.200   5.42e-25
10 as.factor(co… -1.12         0.326      0.233         0.454   0.169   3.80e-11
11 ideology:gen…  1.08         2.96       0.495        18.1     0.912   2.34e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
         llh      llhNull           G2     McFadden         r2ML         r2CU 
-814.0356639 -927.3852062  226.6990846    0.1222249    0.1539546    0.2065562 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"-0.441294847","3":"0.6432030","4":"0.26490405","5":"1.5572811","6":"0.451566975","7":"3.284443e-01","8":""},{"1":"age","2":"0.006394802","3":"1.0064153","4":"0.99364698","5":"1.0193899","6":"0.006520848","7":"3.267554e-01","8":""},{"1":"seniority","2":"0.003223681","3":"1.0032289","4":"0.98786837","5":"1.0188296","6":"0.007866213","7":"6.819427e-01","8":""},{"1":"is.republican1","2":"0.435763126","3":"1.5461425","4":"1.20380364","5":"1.9892335","6":"0.128067286","7":"6.674529e-04","8":"***"},{"1":"chamberhouse of representatives","2":"-0.152992548","3":"0.8581361","4":"0.65604706","5":"1.1227191","6":"0.136979312","7":"2.640360e-01","8":""},{"1":"ideology","2":"0.348496842","3":"1.4169361","4":"0.37116568","5":"5.8637062","6":"0.696410164","7":"6.167801e-01","8":""},{"1":"genderMale","2":"0.340574345","3":"1.4057547","4":"1.02687190","5":"1.9287925","6":"0.160708078","7":"3.407263e-02","8":"*"},{"1":"as.factor(congress)116","2":"-0.130653702","3":"0.8775216","4":"0.63405717","5":"1.2137269","6":"0.165538928","7":"4.299585e-01","8":""},{"1":"as.factor(congress)117","2":"-2.062271129","3":"0.1271648","4":"0.08533613","5":"0.1868743","6":"0.199731462","7":"5.419486e-25","8":"***"},{"1":"as.factor(congress)118","2":"-1.119999725","3":"0.3262799","4":"0.23348334","5":"0.4537482","6":"0.169401129","7":"3.803820e-11","8":"***"},{"1":"ideology:genderMale","2":"1.084084542","3":"2.9567318","4":"0.49480140","5":"18.1138867","6":"0.911807279","7":"2.344631e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + is.republican * gender + 
    chamber + ideology + as.factor(congress), family = binomial(), 
    data = legis_cg)

Coefficients:
                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                     -0.507166   0.455898  -1.112   0.2659    
age                              0.006341   0.006519   0.973   0.3307    
seniority                        0.003069   0.007884   0.389   0.6971    
is.republican1                   0.464846   0.247064   1.881   0.0599 .  
genderMale                       0.456313   0.176431   2.586   0.0097 ** 
chamberhouse of representatives -0.153413   0.136876  -1.121   0.2624    
ideology                         0.967868   0.481639   2.010   0.0445 *  
as.factor(congress)116          -0.124610   0.165506  -0.753   0.4515    
as.factor(congress)117          -2.060982   0.199739 -10.318  &lt; 2e-16 ***
as.factor(congress)118          -1.106717   0.168842  -6.555 5.57e-11 ***
is.republican1:genderMale       -0.046993   0.283126  -0.166   0.8682    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1854.8  on 1355  degrees of freedom
Residual deviance: 1629.5  on 1345  degrees of freedom
  (22 observations deleted due to missingness)
AIC: 1651.5

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term          estimate odds_ratio conf.low.or conf.high.or std.error  p.value
   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   -0.507        0.602      0.246         1.47    0.456   2.66e- 1
 2 age            0.00634      1.01       0.994         1.02    0.00652 3.31e- 1
 3 seniority      0.00307      1.00       0.988         1.02    0.00788 6.97e- 1
 4 is.republica…  0.465        1.59       0.979         2.58    0.247   5.99e- 2
 5 genderMale     0.456        1.58       1.12          2.23    0.176   9.70e- 3
 6 chamberhouse… -0.153        0.858      0.656         1.12    0.137   2.62e- 1
 7 ideology       0.968        2.63       1.05          7.02    0.482   4.45e- 2
 8 as.factor(co… -0.125        0.883      0.638         1.22    0.166   4.52e- 1
 9 as.factor(co… -2.06         0.127      0.0854        0.187   0.200   5.82e-25
10 as.factor(co… -1.11         0.331      0.237         0.459   0.169   5.57e-11
11 is.republica… -0.0470       0.954      0.548         1.66    0.283   8.68e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
         llh      llhNull           G2     McFadden         r2ML         r2CU 
-814.7310601 -927.3852062  225.3082922    0.1214750    0.1530864    0.2053914 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"-0.507165575","3":"0.6022001","4":"0.24584635","5":"1.4700264","6":"0.455897574","7":"2.659425e-01","8":""},{"1":"age","2":"0.006341117","3":"1.0063613","4":"0.99359703","5":"1.0193306","6":"0.006518842","7":"3.306842e-01","8":""},{"1":"seniority","2":"0.003068717","3":"1.0030734","4":"0.98768060","5":"1.0187069","6":"0.007884008","7":"6.971037e-01","8":""},{"1":"is.republican1","2":"0.464846169","3":"1.5917693","4":"0.97945839","5":"2.5832932","6":"0.247064359","7":"5.990692e-02","8":"."},{"1":"genderMale","2":"0.456313210","3":"1.5782446","4":"1.11852780","5":"2.2346732","6":"0.176430642","7":"9.699548e-03","8":"**"},{"1":"chamberhouse of representatives","2":"-0.153412910","3":"0.8577755","4":"0.65589622","5":"1.1220013","6":"0.136875502","7":"2.623641e-01","8":""},{"1":"ideology","2":"0.967868299","3":"2.6323271","4":"1.05325817","5":"7.0151401","6":"0.481639281","7":"4.448102e-02","8":"*"},{"1":"as.factor(congress)116","2":"-0.124610236","3":"0.8828409","4":"0.63797365","5":"1.2210620","6":"0.165505958","7":"4.515071e-01","8":""},{"1":"as.factor(congress)117","2":"-2.060981824","3":"0.1273289","4":"0.08544503","5":"0.1871182","6":"0.199738856","7":"5.819554e-25","8":"***"},{"1":"as.factor(congress)118","2":"-1.106717024","3":"0.3306427","4":"0.23688473","5":"0.4593472","6":"0.168842109","7":"5.573691e-11","8":"***"},{"1":"is.republican1:genderMale","2":"-0.046992769","3":"0.9540943","4":"0.54810233","5":"1.6644617","6":"0.283125904","7":"8.681740e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + ideology + chamber + 
    is.republican * gender + as.factor(congress), family = binomial(), 
    data = legis_cg)

Coefficients:
                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                     -0.507166   0.455898  -1.112   0.2659    
age                              0.006341   0.006519   0.973   0.3307    
seniority                        0.003069   0.007884   0.389   0.6971    
ideology                         0.967868   0.481639   2.010   0.0445 *  
chamberhouse of representatives -0.153413   0.136876  -1.121   0.2624    
is.republican1                   0.464846   0.247064   1.881   0.0599 .  
genderMale                       0.456313   0.176431   2.586   0.0097 ** 
as.factor(congress)116          -0.124610   0.165506  -0.753   0.4515    
as.factor(congress)117          -2.060982   0.199739 -10.318  &lt; 2e-16 ***
as.factor(congress)118          -1.106717   0.168842  -6.555 5.57e-11 ***
is.republican1:genderMale       -0.046993   0.283126  -0.166   0.8682    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1854.8  on 1355  degrees of freedom
Residual deviance: 1629.5  on 1345  degrees of freedom
  (22 observations deleted due to missingness)
AIC: 1651.5

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term          estimate odds_ratio conf.low.or conf.high.or std.error  p.value
   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   -0.507        0.602      0.246         1.47    0.456   2.66e- 1
 2 age            0.00634      1.01       0.994         1.02    0.00652 3.31e- 1
 3 seniority      0.00307      1.00       0.988         1.02    0.00788 6.97e- 1
 4 ideology       0.968        2.63       1.05          7.02    0.482   4.45e- 2
 5 chamberhouse… -0.153        0.858      0.656         1.12    0.137   2.62e- 1
 6 is.republica…  0.465        1.59       0.979         2.58    0.247   5.99e- 2
 7 genderMale     0.456        1.58       1.12          2.23    0.176   9.70e- 3
 8 as.factor(co… -0.125        0.883      0.638         1.22    0.166   4.52e- 1
 9 as.factor(co… -2.06         0.127      0.0854        0.187   0.200   5.82e-25
10 as.factor(co… -1.11         0.331      0.237         0.459   0.169   5.57e-11
11 is.republica… -0.0470       0.954      0.548         1.66    0.283   8.68e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
         llh      llhNull           G2     McFadden         r2ML         r2CU 
-814.7310601 -927.3852062  225.3082922    0.1214750    0.1530864    0.2053914 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"-0.507165575","3":"0.6022001","4":"0.24584635","5":"1.4700264","6":"0.455897574","7":"2.659425e-01","8":""},{"1":"age","2":"0.006341117","3":"1.0063613","4":"0.99359703","5":"1.0193306","6":"0.006518842","7":"3.306842e-01","8":""},{"1":"seniority","2":"0.003068717","3":"1.0030734","4":"0.98768060","5":"1.0187069","6":"0.007884008","7":"6.971037e-01","8":""},{"1":"ideology","2":"0.967868299","3":"2.6323271","4":"1.05325817","5":"7.0151401","6":"0.481639281","7":"4.448102e-02","8":"*"},{"1":"chamberhouse of representatives","2":"-0.153412910","3":"0.8577755","4":"0.65589622","5":"1.1220013","6":"0.136875502","7":"2.623641e-01","8":""},{"1":"is.republican1","2":"0.464846169","3":"1.5917693","4":"0.97945839","5":"2.5832932","6":"0.247064359","7":"5.990692e-02","8":"."},{"1":"genderMale","2":"0.456313210","3":"1.5782446","4":"1.11852780","5":"2.2346732","6":"0.176430642","7":"9.699548e-03","8":"**"},{"1":"as.factor(congress)116","2":"-0.124610236","3":"0.8828409","4":"0.63797365","5":"1.2210620","6":"0.165505958","7":"4.515071e-01","8":""},{"1":"as.factor(congress)117","2":"-2.060981824","3":"0.1273289","4":"0.08544503","5":"0.1871182","6":"0.199738856","7":"5.819554e-25","8":"***"},{"1":"as.factor(congress)118","2":"-1.106717024","3":"0.3306427","4":"0.23688473","5":"0.4593472","6":"0.168842109","7":"5.573691e-11","8":"***"},{"1":"is.republican1:genderMale","2":"-0.046992769","3":"0.9540943","4":"0.54810233","5":"1.6644617","6":"0.283125904","7":"8.681740e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.dom ~ age + seniority + ideology + gender + 
    is.republican * chamber + as.factor(congress), family = binomial(), 
    data = legis_cg)

Coefficients:
                                                Estimate Std. Error z value
(Intercept)                                    -0.369474   0.458315  -0.806
age                                             0.006595   0.006525   1.011
seniority                                       0.002849   0.007881   0.362
ideology                                        0.927227   0.481329   1.926
genderMale                                      0.430440   0.138663   3.104
is.republican1                                  0.176225   0.223857   0.787
chamberhouse of representatives                -0.345595   0.195113  -1.771
as.factor(congress)116                         -0.113027   0.165762  -0.682
as.factor(congress)117                         -2.063008   0.199826 -10.324
as.factor(congress)118                         -1.112932   0.168966  -6.587
is.republican1:chamberhouse of representatives  0.366226   0.265898   1.377
                                               Pr(&gt;|z|)    
(Intercept)                                     0.42015    
age                                             0.31215    
seniority                                       0.71768    
ideology                                        0.05406 .  
genderMale                                      0.00191 ** 
is.republican1                                  0.43115    
chamberhouse of representatives                 0.07652 .  
as.factor(congress)116                          0.49533    
as.factor(congress)117                          &lt; 2e-16 ***
as.factor(congress)118                          4.5e-11 ***
is.republican1:chamberhouse of representatives  0.16841    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1854.8  on 1355  degrees of freedom
Residual deviance: 1627.6  on 1345  degrees of freedom
  (22 observations deleted due to missingness)
AIC: 1649.6

Number of Fisher Scoring iterations: 4

# A tibble: 11 × 8
   term          estimate odds_ratio conf.low.or conf.high.or std.error  p.value
   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 (Intercept)   -0.369        0.691      0.281         1.70    0.458   4.20e- 1
 2 age            0.00660      1.01       0.994         1.02    0.00653 3.12e- 1
 3 seniority      0.00285      1.00       0.987         1.02    0.00788 7.18e- 1
 4 ideology       0.927        2.53       1.01          6.73    0.481   5.41e- 2
 5 genderMale     0.430        1.54       1.17          2.02    0.139   1.91e- 3
 6 is.republica…  0.176        1.19       0.769         1.85    0.224   4.31e- 1
 7 chamberhouse… -0.346        0.708      0.483         1.04    0.195   7.65e- 2
 8 as.factor(co… -0.113        0.893      0.645         1.24    0.166   4.95e- 1
 9 as.factor(co… -2.06         0.127      0.0853        0.187   0.200   5.49e-25
10 as.factor(co… -1.11         0.329      0.235         0.457   0.169   4.50e-11
11 is.republica…  0.366        1.44       0.856         2.43    0.266   1.68e- 1
# ℹ 1 more variable: significance &lt;chr&gt;

Pseudo R-squared:
fitting null model for pseudo-r2
         llh      llhNull           G2     McFadden         r2ML         r2CU 
-813.7961454 -927.3852062  227.1781216    0.1224831    0.1542534    0.2069572 </code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["odds_ratio"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low.or"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high.or"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["significance"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"-0.369473896","3":"0.6910978","4":"0.2809485","5":"1.6959320","6":"0.458314658","7":"4.201519e-01","8":""},{"1":"age","2":"0.006595441","3":"1.0066172","4":"0.9938381","5":"1.0196044","6":"0.006525456","7":"3.121481e-01","8":""},{"1":"seniority","2":"0.002849488","3":"1.0028536","4":"0.9874724","5":"1.0184804","6":"0.007881095","7":"7.176810e-01","8":""},{"1":"ideology","2":"0.927226839","3":"2.5274903","4":"1.0116800","5":"6.7313563","6":"0.481329493","7":"5.405608e-02","8":"."},{"1":"genderMale","2":"0.430439902","3":"1.5379339","4":"1.1732423","5":"2.0211270","6":"0.138663420","7":"1.907901e-03","8":"**"},{"1":"is.republican1","2":"0.176225454","3":"1.1927069","4":"0.7693485","5":"1.8515590","6":"0.223857438","7":"4.311520e-01","8":""},{"1":"chamberhouse of representatives","2":"-0.345595201","3":"0.7077989","4":"0.4826457","5":"1.0377776","6":"0.195113105","7":"7.651819e-02","8":"."},{"1":"as.factor(congress)116","2":"-0.113026802","3":"0.8931267","4":"0.6450954","5":"1.2359343","6":"0.165761874","7":"4.953259e-01","8":""},{"1":"as.factor(congress)117","2":"-2.063007523","3":"0.1270712","4":"0.0852573","5":"0.1867704","6":"0.199825587","7":"5.486439e-25","8":"***"},{"1":"as.factor(congress)118","2":"-1.112931715","3":"0.3285942","4":"0.2353571","5":"0.4566067","6":"0.168966084","7":"4.496593e-11","8":"***"},{"1":"is.republican1:chamberhouse of representatives","2":"0.366226322","3":"1.4422816","4":"0.8564652","5":"2.4301460","6":"0.265898261","7":"1.684141e-01","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20legis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of ideology when gender = Female: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.35   0.70     0.50   0.62

Slope of ideology when gender = Male: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  1.43   0.64     2.24   0.03</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ideology and chamber are not included in an interaction with one another in
the model.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20legis-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Automated checks indicate that ideology and chamber may not be included in
an interaction with one another in the model. Double-check to ensure the
model is specified correctly. This message may be a false positive.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of ideology when chamber = senate: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.97   0.48     2.01   0.04

Slope of ideology when chamber = house of representatives: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.97   0.48     2.01   0.04</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.
✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20legis-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of is.republican when gender = Female: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.46   0.25     1.88   0.06

Slope of is.republican when gender = Male: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.42   0.15     2.85   0.00</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.
✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/is.dom%20interaction%20legis-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using data legis_cg from global environment. This could cause incorrect
results if legis_cg has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Johnson-Neyman intervals are not available for factor predictors or
moderators.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

Slope of is.republican when chamber = senate: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.18   0.22     0.79   0.43

Slope of is.republican when chamber = house of representatives: 

  Est.   S.E.   z val.      p
------ ------ -------- ------
  0.54   0.15     3.56   0.00</code></pre>
</div>
</div>
</section>
<section id="dependent-variable-dom_percentage" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="dependent-variable-dom_percentage"><span class="header-section-number">8.3.2</span> dependent variable: dom_percentage</h3>
<p>adver</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dom_percentage ~ age + chamber + is.republican + 
    ideology * gender + as.factor(congress), data = adver_cg)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.180140 -0.027514  0.003417  0.033666  0.121791 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      4.255e-01  7.912e-03  53.782  &lt; 2e-16 ***
age                             -1.185e-05  9.624e-05  -0.123  0.90203    
chamberhouse of representatives -1.396e-02  2.701e-03  -5.169 2.63e-07 ***
is.republican1                   1.068e-02  2.366e-03   4.515 6.76e-06 ***
ideology                         1.814e-02  1.411e-02   1.285  0.19883    
genderMale                       9.004e-03  2.961e-03   3.041  0.00239 ** 
as.factor(congress)116          -3.146e-03  3.397e-03  -0.926  0.35447    
as.factor(congress)117          -3.227e-02  3.396e-03  -9.500  &lt; 2e-16 ***
as.factor(congress)118          -2.351e-02  3.318e-03  -7.087 2.00e-12 ***
ideology:genderMale             -9.536e-03  1.672e-02  -0.570  0.56844    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.04656 on 1707 degrees of freedom
  (48 observations deleted due to missingness)
Multiple R-squared:  0.121, Adjusted R-squared:  0.1163 
F-statistic:  26.1 on 9 and 1707 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dom_percentage ~ age + ideology * chamber + is.republican + 
    gender + as.factor(congress), data = adver_cg)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.179577 -0.027773  0.003872  0.033551  0.122522 

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               4.289e-01  8.237e-03  52.072  &lt; 2e-16
age                                      -9.611e-06  9.614e-05  -0.100  0.92038
ideology                                 -1.967e-02  2.697e-02  -0.729  0.46581
chamberhouse of representatives          -1.737e-02  3.871e-03  -4.489 7.64e-06
is.republican1                            1.080e-02  2.361e-03   4.576 5.09e-06
genderMale                                8.042e-03  2.539e-03   3.167  0.00157
as.factor(congress)116                   -2.681e-03  3.418e-03  -0.784  0.43303
as.factor(congress)117                   -3.206e-02  3.400e-03  -9.430  &lt; 2e-16
as.factor(congress)118                   -2.358e-02  3.317e-03  -7.109 1.72e-12
ideology:chamberhouse of representatives  3.480e-02  2.836e-02   1.227  0.21992
                                            
(Intercept)                              ***
age                                         
ideology                                    
chamberhouse of representatives          ***
is.republican1                           ***
genderMale                               ** 
as.factor(congress)116                      
as.factor(congress)117                   ***
as.factor(congress)118                   ***
ideology:chamberhouse of representatives    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.04654 on 1707 degrees of freedom
  (48 observations deleted due to missingness)
Multiple R-squared:  0.1216,    Adjusted R-squared:  0.1169 
F-statistic: 26.25 on 9 and 1707 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = is.dom ~ age + seniority + ideology + chamber + 
    is.republican * gender + as.factor(congress), data = adver_cg)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9174 -0.4654  0.2020  0.4249  0.7538 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      5.993e-01  8.742e-02   6.855 9.90e-12 ***
age                              3.679e-04  1.261e-03   0.292  0.77050    
seniority                        6.622e-05  1.574e-03   0.042  0.96644    
ideology                         1.641e-01  8.791e-02   1.866  0.06218 .  
chamberhouse of representatives -1.248e-01  2.804e-02  -4.449 9.18e-06 ***
is.republican1                   1.371e-01  4.638e-02   2.956  0.00316 ** 
genderMale                       1.029e-01  3.303e-02   3.113  0.00188 ** 
as.factor(congress)116          -2.772e-02  3.491e-02  -0.794  0.42731    
as.factor(congress)117          -2.420e-01  3.501e-02  -6.913 6.69e-12 ***
as.factor(congress)118          -1.871e-01  3.436e-02  -5.446 5.90e-08 ***
is.republican1:genderMale       -5.436e-02  5.398e-02  -1.007  0.31407    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4784 on 1706 degrees of freedom
  (48 observations deleted due to missingness)
Multiple R-squared:  0.08399,   Adjusted R-squared:  0.07862 
F-statistic: 15.64 on 10 and 1706 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = is.dom ~ age + seniority + ideology + gender + is.republican * 
    chamber + as.factor(congress), data = adver_cg)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8656 -0.4730  0.2202  0.4416  0.7500 

Coefficients:
                                                 Estimate Std. Error t value
(Intercept)                                     0.6374170  0.0883400   7.216
age                                             0.0004053  0.0012612   0.321
seniority                                       0.0001288  0.0015713   0.082
ideology                                        0.1665679  0.0876514   1.900
genderMale                                      0.0806183  0.0261142   3.087
is.republican1                                  0.0390525  0.0484270   0.806
chamberhouse of representatives                -0.1635142  0.0390337  -4.189
as.factor(congress)116                         -0.0266389  0.0349111  -0.763
as.factor(congress)117                         -0.2398237  0.0349990  -6.852
as.factor(congress)118                         -0.1850294  0.0343673  -5.384
is.republican1:chamberhouse of representatives  0.0768428  0.0550664   1.395
                                               Pr(&gt;|t|)    
(Intercept)                                    8.05e-13 ***
age                                             0.74797    
seniority                                       0.93467    
ideology                                        0.05756 .  
genderMale                                      0.00205 ** 
is.republican1                                  0.42011    
chamberhouse of representatives                2.94e-05 ***
as.factor(congress)116                          0.44554    
as.factor(congress)117                         1.01e-11 ***
as.factor(congress)118                         8.30e-08 ***
is.republican1:chamberhouse of representatives  0.16306    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4782 on 1706 degrees of freedom
  (48 observations deleted due to missingness)
Multiple R-squared:  0.08449,   Adjusted R-squared:  0.07913 
F-statistic: 15.75 on 10 and 1706 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20adver-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20adver-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20adver-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20adver-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>legis</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dom_percentage ~ age + chamber + is.republican + 
    ideology * gender + as.factor(congress), data = legis_cg)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.20163 -0.02860  0.00840  0.03667  0.10787 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      3.887e-01  9.762e-03  39.812  &lt; 2e-16 ***
age                             -3.676e-05  1.186e-04  -0.310 0.756756    
chamberhouse of representatives -1.342e-02  3.119e-03  -4.304 1.80e-05 ***
is.republican1                   1.346e-02  2.923e-03   4.607 4.47e-06 ***
ideology                         2.334e-02  1.660e-02   1.406 0.159858    
genderMale                       1.388e-02  3.626e-03   3.826 0.000136 ***
as.factor(congress)116          -3.059e-03  4.023e-03  -0.760 0.447171    
as.factor(congress)117          -3.379e-02  4.179e-03  -8.086 1.37e-15 ***
as.factor(congress)118          -2.469e-02  3.990e-03  -6.189 8.05e-10 ***
ideology:genderMale              7.034e-04  2.006e-02   0.035 0.972040    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05045 on 1346 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1288,    Adjusted R-squared:  0.123 
F-statistic: 22.11 on 9 and 1346 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dom_percentage ~ age + ideology * chamber + is.republican + 
    gender + as.factor(congress), data = legis_cg)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.201624 -0.028095  0.008707  0.036487  0.108211 

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               3.921e-01  9.985e-03  39.269  &lt; 2e-16
age                                      -3.783e-05  1.185e-04  -0.319    0.750
ideology                                 -8.111e-03  2.436e-02  -0.333    0.739
chamberhouse of representatives          -1.744e-02  4.167e-03  -4.184 3.05e-05
is.republican1                            1.338e-02  2.918e-03   4.584 4.98e-06
genderMale                                1.380e-02  3.125e-03   4.415 1.09e-05
as.factor(congress)116                   -2.472e-03  4.038e-03  -0.612    0.541
as.factor(congress)117                   -3.356e-02  4.179e-03  -8.031 2.10e-15
as.factor(congress)118                   -2.486e-02  3.987e-03  -6.236 6.01e-10
ideology:chamberhouse of representatives  3.867e-02  2.666e-02   1.450    0.147
                                            
(Intercept)                              ***
age                                         
ideology                                    
chamberhouse of representatives          ***
is.republican1                           ***
genderMale                               ***
as.factor(congress)116                      
as.factor(congress)117                   ***
as.factor(congress)118                   ***
ideology:chamberhouse of representatives    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05041 on 1346 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1302,    Adjusted R-squared:  0.1244 
F-statistic: 22.38 on 9 and 1346 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = is.dom ~ age + seniority + ideology + chamber + 
    is.republican * gender + as.factor(congress), data = legis_cg)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8318 -0.4025 -0.1330  0.4131  0.9899 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      0.4113533  0.0949185   4.334 1.57e-05 ***
age                              0.0012925  0.0013539   0.955   0.3399    
seniority                        0.0006734  0.0016475   0.409   0.6828    
ideology                         0.2039333  0.0953435   2.139   0.0326 *  
chamberhouse of representatives -0.0320635  0.0286949  -1.117   0.2640    
is.republican1                   0.0966640  0.0501209   1.929   0.0540 .  
genderMale                       0.0926668  0.0362655   2.555   0.0107 *  
as.factor(congress)116          -0.0338352  0.0364672  -0.928   0.3537    
as.factor(congress)117          -0.4318309  0.0380150 -11.359  &lt; 2e-16 ***
as.factor(congress)118          -0.2621580  0.0365534  -7.172 1.22e-12 ***
is.republican1:genderMale       -0.0083926  0.0580241  -0.145   0.8850    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4574 on 1345 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1544,    Adjusted R-squared:  0.1481 
F-statistic: 24.56 on 10 and 1345 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = is.dom ~ age + seniority + ideology + gender + is.republican * 
    chamber + as.factor(congress), data = legis_cg)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.7974 -0.4054 -0.1331  0.4097  0.9983 

Coefficients:
                                                 Estimate Std. Error t value
(Intercept)                                     0.4397542  0.0955072   4.604
age                                             0.0013370  0.0013526   0.988
seniority                                       0.0006373  0.0016457   0.387
ideology                                        0.1958538  0.0952258   2.057
genderMale                                      0.0876403  0.0283573   3.091
is.republican1                                  0.0383738  0.0471329   0.814
chamberhouse of representatives                -0.0710122  0.0407913  -1.741
as.factor(congress)116                         -0.0314133  0.0364842  -0.861
as.factor(congress)117                         -0.4317830  0.0379886 -11.366
as.factor(congress)118                         -0.2629977  0.0365214  -7.201
is.republican1:chamberhouse of representatives  0.0744696  0.0556045   1.339
                                               Pr(&gt;|t|)    
(Intercept)                                    4.53e-06 ***
age                                             0.32311    
seniority                                       0.69863    
ideology                                        0.03990 *  
genderMale                                      0.00204 ** 
is.republican1                                  0.41570    
chamberhouse of representatives                 0.08194 .  
as.factor(congress)116                          0.38938    
as.factor(congress)117                          &lt; 2e-16 ***
as.factor(congress)118                         9.90e-13 ***
is.republican1:chamberhouse of representatives  0.18071    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4571 on 1345 degrees of freedom
  (22 observations deleted due to missingness)
Multiple R-squared:  0.1555,    Adjusted R-squared:  0.1492 
F-statistic: 24.77 on 10 and 1345 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20legis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20legis-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20legis-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✖ Detected factor predictor.
ℹ Plotting with cat_plot() instead.
ℹ See `?interactions::cat_plot()` for full details on how to specify models
  with categorical predictors.
ℹ If you experience errors or unexpected results, try using cat_plot()
  directly.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="descriptive-analysis_decodingCompetition_files/figure-html/dom.percentage%20interaction%20legis-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb344" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "descriptive analysis_decodingCompetition"</span></span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Kunya Zhan </span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date(), '%B %d, %Y')`"</span></span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a><span class="co">   toc: true</span></span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a><span class="co">   toc-depth: 3</span></span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a><span class="co">   number-sections: true</span></span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a><span class="co">   code-fold: true</span></span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a><span class="co">   code-summary: "Show/Hide Code"</span></span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a><span class="co">   smooth-scroll: true</span></span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a><span class="co">   df-print: paged</span></span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a><span class="co">   code-tools: true</span></span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a><span class="co">   highlight-style: atom-one</span></span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a><span class="co">   toc-location: left</span></span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb344-19"><a href="#cb344-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-20"><a href="#cb344-20" aria-hidden="true" tabindex="-1"></a><span class="fu"># Descriptive Analysis </span></span>
<span id="cb344-21"><a href="#cb344-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-22"><a href="#cb344-22" aria-hidden="true" tabindex="-1"></a>This quarto document aims at reorganizing the codes at 'descriptive analysis 1021.Rmd'. It has two major parts:</span>
<span id="cb344-23"><a href="#cb344-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-24"><a href="#cb344-24" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> overall descriptive analysis of original decodeCompetition data;</span>
<span id="cb344-25"><a href="#cb344-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-26"><a href="#cb344-26" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> key characteristics identification through regression model and logistic model.</span>
<span id="cb344-27"><a href="#cb344-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-28"><a href="#cb344-28" aria-hidden="true" tabindex="-1"></a><span class="fu"># Set up</span></span>
<span id="cb344-29"><a href="#cb344-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-32"><a href="#cb344-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-33"><a href="#cb344-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb344-34"><a href="#cb344-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb344-35"><a href="#cb344-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-36"><a href="#cb344-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-37"><a href="#cb344-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-38"><a href="#cb344-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages Installing if not already installed</span></span>
<span id="cb344-39"><a href="#cb344-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-42"><a href="#cb344-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-43"><a href="#cb344-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: install_libraries</span></span>
<span id="cb344-44"><a href="#cb344-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-45"><a href="#cb344-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置默认 CRAN 源，防止未指定镜像导致 install.packages 报错</span></span>
<span id="cb344-46"><a href="#cb344-46" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb344-47"><a href="#cb344-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-48"><a href="#cb344-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 所需包列表</span></span>
<span id="cb344-49"><a href="#cb344-49" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb344-50"><a href="#cb344-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rcpp"</span>, <span class="st">"dplyr"</span>, <span class="st">"stringr"</span>, <span class="st">"readr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"tidyr"</span>, <span class="st">"readxl"</span>, <span class="st">"scales"</span>, </span>
<span id="cb344-51"><a href="#cb344-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"showtext"</span>, <span class="st">"sysfonts"</span>, <span class="st">"skimr"</span>, <span class="st">"plm"</span>, <span class="st">"car"</span>, <span class="st">"glmnet"</span>, </span>
<span id="cb344-52"><a href="#cb344-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rtsne"</span>, <span class="st">"networkD3"</span>, <span class="st">"cluster"</span>, <span class="st">"factoextra"</span>, <span class="st">"pROC"</span>, <span class="st">"lme4"</span>, </span>
<span id="cb344-53"><a href="#cb344-53" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MuMIn"</span>, <span class="st">"nnet"</span>, <span class="st">"DHARMa"</span>, <span class="st">"tigris"</span>, <span class="st">"ggeffects"</span>, <span class="st">"stargazer"</span>,</span>
<span id="cb344-54"><a href="#cb344-54" aria-hidden="true" tabindex="-1"></a>  <span class="st">"htmltools"</span>, <span class="st">"tidyverse"</span>, <span class="st">"ggcorrplot"</span>, <span class="st">"purrr"</span>, <span class="st">"broom.mixed"</span>, </span>
<span id="cb344-55"><a href="#cb344-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">"performance"</span>, <span class="st">"lattice"</span>, <span class="st">"fmsb"</span>, <span class="st">"kableExtra"</span>, <span class="st">"broom"</span>, </span>
<span id="cb344-56"><a href="#cb344-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>, <span class="st">"ggnewscale"</span>, <span class="st">"modelsummary"</span>, <span class="st">"pscl"</span>, <span class="st">"ggfortify"</span>, </span>
<span id="cb344-57"><a href="#cb344-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rlang"</span>, <span class="st">"patchwork"</span>, <span class="st">"segmented"</span>, <span class="st">"tidytext"</span>, <span class="st">"mgcv"</span>, <span class="st">"splines"</span>, </span>
<span id="cb344-58"><a href="#cb344-58" aria-hidden="true" tabindex="-1"></a>  <span class="st">"interactions"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"cowplot"</span>, <span class="st">"ggbreak"</span>, <span class="st">"randomcoloR"</span>,</span>
<span id="cb344-59"><a href="#cb344-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">"marginaleffects"</span></span>
<span id="cb344-60"><a href="#cb344-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-61"><a href="#cb344-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-62"><a href="#cb344-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Install only if missing</span></span>
<span id="cb344-63"><a href="#cb344-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb344-64"><a href="#cb344-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb344-65"><a href="#cb344-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg)</span>
<span id="cb344-66"><a href="#cb344-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-67"><a href="#cb344-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-68"><a href="#cb344-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-69"><a href="#cb344-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages</span></span>
<span id="cb344-70"><a href="#cb344-70" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-71"><a href="#cb344-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-72"><a href="#cb344-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-73"><a href="#cb344-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data cleansing</span></span>
<span id="cb344-74"><a href="#cb344-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-75"><a href="#cb344-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## data acquisition</span></span>
<span id="cb344-76"><a href="#cb344-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-79"><a href="#cb344-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-80"><a href="#cb344-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_data</span></span>
<span id="cb344-81"><a href="#cb344-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-82"><a href="#cb344-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-83"><a href="#cb344-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- main databases -----</span></span>
<span id="cb344-84"><a href="#cb344-84" aria-hidden="true" tabindex="-1"></a>adver_sum_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/adver_analysis_sum.xlsx"</span></span>
<span id="cb344-85"><a href="#cb344-85" aria-hidden="true" tabindex="-1"></a>legis_sum_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/legis_analysis_sum.xlsx"</span></span>
<span id="cb344-86"><a href="#cb344-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-87"><a href="#cb344-87" aria-hidden="true" tabindex="-1"></a>adver_sum <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(adver_sum_path)</span>
<span id="cb344-88"><a href="#cb344-88" aria-hidden="true" tabindex="-1"></a>legis_sum <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(legis_sum_path)</span>
<span id="cb344-89"><a href="#cb344-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-90"><a href="#cb344-90" aria-hidden="true" tabindex="-1"></a>adver_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/adver_analysis_all.xlsx"</span></span>
<span id="cb344-91"><a href="#cb344-91" aria-hidden="true" tabindex="-1"></a>legis_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/legis_analysis_all.xlsx"</span></span>
<span id="cb344-92"><a href="#cb344-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-93"><a href="#cb344-93" aria-hidden="true" tabindex="-1"></a>adver_all <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(adver_path)</span>
<span id="cb344-94"><a href="#cb344-94" aria-hidden="true" tabindex="-1"></a>legis_all <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(legis_path)</span>
<span id="cb344-95"><a href="#cb344-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-96"><a href="#cb344-96" aria-hidden="true" tabindex="-1"></a>adver_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/adver_train_data.csv"</span>)</span>
<span id="cb344-97"><a href="#cb344-97" aria-hidden="true" tabindex="-1"></a>legis_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/1022data/legis_train_data.csv"</span>)</span>
<span id="cb344-98"><a href="#cb344-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-99"><a href="#cb344-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-100"><a href="#cb344-100" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- supplementary databases -----</span></span>
<span id="cb344-101"><a href="#cb344-101" aria-hidden="true" tabindex="-1"></a>bioguide <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/congress_2025-10-23.csv"</span>)</span>
<span id="cb344-102"><a href="#cb344-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-103"><a href="#cb344-103" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology</span></span>
<span id="cb344-104"><a href="#cb344-104" aria-hidden="true" tabindex="-1"></a>ideology_115_senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2018-senate-ideology.csv"</span>)</span>
<span id="cb344-105"><a href="#cb344-105" aria-hidden="true" tabindex="-1"></a>ideology_115_house <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2018-house-ideology.csv"</span>)</span>
<span id="cb344-106"><a href="#cb344-106" aria-hidden="true" tabindex="-1"></a>ideology_116_senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2020-senate-ideology.csv"</span>)</span>
<span id="cb344-107"><a href="#cb344-107" aria-hidden="true" tabindex="-1"></a>ideology_116_house <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2020-house-ideology.csv"</span>)</span>
<span id="cb344-108"><a href="#cb344-108" aria-hidden="true" tabindex="-1"></a>ideology_117_senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2022-senate-ideology.csv"</span>)</span>
<span id="cb344-109"><a href="#cb344-109" aria-hidden="true" tabindex="-1"></a>ideology_117_house <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2022-house-ideology.csv"</span>)</span>
<span id="cb344-110"><a href="#cb344-110" aria-hidden="true" tabindex="-1"></a>ideology_118_senate <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2024-senate-ideology.csv"</span>)</span>
<span id="cb344-111"><a href="#cb344-111" aria-hidden="true" tabindex="-1"></a>ideology_118_house <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/new ideology/govtrack-stats-2024-house-ideology.csv"</span>)</span>
<span id="cb344-112"><a href="#cb344-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-113"><a href="#cb344-113" aria-hidden="true" tabindex="-1"></a><span class="co"># original news data</span></span>
<span id="cb344-114"><a href="#cb344-114" aria-hidden="true" tabindex="-1"></a>news_data_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/115_118_news_data_new1.csv"</span></span>
<span id="cb344-115"><a href="#cb344-115" aria-hidden="true" tabindex="-1"></a>news_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(news_data_path)</span>
<span id="cb344-116"><a href="#cb344-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-117"><a href="#cb344-117" aria-hidden="true" tabindex="-1"></a><span class="co"># original legislative data</span></span>
<span id="cb344-118"><a href="#cb344-118" aria-hidden="true" tabindex="-1"></a>bills_data_path <span class="ot">&lt;-</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/115-118_congress_data_new.csv"</span></span>
<span id="cb344-119"><a href="#cb344-119" aria-hidden="true" tabindex="-1"></a>bills_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(bills_data_path)</span>
<span id="cb344-120"><a href="#cb344-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-121"><a href="#cb344-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-122"><a href="#cb344-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## matching variables and special patch</span></span>
<span id="cb344-123"><a href="#cb344-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-126"><a href="#cb344-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-127"><a href="#cb344-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: matching variables </span></span>
<span id="cb344-128"><a href="#cb344-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-129"><a href="#cb344-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-130"><a href="#cb344-130" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ matching variables map ------</span></span>
<span id="cb344-131"><a href="#cb344-131" aria-hidden="true" tabindex="-1"></a>match_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb344-132"><a href="#cb344-132" aria-hidden="true" tabindex="-1"></a>  <span class="st">"leverage_pl"</span>, <span class="st">"leverage_ne"</span>, <span class="st">"committee_pl"</span>, <span class="st">"committee_ne"</span>,</span>
<span id="cb344-133"><a href="#cb344-133" aria-hidden="true" tabindex="-1"></a>  <span class="st">"employ_industry_pl"</span>, <span class="st">"employ_industry_ne"</span>,</span>
<span id="cb344-134"><a href="#cb344-134" aria-hidden="true" tabindex="-1"></a>  <span class="st">"payroll_industry_pl"</span>, <span class="st">"payroll_industry_ne"</span>,</span>
<span id="cb344-135"><a href="#cb344-135" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ethnicity_pl"</span>, <span class="st">"ethnicity_ne"</span>,</span>
<span id="cb344-136"><a href="#cb344-136" aria-hidden="true" tabindex="-1"></a>  <span class="st">"party_value_pl"</span>, <span class="st">"party_value_ne"</span>,</span>
<span id="cb344-137"><a href="#cb344-137" aria-hidden="true" tabindex="-1"></a>  <span class="st">"party_score_pl"</span>, <span class="st">"party_score_ne"</span></span>
<span id="cb344-138"><a href="#cb344-138" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-139"><a href="#cb344-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-140"><a href="#cb344-140" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Add raw columns ------</span></span>
<span id="cb344-141"><a href="#cb344-141" aria-hidden="true" tabindex="-1"></a>adver_data_raw <span class="ot">&lt;-</span> adver_data <span class="sc">%&gt;%</span></span>
<span id="cb344-142"><a href="#cb344-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.cols =</span> <span class="fu">all_of</span>(match_vars), <span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_raw"</span>))</span>
<span id="cb344-143"><a href="#cb344-143" aria-hidden="true" tabindex="-1"></a>adver_all <span class="ot">&lt;-</span> adver_all <span class="sc">%&gt;%</span></span>
<span id="cb344-144"><a href="#cb344-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb344-145"><a href="#cb344-145" aria-hidden="true" tabindex="-1"></a>    adver_data_raw <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, issue, congress, <span class="fu">ends_with</span>(<span class="st">"_raw"</span>)),</span>
<span id="cb344-146"><a href="#cb344-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"issue"</span>, <span class="st">"congress"</span>)</span>
<span id="cb344-147"><a href="#cb344-147" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-148"><a href="#cb344-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-149"><a href="#cb344-149" aria-hidden="true" tabindex="-1"></a>legis_data_raw <span class="ot">&lt;-</span> legis_data <span class="sc">%&gt;%</span></span>
<span id="cb344-150"><a href="#cb344-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.cols =</span> <span class="fu">all_of</span>(match_vars), <span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_raw"</span>))</span>
<span id="cb344-151"><a href="#cb344-151" aria-hidden="true" tabindex="-1"></a>legis_all <span class="ot">&lt;-</span> legis_all <span class="sc">%&gt;%</span></span>
<span id="cb344-152"><a href="#cb344-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb344-153"><a href="#cb344-153" aria-hidden="true" tabindex="-1"></a>    legis_data_raw <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, issue, congress, <span class="fu">ends_with</span>(<span class="st">"_raw"</span>)),</span>
<span id="cb344-154"><a href="#cb344-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"issue"</span>, <span class="st">"congress"</span>)</span>
<span id="cb344-155"><a href="#cb344-155" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-156"><a href="#cb344-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-157"><a href="#cb344-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-158"><a href="#cb344-158" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Sanity check ------</span></span>
<span id="cb344-159"><a href="#cb344-159" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">paste0</span>(match_vars, <span class="st">"_raw"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(adver_all)))</span>
<span id="cb344-160"><a href="#cb344-160" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">paste0</span>(match_vars, <span class="st">"_raw"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(legis_all)))</span>
<span id="cb344-161"><a href="#cb344-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-162"><a href="#cb344-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-163"><a href="#cb344-163" aria-hidden="true" tabindex="-1"></a><span class="fu">#### special clean for legis_sum and legis data</span></span>
<span id="cb344-164"><a href="#cb344-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-167"><a href="#cb344-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-168"><a href="#cb344-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: special clean for legis</span></span>
<span id="cb344-169"><a href="#cb344-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-170"><a href="#cb344-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-171"><a href="#cb344-171" aria-hidden="true" tabindex="-1"></a>legis_data <span class="ot">&lt;-</span> legis_data <span class="sc">%&gt;%</span></span>
<span id="cb344-172"><a href="#cb344-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">issue =</span> <span class="fu">str_to_title</span>(issue))</span>
<span id="cb344-173"><a href="#cb344-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-174"><a href="#cb344-174" aria-hidden="true" tabindex="-1"></a>legis_sum <span class="ot">&lt;-</span> legis_sum <span class="sc">%&gt;%</span></span>
<span id="cb344-175"><a href="#cb344-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">issue =</span> <span class="fu">str_to_title</span>(issue))</span>
<span id="cb344-176"><a href="#cb344-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-177"><a href="#cb344-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-178"><a href="#cb344-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## name cleansing</span></span>
<span id="cb344-179"><a href="#cb344-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-180"><a href="#cb344-180" aria-hidden="true" tabindex="-1"></a><span class="fu">### preparing bioguide as matching map</span></span>
<span id="cb344-181"><a href="#cb344-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-182"><a href="#cb344-182" aria-hidden="true" tabindex="-1"></a>name cleansing: addressing issues that some full_name are missing</span>
<span id="cb344-183"><a href="#cb344-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-186"><a href="#cb344-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-187"><a href="#cb344-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: name missing check in congress_basic</span></span>
<span id="cb344-188"><a href="#cb344-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-189"><a href="#cb344-189" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> bioguide <span class="sc">%&gt;%</span></span>
<span id="cb344-190"><a href="#cb344-190" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb344-191"><a href="#cb344-191" aria-hidden="true" tabindex="-1"></a>    bioguide_id, full_name, direct_order_name, chamber, member_type,</span>
<span id="cb344-192"><a href="#cb344-192" aria-hidden="true" tabindex="-1"></a>    party, state_name, state_code, district, gender,</span>
<span id="cb344-193"><a href="#cb344-193" aria-hidden="true" tabindex="-1"></a>    birth_year, death_year, age_at_death, district_congress</span>
<span id="cb344-194"><a href="#cb344-194" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-195"><a href="#cb344-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() </span>
<span id="cb344-196"><a href="#cb344-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-197"><a href="#cb344-197" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- check missing full_name inside bioguide ----</span></span>
<span id="cb344-198"><a href="#cb344-198" aria-hidden="true" tabindex="-1"></a>missing_name_df <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-199"><a href="#cb344-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(full_name) <span class="sc">|</span> full_name <span class="sc">==</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-200"><a href="#cb344-200" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bioguide_id, direct_order_name, chamber, state_code, district, party, district_congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-201"><a href="#cb344-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(chamber, state_code, district)</span>
<span id="cb344-202"><a href="#cb344-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-203"><a href="#cb344-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-206"><a href="#cb344-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-207"><a href="#cb344-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: clean_name</span></span>
<span id="cb344-208"><a href="#cb344-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-209"><a href="#cb344-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-210"><a href="#cb344-210" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Step 0: Create direct_order_name -&gt; full_name mapping ------</span></span>
<span id="cb344-211"><a href="#cb344-211" aria-hidden="true" tabindex="-1"></a>name_map <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb344-212"><a href="#cb344-212" aria-hidden="true" tabindex="-1"></a>  <span class="at">direct_order_name =</span> <span class="fu">c</span>(</span>
<span id="cb344-213"><a href="#cb344-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mike Rogers"</span>, <span class="st">"J. French Hill"</span>, <span class="st">"Dave Min"</span>, <span class="st">"Cory Mills"</span>,</span>
<span id="cb344-214"><a href="#cb344-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marjorie Taylor Greene"</span>, <span class="st">"David P. Joyce"</span>, <span class="st">"Michael Baumgartner"</span>,</span>
<span id="cb344-215"><a href="#cb344-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mark  Begich"</span>, <span class="st">"Richard C. Shelby"</span>, <span class="st">"Mark Udall"</span>, <span class="st">"Chuck Grassley"</span>,</span>
<span id="cb344-216"><a href="#cb344-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daniel Coats"</span>, <span class="st">"Joe Donnelly"</span>, <span class="st">"Pat Roberts"</span>, <span class="st">"Rand Paul"</span>, <span class="st">"David Vitter"</span>,</span>
<span id="cb344-217"><a href="#cb344-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Carl Levin"</span>, <span class="st">"Al  Franken"</span>, <span class="st">"Claire McCaskill"</span>, <span class="st">"Richard Burr"</span>,</span>
<span id="cb344-218"><a href="#cb344-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"John Hoeven"</span>, <span class="st">"Heidi  Heitkamp"</span>, <span class="st">"Kelly Ayotte"</span>, <span class="st">"Dean Heller"</span>,</span>
<span id="cb344-219"><a href="#cb344-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rob Portman"</span>, <span class="st">"Ron Wyden"</span>, <span class="st">"Jack Reed"</span>, <span class="st">"Sheldon Whitehouse"</span>,</span>
<span id="cb344-220"><a href="#cb344-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lindsey Graham"</span>, <span class="st">"Tim Johnson"</span>, <span class="st">"Bob Corker"</span></span>
<span id="cb344-221"><a href="#cb344-221" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-222"><a href="#cb344-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">full_name =</span> <span class="fu">c</span>(</span>
<span id="cb344-223"><a href="#cb344-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Rogers, Mike [R-AL-3]"</span>, <span class="st">"Rep. Hill, J. French [R-AR-2]"</span>,</span>
<span id="cb344-224"><a href="#cb344-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Min, Dave [D-CA-47]"</span>, <span class="st">"Rep. Mills, Cory [R-FL-7]"</span>,</span>
<span id="cb344-225"><a href="#cb344-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Greene, Marjorie Taylor [R-GA-14]"</span>, <span class="st">"Rep. Joyce, David P. [R-OH-14]"</span>,</span>
<span id="cb344-226"><a href="#cb344-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Baumgartner, Michael [R-WA-5]"</span>, <span class="st">"Sen. Begich, Mark [D-AK]"</span>,</span>
<span id="cb344-227"><a href="#cb344-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Shelby, Richard C. [R-AL]"</span>, <span class="st">"Sen. Udall, Mark [D-CO]"</span>,</span>
<span id="cb344-228"><a href="#cb344-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Grassley, Charles E. [R-IA]"</span>, <span class="st">"Sen. Coats, Daniel R. [R-IN]"</span>,</span>
<span id="cb344-229"><a href="#cb344-229" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Donnelly, Joe [D-IN]"</span>, <span class="st">"Sen. Roberts, Patrick J. [R-KS]"</span>,</span>
<span id="cb344-230"><a href="#cb344-230" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Paul, Randal H. [R-KY]"</span>, <span class="st">"Sen. Vitter, David [R-LA]"</span>,</span>
<span id="cb344-231"><a href="#cb344-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Levin, Carl [D-MI]"</span>, <span class="st">"Sen. Franken, Al [D-MN]"</span>,</span>
<span id="cb344-232"><a href="#cb344-232" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. McCaskill, Claire [D-MO]"</span>, <span class="st">"Sen. Burr, Richard [R-NC]"</span>,</span>
<span id="cb344-233"><a href="#cb344-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Hoeven, John [R-ND]"</span>, <span class="st">"Sen. Heitkamp, Heidi [D-ND]"</span>,</span>
<span id="cb344-234"><a href="#cb344-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Ayotte, Kelly [R-NH]"</span>, <span class="st">"Sen. Heller, Dean [R-NV]"</span>,</span>
<span id="cb344-235"><a href="#cb344-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Portman, Robert J. [R-OH]"</span>, <span class="st">"Sen. Wyden, Ronald [D-OR]"</span>,</span>
<span id="cb344-236"><a href="#cb344-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Reed, Jack [D-RI]"</span>, <span class="st">"Sen. Whitehouse, Sheldon [D-RI]"</span>,</span>
<span id="cb344-237"><a href="#cb344-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Graham, Lindsey [R-SC]"</span>, <span class="st">"Sen. Johnson, Timothy M. [D-SD]"</span>,</span>
<span id="cb344-238"><a href="#cb344-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Corker, Robert P. [R-TN]"</span></span>
<span id="cb344-239"><a href="#cb344-239" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-240"><a href="#cb344-240" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-241"><a href="#cb344-241" aria-hidden="true" tabindex="-1"></a>missing_name_df <span class="ot">&lt;-</span> missing_name_df <span class="sc">%&gt;%</span></span>
<span id="cb344-242"><a href="#cb344-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(name_map, <span class="at">by =</span> <span class="st">"direct_order_name"</span>)</span>
<span id="cb344-243"><a href="#cb344-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-244"><a href="#cb344-244" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Step 1: Define helper to clean names ------</span></span>
<span id="cb344-245"><a href="#cb344-245" aria-hidden="true" tabindex="-1"></a>clean_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb344-246"><a href="#cb344-246" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb344-247"><a href="#cb344-247" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">p{Zs}+"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-248"><a href="#cb344-248" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_squish</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-249"><a href="#cb344-249" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-250"><a href="#cb344-250" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_to_lower</span>()</span>
<span id="cb344-251"><a href="#cb344-251" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-252"><a href="#cb344-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-253"><a href="#cb344-253" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-254"><a href="#cb344-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">direct_order_name_clean =</span> <span class="fu">clean_names</span>(direct_order_name))</span>
<span id="cb344-255"><a href="#cb344-255" aria-hidden="true" tabindex="-1"></a>missing_name_df <span class="ot">&lt;-</span> missing_name_df <span class="sc">%&gt;%</span></span>
<span id="cb344-256"><a href="#cb344-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">direct_order_name_clean =</span> <span class="fu">clean_names</span>(direct_order_name))</span>
<span id="cb344-257"><a href="#cb344-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-258"><a href="#cb344-258" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Step 2: Fill missing full_name using mapping ------</span></span>
<span id="cb344-259"><a href="#cb344-259" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-260"><a href="#cb344-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb344-261"><a href="#cb344-261" aria-hidden="true" tabindex="-1"></a>    missing_name_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(direct_order_name_clean, full_name) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(),</span>
<span id="cb344-262"><a href="#cb344-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"direct_order_name_clean"</span></span>
<span id="cb344-263"><a href="#cb344-263" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-264"><a href="#cb344-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">full_name =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(full_name.x), full_name.y, full_name.x)) <span class="sc">%&gt;%</span></span>
<span id="cb344-265"><a href="#cb344-265" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">".x"</span>), <span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">".y"</span>), <span class="sc">-</span>direct_order_name_clean)</span>
<span id="cb344-266"><a href="#cb344-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-267"><a href="#cb344-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify no missing names remain</span></span>
<span id="cb344-268"><a href="#cb344-268" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of remaining missing full_name:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(congress_basic<span class="sc">$</span>full_name)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-269"><a href="#cb344-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-270"><a href="#cb344-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-271"><a href="#cb344-271" aria-hidden="true" tabindex="-1"></a>district cleansing: matching district code in main databases</span>
<span id="cb344-272"><a href="#cb344-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-275"><a href="#cb344-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-276"><a href="#cb344-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: clean district</span></span>
<span id="cb344-277"><a href="#cb344-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-278"><a href="#cb344-278" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-279"><a href="#cb344-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-280"><a href="#cb344-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">district =</span> <span class="fu">as.character</span>(district),</span>
<span id="cb344-281"><a href="#cb344-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-282"><a href="#cb344-282" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(district) <span class="sc">&amp;</span> chamber <span class="sc">==</span> <span class="st">"Senate"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb344-283"><a href="#cb344-283" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(district) <span class="sc">&amp;</span> chamber <span class="sc">==</span> <span class="st">"House of Representatives"</span> <span class="sc">~</span> <span class="st">"At Large"</span>,</span>
<span id="cb344-284"><a href="#cb344-284" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb344-285"><a href="#cb344-285" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-286"><a href="#cb344-286" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-287"><a href="#cb344-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-288"><a href="#cb344-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-289"><a href="#cb344-289" aria-hidden="true" tabindex="-1"></a>age cleansing: create age_to_date to match ages in main database and prepare age_to_congress to replace ages in main databases</span>
<span id="cb344-290"><a href="#cb344-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-293"><a href="#cb344-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-294"><a href="#cb344-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: clean age</span></span>
<span id="cb344-295"><a href="#cb344-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-296"><a href="#cb344-296" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Define congress start years ------</span></span>
<span id="cb344-297"><a href="#cb344-297" aria-hidden="true" tabindex="-1"></a>congress_year_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb344-298"><a href="#cb344-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">district_congress =</span> <span class="fu">c</span>(<span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>),</span>
<span id="cb344-299"><a href="#cb344-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">congress_start_year =</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2021</span>, <span class="dv">2023</span>, <span class="dv">2025</span>)</span>
<span id="cb344-300"><a href="#cb344-300" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-301"><a href="#cb344-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-302"><a href="#cb344-302" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Compute ages ------</span></span>
<span id="cb344-303"><a href="#cb344-303" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-304"><a href="#cb344-304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join start year info</span></span>
<span id="cb344-305"><a href="#cb344-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(congress_year_map, <span class="at">by =</span> <span class="st">"district_congress"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-306"><a href="#cb344-306" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-307"><a href="#cb344-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute age</span></span>
<span id="cb344-308"><a href="#cb344-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-309"><a href="#cb344-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_to_date =</span> <span class="dv">2025</span> <span class="sc">-</span> birth_year,</span>
<span id="cb344-310"><a href="#cb344-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_to_congress =</span> congress_start_year <span class="sc">-</span> birth_year,</span>
<span id="cb344-311"><a href="#cb344-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-312"><a href="#cb344-312" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle missing birth_year</span></span>
<span id="cb344-313"><a href="#cb344-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_to_date =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(birth_year), age_to_date, <span class="cn">NA_real_</span>),</span>
<span id="cb344-314"><a href="#cb344-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_to_congress =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(birth_year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(congress_start_year),</span>
<span id="cb344-315"><a href="#cb344-315" aria-hidden="true" tabindex="-1"></a>                              age_to_congress, <span class="cn">NA_real_</span>)</span>
<span id="cb344-316"><a href="#cb344-316" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-317"><a href="#cb344-317" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✅ Age calculation completed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-318"><a href="#cb344-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-319"><a href="#cb344-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-320"><a href="#cb344-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### name cleansing adver_sum &amp; legis_sum and special patches</span></span>
<span id="cb344-321"><a href="#cb344-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-322"><a href="#cb344-322" aria-hidden="true" tabindex="-1"></a>main database name extracting</span>
<span id="cb344-323"><a href="#cb344-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-326"><a href="#cb344-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-327"><a href="#cb344-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: name extracting</span></span>
<span id="cb344-328"><a href="#cb344-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-329"><a href="#cb344-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-330"><a href="#cb344-330" aria-hidden="true" tabindex="-1"></a>adver_sum0 <span class="ot">&lt;-</span> adver_sum <span class="sc">%&gt;%</span></span>
<span id="cb344-331"><a href="#cb344-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-332"><a href="#cb344-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_no_title =</span> <span class="fu">str_remove</span>(full_name, <span class="st">"^</span><span class="sc">\\</span><span class="st">s*(Sen</span><span class="sc">\\</span><span class="st">.|Rep</span><span class="sc">\\</span><span class="st">.|Del</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">s*"</span>),</span>
<span id="cb344-333"><a href="#cb344-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_clean =</span> <span class="fu">str_remove</span>(name_no_title, <span class="st">"</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">[.*</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_squish</span>(),</span>
<span id="cb344-334"><a href="#cb344-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">eng_name =</span> <span class="fu">str_replace</span>(name_clean, <span class="st">"^([^,]+),</span><span class="sc">\\</span><span class="st">s*(.+)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">2 </span><span class="sc">\\</span><span class="st">1"</span>)</span>
<span id="cb344-335"><a href="#cb344-335" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-336"><a href="#cb344-336" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name_no_title, <span class="sc">-</span>name_clean)</span>
<span id="cb344-337"><a href="#cb344-337" aria-hidden="true" tabindex="-1"></a>adver_sum0<span class="sc">$</span>congress <span class="ot">&lt;-</span> <span class="fu">as.character</span>(adver_sum0<span class="sc">$</span>congress)</span>
<span id="cb344-338"><a href="#cb344-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-339"><a href="#cb344-339" aria-hidden="true" tabindex="-1"></a>legis_sum0 <span class="ot">&lt;-</span> legis_sum <span class="sc">%&gt;%</span></span>
<span id="cb344-340"><a href="#cb344-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-341"><a href="#cb344-341" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_no_title =</span> <span class="fu">str_remove</span>(full_name, <span class="st">"^</span><span class="sc">\\</span><span class="st">s*(Sen</span><span class="sc">\\</span><span class="st">.|Rep</span><span class="sc">\\</span><span class="st">.|Del</span><span class="sc">\\</span><span class="st">.)</span><span class="sc">\\</span><span class="st">s*"</span>),</span>
<span id="cb344-342"><a href="#cb344-342" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_clean =</span> <span class="fu">str_remove</span>(name_no_title, <span class="st">"</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">[.*</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_squish</span>(),</span>
<span id="cb344-343"><a href="#cb344-343" aria-hidden="true" tabindex="-1"></a>    <span class="at">eng_name =</span> <span class="fu">str_replace</span>(name_clean, <span class="st">"^([^,]+),</span><span class="sc">\\</span><span class="st">s*(.+)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">2 </span><span class="sc">\\</span><span class="st">1"</span>)</span>
<span id="cb344-344"><a href="#cb344-344" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-345"><a href="#cb344-345" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name_no_title, <span class="sc">-</span>name_clean)</span>
<span id="cb344-346"><a href="#cb344-346" aria-hidden="true" tabindex="-1"></a>legis_sum0<span class="sc">$</span>congress <span class="ot">&lt;-</span> <span class="fu">as.character</span>(legis_sum0<span class="sc">$</span>congress)</span>
<span id="cb344-347"><a href="#cb344-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-348"><a href="#cb344-348" aria-hidden="true" tabindex="-1"></a><span class="co"># matching variable name in congress_basic</span></span>
<span id="cb344-349"><a href="#cb344-349" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">eng_name =</span> direct_order_name)</span>
<span id="cb344-350"><a href="#cb344-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-351"><a href="#cb344-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-352"><a href="#cb344-352" aria-hidden="true" tabindex="-1"></a><span class="fu">#### \* special patches</span></span>
<span id="cb344-353"><a href="#cb344-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-354"><a href="#cb344-354" aria-hidden="true" tabindex="-1"></a>The database has a override problem with some congress members. For example, Sen. Blunt Rochester, Lisa <span class="sc">\[</span>D-DE<span class="sc">\]</span> was elected as senator in 119th congress, but the database mistakebly override her information before as senator, while she was a representative. Those who are identified will be corrected as a special path in this chuck.</span>
<span id="cb344-355"><a href="#cb344-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-356"><a href="#cb344-356" aria-hidden="true" tabindex="-1"></a>special patch1: patch for "Sen. Blunt Rochester, Lisa <span class="sc">\[</span>D-DE<span class="sc">\]</span>"</span>
<span id="cb344-357"><a href="#cb344-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-360"><a href="#cb344-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-361"><a href="#cb344-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: patch_blunt_rochester</span></span>
<span id="cb344-362"><a href="#cb344-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-363"><a href="#cb344-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-364"><a href="#cb344-364" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义修补目标</span></span>
<span id="cb344-365"><a href="#cb344-365" aria-hidden="true" tabindex="-1"></a>patch_name <span class="ot">&lt;-</span> <span class="st">"Sen. Blunt Rochester, Lisa [D-DE]"</span></span>
<span id="cb344-366"><a href="#cb344-366" aria-hidden="true" tabindex="-1"></a>patch_congress <span class="ot">&lt;-</span> <span class="dv">118</span>  <span class="co"># 可选：指定届次，确保唯一定位</span></span>
<span id="cb344-367"><a href="#cb344-367" aria-hidden="true" tabindex="-1"></a>new_chamber <span class="ot">&lt;-</span> <span class="st">"House of Representatives"</span></span>
<span id="cb344-368"><a href="#cb344-368" aria-hidden="true" tabindex="-1"></a>new_district <span class="ot">&lt;-</span> <span class="st">"At Large"</span></span>
<span id="cb344-369"><a href="#cb344-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-370"><a href="#cb344-370" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 1: 精确锁定匹配对象 ----</span></span>
<span id="cb344-371"><a href="#cb344-371" aria-hidden="true" tabindex="-1"></a>target_legis <span class="ot">&lt;-</span> legis_sum0 <span class="sc">%&gt;%</span></span>
<span id="cb344-372"><a href="#cb344-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(full_name <span class="sc">==</span> patch_name) <span class="sc">%&gt;%</span></span>
<span id="cb344-373"><a href="#cb344-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(full_name, congress)</span>
<span id="cb344-374"><a href="#cb344-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-375"><a href="#cb344-375" aria-hidden="true" tabindex="-1"></a>target_adver <span class="ot">&lt;-</span> adver_sum0 <span class="sc">%&gt;%</span></span>
<span id="cb344-376"><a href="#cb344-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(full_name <span class="sc">==</span> patch_name) <span class="sc">%&gt;%</span></span>
<span id="cb344-377"><a href="#cb344-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(full_name, congress)</span>
<span id="cb344-378"><a href="#cb344-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-379"><a href="#cb344-379" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(target_legis) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">|</span> <span class="fu">nrow</span>(target_adver) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb344-380"><a href="#cb344-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"⚠️ 有多个匹配记录，请确认是否需要限制特定 Congress（例如 118）！"</span>)</span>
<span id="cb344-381"><a href="#cb344-381" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-382"><a href="#cb344-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-383"><a href="#cb344-383" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 2: 安全更新函数 ----</span></span>
<span id="cb344-384"><a href="#cb344-384" aria-hidden="true" tabindex="-1"></a>safe_patch <span class="ot">&lt;-</span> <span class="cf">function</span>(df, name, <span class="at">congress =</span> <span class="cn">NULL</span>, new_chamber, new_district) {</span>
<span id="cb344-385"><a href="#cb344-385" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb344-386"><a href="#cb344-386" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-387"><a href="#cb344-387" aria-hidden="true" tabindex="-1"></a>      <span class="at">chamber =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-388"><a href="#cb344-388" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">is.na</span>(full_name) <span class="sc">&amp;</span></span>
<span id="cb344-389"><a href="#cb344-389" aria-hidden="true" tabindex="-1"></a>          full_name <span class="sc">==</span> name <span class="sc">&amp;</span></span>
<span id="cb344-390"><a href="#cb344-390" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">is.null</span>(congress) <span class="sc">|</span> .data<span class="sc">$</span>congress <span class="sc">==</span> congress) <span class="sc">~</span> new_chamber,</span>
<span id="cb344-391"><a href="#cb344-391" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> chamber</span>
<span id="cb344-392"><a href="#cb344-392" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb344-393"><a href="#cb344-393" aria-hidden="true" tabindex="-1"></a>      <span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-394"><a href="#cb344-394" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">is.na</span>(full_name) <span class="sc">&amp;</span></span>
<span id="cb344-395"><a href="#cb344-395" aria-hidden="true" tabindex="-1"></a>          full_name <span class="sc">==</span> name <span class="sc">&amp;</span></span>
<span id="cb344-396"><a href="#cb344-396" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">is.null</span>(congress) <span class="sc">|</span> .data<span class="sc">$</span>congress <span class="sc">==</span> congress) <span class="sc">~</span> new_district,</span>
<span id="cb344-397"><a href="#cb344-397" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb344-398"><a href="#cb344-398" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-399"><a href="#cb344-399" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-400"><a href="#cb344-400" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-401"><a href="#cb344-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-402"><a href="#cb344-402" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 3: 应用更新 ----</span></span>
<span id="cb344-403"><a href="#cb344-403" aria-hidden="true" tabindex="-1"></a>legis_sum0 <span class="ot">&lt;-</span> <span class="fu">safe_patch</span>(legis_sum0, patch_name, patch_congress, new_chamber, new_district)</span>
<span id="cb344-404"><a href="#cb344-404" aria-hidden="true" tabindex="-1"></a>adver_sum0 <span class="ot">&lt;-</span> <span class="fu">safe_patch</span>(adver_sum0, patch_name, patch_congress, new_chamber, new_district)</span>
<span id="cb344-405"><a href="#cb344-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-406"><a href="#cb344-406" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Step 4: 检查结果 ----</span></span>
<span id="cb344-407"><a href="#cb344-407" aria-hidden="true" tabindex="-1"></a>legis_sum0 <span class="sc">%&gt;%</span> </span>
<span id="cb344-408"><a href="#cb344-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(full_name <span class="sc">==</span> patch_name) <span class="sc">%&gt;%</span></span>
<span id="cb344-409"><a href="#cb344-409" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, congress, chamber, district)</span>
<span id="cb344-410"><a href="#cb344-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-411"><a href="#cb344-411" aria-hidden="true" tabindex="-1"></a>adver_sum0 <span class="sc">%&gt;%</span> </span>
<span id="cb344-412"><a href="#cb344-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(full_name <span class="sc">==</span> patch_name) <span class="sc">%&gt;%</span></span>
<span id="cb344-413"><a href="#cb344-413" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, congress, chamber, district)</span>
<span id="cb344-414"><a href="#cb344-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-415"><a href="#cb344-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-416"><a href="#cb344-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-417"><a href="#cb344-417" aria-hidden="true" tabindex="-1"></a>special patch2: for congressmen "Sen. Menendez, Robert <span class="sc">\[</span>D-NJ<span class="sc">\]</span>" and "Rep. Menendez, Robert <span class="sc">\[</span>D-NJ-8<span class="sc">\]</span>", since they have different eng_name but extracting from full_name cannot automatically discern the difference</span>
<span id="cb344-418"><a href="#cb344-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-421"><a href="#cb344-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-422"><a href="#cb344-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: special_clean_menendez</span></span>
<span id="cb344-423"><a href="#cb344-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-424"><a href="#cb344-424" aria-hidden="true" tabindex="-1"></a>special_clean_menendez <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb344-425"><a href="#cb344-425" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-426"><a href="#cb344-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-427"><a href="#cb344-427" aria-hidden="true" tabindex="-1"></a>      <span class="at">eng_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-428"><a href="#cb344-428" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Senator Robert Menendez (NJ, district 99 or 0)</span></span>
<span id="cb344-429"><a href="#cb344-429" aria-hidden="true" tabindex="-1"></a>        full_name <span class="sc">==</span> <span class="st">"Sen. Menendez, Robert [D-NJ]"</span> <span class="sc">|</span></span>
<span id="cb344-430"><a href="#cb344-430" aria-hidden="true" tabindex="-1"></a>        (state_code <span class="sc">==</span> <span class="st">"NJ"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>, <span class="dv">0</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(full_name, <span class="st">"Menendez"</span>)) <span class="sc">~</span> <span class="st">"Bob Menendez"</span>,</span>
<span id="cb344-431"><a href="#cb344-431" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb344-432"><a href="#cb344-432" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Representative Robert Menendez (NJ-8)</span></span>
<span id="cb344-433"><a href="#cb344-433" aria-hidden="true" tabindex="-1"></a>        full_name <span class="sc">==</span> <span class="st">"Rep. Menendez, Robert [D-NJ-8]"</span> <span class="sc">|</span></span>
<span id="cb344-434"><a href="#cb344-434" aria-hidden="true" tabindex="-1"></a>        (state_code <span class="sc">==</span> <span class="st">"NJ"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(full_name, <span class="st">"Menendez"</span>)) <span class="sc">~</span> <span class="st">"Rob Menendez"</span>,</span>
<span id="cb344-435"><a href="#cb344-435" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb344-436"><a href="#cb344-436" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> eng_name</span>
<span id="cb344-437"><a href="#cb344-437" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-438"><a href="#cb344-438" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-439"><a href="#cb344-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb344-440"><a href="#cb344-440" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-441"><a href="#cb344-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-442"><a href="#cb344-442" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the special cleaning function</span></span>
<span id="cb344-443"><a href="#cb344-443" aria-hidden="true" tabindex="-1"></a>congress_basic <span class="ot">&lt;-</span> <span class="fu">special_clean_menendez</span>(congress_basic)</span>
<span id="cb344-444"><a href="#cb344-444" aria-hidden="true" tabindex="-1"></a>adver_sum0 <span class="ot">&lt;-</span> <span class="fu">special_clean_menendez</span>(adver_sum0)</span>
<span id="cb344-445"><a href="#cb344-445" aria-hidden="true" tabindex="-1"></a>legis_sum0 <span class="ot">&lt;-</span> <span class="fu">special_clean_menendez</span>(legis_sum0)</span>
<span id="cb344-446"><a href="#cb344-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-447"><a href="#cb344-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-448"><a href="#cb344-448" aria-hidden="true" tabindex="-1"></a><span class="fu">### name mapping</span></span>
<span id="cb344-449"><a href="#cb344-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-452"><a href="#cb344-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-453"><a href="#cb344-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: check name missing in main data</span></span>
<span id="cb344-454"><a href="#cb344-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-455"><a href="#cb344-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-456"><a href="#cb344-456" aria-hidden="true" tabindex="-1"></a><span class="co"># try to use congress+party+chamber+state_code+district as mapping key</span></span>
<span id="cb344-457"><a href="#cb344-457" aria-hidden="true" tabindex="-1"></a>adver_name_check <span class="ot">&lt;-</span> adver_sum0 <span class="sc">%&gt;%</span></span>
<span id="cb344-458"><a href="#cb344-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(full_name)) <span class="sc">%&gt;%</span></span>
<span id="cb344-459"><a href="#cb344-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, party, chamber, state_code, district) <span class="sc">%&gt;%</span></span>
<span id="cb344-460"><a href="#cb344-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-461"><a href="#cb344-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb344-462"><a href="#cb344-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-463"><a href="#cb344-463" aria-hidden="true" tabindex="-1"></a>legis_name_check <span class="ot">&lt;-</span> legis_sum0 <span class="sc">%&gt;%</span></span>
<span id="cb344-464"><a href="#cb344-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(full_name)) <span class="sc">%&gt;%</span></span>
<span id="cb344-465"><a href="#cb344-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, party, chamber, state_code, district) <span class="sc">%&gt;%</span></span>
<span id="cb344-466"><a href="#cb344-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-467"><a href="#cb344-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="co"># missing == 0, clean</span></span>
<span id="cb344-468"><a href="#cb344-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-469"><a href="#cb344-469" aria-hidden="true" tabindex="-1"></a><span class="co"># duplicity check</span></span>
<span id="cb344-470"><a href="#cb344-470" aria-hidden="true" tabindex="-1"></a>dupli_name_check <span class="ot">&lt;-</span> adver_sum0  <span class="sc">%&gt;%</span></span>
<span id="cb344-471"><a href="#cb344-471" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-472"><a href="#cb344-472" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. only checking those full_name == na</span></span>
<span id="cb344-473"><a href="#cb344-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(full_name)) <span class="sc">%&gt;%</span></span>
<span id="cb344-474"><a href="#cb344-474" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-475"><a href="#cb344-475" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. group on legislators</span></span>
<span id="cb344-476"><a href="#cb344-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, party, chamber, state_code, district) <span class="sc">%&gt;%</span></span>
<span id="cb344-477"><a href="#cb344-477" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-478"><a href="#cb344-478" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. calculating various issue &amp; row numbers</span></span>
<span id="cb344-479"><a href="#cb344-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb344-480"><a href="#cb344-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_rows =</span> <span class="fu">n</span>(),</span>
<span id="cb344-481"><a href="#cb344-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_issue =</span> <span class="fu">n_distinct</span>(issue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-482"><a href="#cb344-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-483"><a href="#cb344-483" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-484"><a href="#cb344-484" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-485"><a href="#cb344-485" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. check if duplicate</span></span>
<span id="cb344-486"><a href="#cb344-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">non_unique =</span> n_rows <span class="sc">&gt;</span> n_issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-487"><a href="#cb344-487" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-488"><a href="#cb344-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_rows))</span>
<span id="cb344-489"><a href="#cb344-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-490"><a href="#cb344-490" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- output analysis result ----</span></span>
<span id="cb344-491"><a href="#cb344-491" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"🔍 共有"</span>, <span class="fu">sum</span>(dupli_name_check<span class="sc">$</span>non_unique), <span class="st">"组 full_name 缺失记录无法唯一标识议员。</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-492"><a href="#cb344-492" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"📊 总计 unique 组合数："</span>, <span class="fu">nrow</span>(dupli_name_check), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-493"><a href="#cb344-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-494"><a href="#cb344-494" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- check specific row（only thos who are duplicate not due to issue） ----</span></span>
<span id="cb344-495"><a href="#cb344-495" aria-hidden="true" tabindex="-1"></a>dupli_name_check <span class="sc">%&gt;%</span></span>
<span id="cb344-496"><a href="#cb344-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(non_unique) <span class="sc">%&gt;%</span></span>
<span id="cb344-497"><a href="#cb344-497" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(congress, party, chamber, state_code, district, n_rows, n_issue)</span>
<span id="cb344-498"><a href="#cb344-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-499"><a href="#cb344-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-500"><a href="#cb344-500" aria-hidden="true" tabindex="-1"></a>define name matching function</span>
<span id="cb344-501"><a href="#cb344-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-504"><a href="#cb344-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-505"><a href="#cb344-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: match_bioguide</span></span>
<span id="cb344-506"><a href="#cb344-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-507"><a href="#cb344-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-508"><a href="#cb344-508" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Function: Match bioguide_id based on name and district info ------</span></span>
<span id="cb344-509"><a href="#cb344-509" aria-hidden="true" tabindex="-1"></a>normalize_name <span class="ot">&lt;-</span> <span class="cf">function</span>(name) {</span>
<span id="cb344-510"><a href="#cb344-510" aria-hidden="true" tabindex="-1"></a>  name <span class="sc">%&gt;%</span></span>
<span id="cb344-511"><a href="#cb344-511" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-512"><a href="#cb344-512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span>     <span class="co"># 删除句点</span></span>
<span id="cb344-513"><a href="#cb344-513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-514"><a href="#cb344-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>)       <span class="co"># 去多余空格</span></span>
<span id="cb344-515"><a href="#cb344-515" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-516"><a href="#cb344-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-517"><a href="#cb344-517" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 辅助函数：去除中间名，只保留名 + 姓 ----</span></span>
<span id="cb344-518"><a href="#cb344-518" aria-hidden="true" tabindex="-1"></a>remove_middle_name <span class="ot">&lt;-</span> <span class="cf">function</span>(name) {</span>
<span id="cb344-519"><a href="#cb344-519" aria-hidden="true" tabindex="-1"></a>  name <span class="sc">%&gt;%</span></span>
<span id="cb344-520"><a href="#cb344-520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-521"><a href="#cb344-521" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split_fixed</span>(<span class="st">" "</span>, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-522"><a href="#cb344-522" aria-hidden="true" tabindex="-1"></a>    .[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb344-523"><a href="#cb344-523" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">na.omit</span>(x), <span class="at">collapse =</span> <span class="st">" "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-524"><a href="#cb344-524" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>()</span>
<span id="cb344-525"><a href="#cb344-525" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-526"><a href="#cb344-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-527"><a href="#cb344-527" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 主函数 ----</span></span>
<span id="cb344-528"><a href="#cb344-528" aria-hidden="true" tabindex="-1"></a>match_bioguide_id <span class="ot">&lt;-</span> <span class="cf">function</span>(main_df, congress_basic, </span>
<span id="cb344-529"><a href="#cb344-529" aria-hidden="true" tabindex="-1"></a>                              <span class="at">use_step3 =</span> <span class="cn">TRUE</span>, </span>
<span id="cb344-530"><a href="#cb344-530" aria-hidden="true" tabindex="-1"></a>                              <span class="at">use_step4 =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-531"><a href="#cb344-531" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb344-532"><a href="#cb344-532" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-533"><a href="#cb344-533" aria-hidden="true" tabindex="-1"></a>  total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(main_df)</span>
<span id="cb344-534"><a href="#cb344-534" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-535"><a href="#cb344-535" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 0: 初始化 bioguide_id ----</span></span>
<span id="cb344-536"><a href="#cb344-536" aria-hidden="true" tabindex="-1"></a>  main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span> </span>
<span id="cb344-537"><a href="#cb344-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bioguide_id =</span> <span class="cn">NA_character_</span>)</span>
<span id="cb344-538"><a href="#cb344-538" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-539"><a href="#cb344-539" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 1: full_name + congress 匹配 ----</span></span>
<span id="cb344-540"><a href="#cb344-540" aria-hidden="true" tabindex="-1"></a>  tmp1 <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-541"><a href="#cb344-541" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(full_name, district_congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-542"><a href="#cb344-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-543"><a href="#cb344-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-544"><a href="#cb344-544" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, district_congress, <span class="at">bioguide_id1 =</span> bioguide_id)</span>
<span id="cb344-545"><a href="#cb344-545" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-546"><a href="#cb344-546" aria-hidden="true" tabindex="-1"></a>  main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-547"><a href="#cb344-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(tmp1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"congress"</span> <span class="ot">=</span> <span class="st">"district_congress"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-548"><a href="#cb344-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bioguide_id =</span> <span class="fu">coalesce</span>(bioguide_id, bioguide_id1)) <span class="sc">%&gt;%</span></span>
<span id="cb344-549"><a href="#cb344-549" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>bioguide_id1)</span>
<span id="cb344-550"><a href="#cb344-550" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-551"><a href="#cb344-551" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Step 1 matched:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(main_df<span class="sc">$</span>bioguide_id)), <span class="st">"/"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-552"><a href="#cb344-552" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-553"><a href="#cb344-553" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 2: eng_name + congress 匹配 ----</span></span>
<span id="cb344-554"><a href="#cb344-554" aria-hidden="true" tabindex="-1"></a>  tmp2 <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-555"><a href="#cb344-555" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(eng_name, district_congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-556"><a href="#cb344-556" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-557"><a href="#cb344-557" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-558"><a href="#cb344-558" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(eng_name, district_congress, <span class="at">bioguide_id2 =</span> bioguide_id)</span>
<span id="cb344-559"><a href="#cb344-559" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-560"><a href="#cb344-560" aria-hidden="true" tabindex="-1"></a>  main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-561"><a href="#cb344-561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(tmp2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"eng_name"</span>, <span class="st">"congress"</span> <span class="ot">=</span> <span class="st">"district_congress"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-562"><a href="#cb344-562" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bioguide_id =</span> <span class="fu">coalesce</span>(bioguide_id, bioguide_id2)) <span class="sc">%&gt;%</span></span>
<span id="cb344-563"><a href="#cb344-563" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>bioguide_id2)</span>
<span id="cb344-564"><a href="#cb344-564" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-565"><a href="#cb344-565" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Step 2 matched:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(main_df<span class="sc">$</span>bioguide_id)), <span class="st">"/"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-566"><a href="#cb344-566" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-567"><a href="#cb344-567" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 3（可选）: 使用稳定 key 匹配 bioguide_id ----</span></span>
<span id="cb344-568"><a href="#cb344-568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (use_step3) {</span>
<span id="cb344-569"><a href="#cb344-569" aria-hidden="true" tabindex="-1"></a>    main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-570"><a href="#cb344-570" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">id_key =</span> <span class="fu">paste</span>(congress, party, chamber, state_code, district, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb344-571"><a href="#cb344-571" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-572"><a href="#cb344-572" aria-hidden="true" tabindex="-1"></a>    congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-573"><a href="#cb344-573" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">id_key =</span> <span class="fu">paste</span>(district_congress, party, chamber, state_code, district, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb344-574"><a href="#cb344-574" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-575"><a href="#cb344-575" aria-hidden="true" tabindex="-1"></a>    tmp3 <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-576"><a href="#cb344-576" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(id_key) <span class="sc">%&gt;%</span></span>
<span id="cb344-577"><a href="#cb344-577" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-578"><a href="#cb344-578" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-579"><a href="#cb344-579" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(id_key, <span class="at">bioguide_id3 =</span> bioguide_id, <span class="at">full_name3 =</span> full_name)</span>
<span id="cb344-580"><a href="#cb344-580" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-581"><a href="#cb344-581" aria-hidden="true" tabindex="-1"></a>    n_before <span class="ot">&lt;-</span> <span class="fu">nrow</span>(main_df)</span>
<span id="cb344-582"><a href="#cb344-582" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-583"><a href="#cb344-583" aria-hidden="true" tabindex="-1"></a>    main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-584"><a href="#cb344-584" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(tmp3, <span class="at">by =</span> <span class="st">"id_key"</span>, <span class="at">relationship =</span> <span class="st">"many-to-one"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-585"><a href="#cb344-585" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb344-586"><a href="#cb344-586" aria-hidden="true" tabindex="-1"></a>        <span class="at">bioguide_id =</span> <span class="fu">coalesce</span>(bioguide_id, bioguide_id3),</span>
<span id="cb344-587"><a href="#cb344-587" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_name   =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(bioguide_id3), full_name3, full_name)</span>
<span id="cb344-588"><a href="#cb344-588" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb344-589"><a href="#cb344-589" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>bioguide_id3, <span class="sc">-</span>full_name3, <span class="sc">-</span>id_key)</span>
<span id="cb344-590"><a href="#cb344-590" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-591"><a href="#cb344-591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">nrow</span>(main_df) <span class="sc">==</span> n_before)</span>
<span id="cb344-592"><a href="#cb344-592" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-593"><a href="#cb344-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Step 3 (stable key) matched:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(main_df<span class="sc">$</span>bioguide_id)), <span class="st">"/"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-594"><a href="#cb344-594" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-595"><a href="#cb344-595" aria-hidden="true" tabindex="-1"></a>    dupli_keys <span class="ot">&lt;-</span> tmp3 <span class="sc">%&gt;%</span> <span class="fu">count</span>(id_key) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb344-596"><a href="#cb344-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(dupli_keys) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb344-597"><a href="#cb344-597" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">"⚠️ Warning: duplicate id_key found in congress_basic, may cause ambiguous match."</span>)</span>
<span id="cb344-598"><a href="#cb344-598" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-599"><a href="#cb344-599" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-600"><a href="#cb344-600" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-601"><a href="#cb344-601" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 4（可选）: eng_name only (normalize + 去中间名) ----</span></span>
<span id="cb344-602"><a href="#cb344-602" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (use_step4) {</span>
<span id="cb344-603"><a href="#cb344-603" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 标准化并去除中间名</span></span>
<span id="cb344-604"><a href="#cb344-604" aria-hidden="true" tabindex="-1"></a>    congress_basic <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-605"><a href="#cb344-605" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">eng_name_clean =</span> <span class="fu">normalize_name</span>(eng_name) <span class="sc">%&gt;%</span> <span class="fu">remove_middle_name</span>())</span>
<span id="cb344-606"><a href="#cb344-606" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-607"><a href="#cb344-607" aria-hidden="true" tabindex="-1"></a>    main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-608"><a href="#cb344-608" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">eng_name_clean =</span> <span class="fu">normalize_name</span>(eng_name) <span class="sc">%&gt;%</span> <span class="fu">remove_middle_name</span>())</span>
<span id="cb344-609"><a href="#cb344-609" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-610"><a href="#cb344-610" aria-hidden="true" tabindex="-1"></a>    tmp4 <span class="ot">&lt;-</span> congress_basic <span class="sc">%&gt;%</span></span>
<span id="cb344-611"><a href="#cb344-611" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(eng_name_clean) <span class="sc">%&gt;%</span></span>
<span id="cb344-612"><a href="#cb344-612" aria-hidden="true" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-613"><a href="#cb344-613" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-614"><a href="#cb344-614" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(eng_name_clean, <span class="at">full_name4 =</span> full_name, <span class="at">bioguide_id4 =</span> bioguide_id)</span>
<span id="cb344-615"><a href="#cb344-615" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-616"><a href="#cb344-616" aria-hidden="true" tabindex="-1"></a>    main_df <span class="ot">&lt;-</span> main_df <span class="sc">%&gt;%</span></span>
<span id="cb344-617"><a href="#cb344-617" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(tmp4, <span class="at">by =</span> <span class="st">"eng_name_clean"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-618"><a href="#cb344-618" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb344-619"><a href="#cb344-619" aria-hidden="true" tabindex="-1"></a>        <span class="at">bioguide_id =</span> <span class="fu">coalesce</span>(bioguide_id, bioguide_id4),</span>
<span id="cb344-620"><a href="#cb344-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_name   =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(bioguide_id4), full_name4, full_name)</span>
<span id="cb344-621"><a href="#cb344-621" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb344-622"><a href="#cb344-622" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>bioguide_id4, <span class="sc">-</span>full_name4, <span class="sc">-</span>eng_name_clean)</span>
<span id="cb344-623"><a href="#cb344-623" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-624"><a href="#cb344-624" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verbose) <span class="fu">cat</span>(<span class="st">"Step 4 (normalized + middle name removed) matched:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(main_df<span class="sc">$</span>bioguide_id)), <span class="st">"/"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-625"><a href="#cb344-625" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-626"><a href="#cb344-626" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-627"><a href="#cb344-627" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Step 5: 输出总结 ----</span></span>
<span id="cb344-628"><a href="#cb344-628" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb344-629"><a href="#cb344-629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"✅ Bioguide ID matching complete.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-630"><a href="#cb344-630" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Remaining NA bioguide_id:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(main_df<span class="sc">$</span>bioguide_id)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-631"><a href="#cb344-631" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-632"><a href="#cb344-632" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-633"><a href="#cb344-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(main_df)</span>
<span id="cb344-634"><a href="#cb344-634" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-635"><a href="#cb344-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-636"><a href="#cb344-636" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ Apply function to datasets ------</span></span>
<span id="cb344-637"><a href="#cb344-637" aria-hidden="true" tabindex="-1"></a>congress_basic<span class="sc">$</span>district_congress <span class="ot">&lt;-</span> <span class="fu">as.character</span>(congress_basic<span class="sc">$</span>district_congress)</span>
<span id="cb344-638"><a href="#cb344-638" aria-hidden="true" tabindex="-1"></a>adver_sum1 <span class="ot">&lt;-</span> <span class="fu">match_bioguide_id</span>(adver_sum0, congress_basic, <span class="at">use_step3 =</span> <span class="cn">TRUE</span>, <span class="at">use_step4 =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-639"><a href="#cb344-639" aria-hidden="true" tabindex="-1"></a>legis_sum1 <span class="ot">&lt;-</span> <span class="fu">match_bioguide_id</span>(legis_sum0, congress_basic, <span class="at">use_step3 =</span> <span class="cn">FALSE</span>, <span class="at">use_step4 =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-640"><a href="#cb344-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-641"><a href="#cb344-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Update final datasets</span></span>
<span id="cb344-642"><a href="#cb344-642" aria-hidden="true" tabindex="-1"></a><span class="co"># adver_sum &lt;- adver_sum1</span></span>
<span id="cb344-643"><a href="#cb344-643" aria-hidden="true" tabindex="-1"></a><span class="co"># legis_sum &lt;- legis_sum1</span></span>
<span id="cb344-644"><a href="#cb344-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-645"><a href="#cb344-645" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看legis缺失</span></span>
<span id="cb344-646"><a href="#cb344-646" aria-hidden="true" tabindex="-1"></a>legis_missing <span class="ot">&lt;-</span> legis_sum1 <span class="sc">%&gt;%</span> </span>
<span id="cb344-647"><a href="#cb344-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(bioguide_id)) <span class="sc">%&gt;%</span></span>
<span id="cb344-648"><a href="#cb344-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(full_name, <span class="at">.keep_all =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-649"><a href="#cb344-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(full_name)</span>
<span id="cb344-650"><a href="#cb344-650" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(legis_missing, <span class="st">"legis_missing_fullname_list.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-651"><a href="#cb344-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-652"><a href="#cb344-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-653"><a href="#cb344-653" aria-hidden="true" tabindex="-1"></a>address missing name issues</span>
<span id="cb344-654"><a href="#cb344-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-657"><a href="#cb344-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-658"><a href="#cb344-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: missing name solution</span></span>
<span id="cb344-659"><a href="#cb344-659" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-660"><a href="#cb344-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-661"><a href="#cb344-661" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ old_full_name -&gt; new_full_name ------ </span></span>
<span id="cb344-662"><a href="#cb344-662" aria-hidden="true" tabindex="-1"></a>name_map <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb344-663"><a href="#cb344-663" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_full_name =</span> <span class="fu">c</span>(</span>
<span id="cb344-664"><a href="#cb344-664" aria-hidden="true" tabindex="-1"></a>    <span class="st">"David Joyce"</span>,</span>
<span id="cb344-665"><a href="#cb344-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">"J. Hill"</span>,</span>
<span id="cb344-666"><a href="#cb344-666" aria-hidden="true" tabindex="-1"></a>    <span class="st">"John Reed"</span>,</span>
<span id="cb344-667"><a href="#cb344-667" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marjorie Greene"</span>,</span>
<span id="cb344-668"><a href="#cb344-668" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Richard Shelby"</span></span>
<span id="cb344-669"><a href="#cb344-669" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-670"><a href="#cb344-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_full_name =</span> <span class="fu">c</span>(</span>
<span id="cb344-671"><a href="#cb344-671" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Joyce, David P. [R-OH-14]"</span>,</span>
<span id="cb344-672"><a href="#cb344-672" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Hill, J. French [R-AR-2]"</span>,</span>
<span id="cb344-673"><a href="#cb344-673" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Reed, Jack [D-RI]"</span>,</span>
<span id="cb344-674"><a href="#cb344-674" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rep. Greene, Marjorie Taylor [R-GA-14]"</span>,</span>
<span id="cb344-675"><a href="#cb344-675" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sen. Shelby, Richard C. [R-AL]"</span></span>
<span id="cb344-676"><a href="#cb344-676" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-677"><a href="#cb344-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb344-678"><a href="#cb344-678" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-679"><a href="#cb344-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-680"><a href="#cb344-680" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ clean full_name ------ </span></span>
<span id="cb344-681"><a href="#cb344-681" aria-hidden="true" tabindex="-1"></a>clean_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb344-682"><a href="#cb344-682" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb344-683"><a href="#cb344-683" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">p{Zs}+"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span>  <span class="co"># 将所有空白替换为普通空格</span></span>
<span id="cb344-684"><a href="#cb344-684" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">%&gt;%</span>                      <span class="co"># 压缩多空格</span></span>
<span id="cb344-685"><a href="#cb344-685" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-686"><a href="#cb344-686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_to_lower</span>()</span>
<span id="cb344-687"><a href="#cb344-687" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-688"><a href="#cb344-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-689"><a href="#cb344-689" aria-hidden="true" tabindex="-1"></a>legis_sum2 <span class="ot">&lt;-</span> legis_sum1 <span class="sc">%&gt;%</span></span>
<span id="cb344-690"><a href="#cb344-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">full_name_clean =</span> <span class="fu">clean_names</span>(full_name))</span>
<span id="cb344-691"><a href="#cb344-691" aria-hidden="true" tabindex="-1"></a>name_map <span class="ot">&lt;-</span> name_map <span class="sc">%&gt;%</span></span>
<span id="cb344-692"><a href="#cb344-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">old_full_name_clean =</span> <span class="fu">clean_names</span>(old_full_name))</span>
<span id="cb344-693"><a href="#cb344-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-694"><a href="#cb344-694" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ update full_name ------ </span></span>
<span id="cb344-695"><a href="#cb344-695" aria-hidden="true" tabindex="-1"></a>legis_sum2 <span class="ot">&lt;-</span> legis_sum2 <span class="sc">%&gt;%</span></span>
<span id="cb344-696"><a href="#cb344-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(name_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span> <span class="ot">=</span> <span class="st">"old_full_name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-697"><a href="#cb344-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-698"><a href="#cb344-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_name =</span> <span class="fu">coalesce</span>(new_full_name, full_name),</span>
<span id="cb344-699"><a href="#cb344-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">updated_flag =</span> <span class="sc">!</span><span class="fu">is.na</span>(new_full_name)  <span class="co"># flage updated rows</span></span>
<span id="cb344-700"><a href="#cb344-700" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-701"><a href="#cb344-701" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>new_full_name)</span>
<span id="cb344-702"><a href="#cb344-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-703"><a href="#cb344-703" aria-hidden="true" tabindex="-1"></a><span class="co"># ------ bioguide match ------</span></span>
<span id="cb344-704"><a href="#cb344-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-705"><a href="#cb344-705" aria-hidden="true" tabindex="-1"></a>update_rows <span class="ot">&lt;-</span> <span class="fu">which</span>(legis_sum2<span class="sc">$</span>updated_flag <span class="sc">&amp;</span> <span class="fu">is.na</span>(legis_sum2<span class="sc">$</span>bioguide_id))</span>
<span id="cb344-706"><a href="#cb344-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-707"><a href="#cb344-707" aria-hidden="true" tabindex="-1"></a><span class="co"># full_name + congress as only key</span></span>
<span id="cb344-708"><a href="#cb344-708" aria-hidden="true" tabindex="-1"></a>legis_sum2<span class="sc">$</span>key <span class="ot">&lt;-</span> <span class="fu">paste0</span>(legis_sum2<span class="sc">$</span>full_name, <span class="st">"_"</span>, legis_sum2<span class="sc">$</span>congress)</span>
<span id="cb344-709"><a href="#cb344-709" aria-hidden="true" tabindex="-1"></a>congress_basic<span class="sc">$</span>key <span class="ot">&lt;-</span> <span class="fu">paste0</span>(congress_basic<span class="sc">$</span>full_name, <span class="st">"_"</span>, congress_basic<span class="sc">$</span>district_congress)</span>
<span id="cb344-710"><a href="#cb344-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-711"><a href="#cb344-711" aria-hidden="true" tabindex="-1"></a>matched_ids <span class="ot">&lt;-</span> congress_basic<span class="sc">$</span>bioguide_id[<span class="fu">match</span>(legis_sum2<span class="sc">$</span>key[update_rows], congress_basic<span class="sc">$</span>key)]</span>
<span id="cb344-712"><a href="#cb344-712" aria-hidden="true" tabindex="-1"></a>legis_sum2<span class="sc">$</span>bioguide_id[update_rows] <span class="ot">&lt;-</span> matched_ids</span>
<span id="cb344-713"><a href="#cb344-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-714"><a href="#cb344-714" aria-hidden="true" tabindex="-1"></a>legis_sum1 <span class="ot">&lt;-</span> legis_sum2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>key, <span class="sc">-</span>full_name_clean, <span class="sc">-</span>old_full_name_clean, <span class="sc">-</span>updated_flag)</span>
<span id="cb344-715"><a href="#cb344-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-716"><a href="#cb344-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-717"><a href="#cb344-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## ideology update</span></span>
<span id="cb344-718"><a href="#cb344-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-719"><a href="#cb344-719" aria-hidden="true" tabindex="-1"></a>The original ideology data in the main database is standardized. We use ideology data at <span class="sc">\[</span>GovTrack<span class="sc">\]</span>(<span class="ot">&lt;https://www.govtrack.us/about/analysis#ideology&gt;</span>) to replace them. ref: <span class="co">[</span><span class="ot">Tauberer, Joshua</span><span class="co">](http://razor.occams.info/)</span>. 2012. Observing the Unobservables in the U.S. Congress, presented at Law Via the Internet 2012, Cornell Law School, October 2012.</span>
<span id="cb344-720"><a href="#cb344-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-721"><a href="#cb344-721" aria-hidden="true" tabindex="-1"></a>ideology cleansing</span>
<span id="cb344-722"><a href="#cb344-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-725"><a href="#cb344-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-726"><a href="#cb344-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ideology-cleansing</span></span>
<span id="cb344-727"><a href="#cb344-727" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-728"><a href="#cb344-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-729"><a href="#cb344-729" aria-hidden="true" tabindex="-1"></a>ideology_115_house <span class="ot">&lt;-</span> ideology_115_house <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">115</span>, <span class="at">chamber =</span> <span class="st">"House of Representatives"</span>)</span>
<span id="cb344-730"><a href="#cb344-730" aria-hidden="true" tabindex="-1"></a>ideology_116_house <span class="ot">&lt;-</span> ideology_116_house <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">116</span>, <span class="at">chamber =</span> <span class="st">"House of Representatives"</span>)</span>
<span id="cb344-731"><a href="#cb344-731" aria-hidden="true" tabindex="-1"></a>ideology_117_house <span class="ot">&lt;-</span> ideology_117_house <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">117</span>, <span class="at">chamber =</span> <span class="st">"House of Representatives"</span>)</span>
<span id="cb344-732"><a href="#cb344-732" aria-hidden="true" tabindex="-1"></a>ideology_118_house <span class="ot">&lt;-</span> ideology_118_house <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">118</span>, <span class="at">chamber =</span> <span class="st">"House of Representatives"</span>)</span>
<span id="cb344-733"><a href="#cb344-733" aria-hidden="true" tabindex="-1"></a>ideology_115_senate <span class="ot">&lt;-</span> ideology_115_senate <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">115</span>, <span class="at">chamber =</span> <span class="st">"Senate"</span>)</span>
<span id="cb344-734"><a href="#cb344-734" aria-hidden="true" tabindex="-1"></a>ideology_116_senate <span class="ot">&lt;-</span> ideology_116_senate <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">116</span>, <span class="at">chamber =</span> <span class="st">"Senate"</span>)</span>
<span id="cb344-735"><a href="#cb344-735" aria-hidden="true" tabindex="-1"></a>ideology_117_senate <span class="ot">&lt;-</span> ideology_117_senate <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">117</span>, <span class="at">chamber =</span> <span class="st">"Senate"</span>)</span>
<span id="cb344-736"><a href="#cb344-736" aria-hidden="true" tabindex="-1"></a>ideology_118_senate <span class="ot">&lt;-</span> ideology_118_senate <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="dv">118</span>, <span class="at">chamber =</span> <span class="st">"Senate"</span>)</span>
<span id="cb344-737"><a href="#cb344-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-738"><a href="#cb344-738" aria-hidden="true" tabindex="-1"></a>chamber_ideology <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb344-739"><a href="#cb344-739" aria-hidden="true" tabindex="-1"></a>  ideology_115_house,</span>
<span id="cb344-740"><a href="#cb344-740" aria-hidden="true" tabindex="-1"></a>  ideology_116_house,</span>
<span id="cb344-741"><a href="#cb344-741" aria-hidden="true" tabindex="-1"></a>  ideology_117_house,</span>
<span id="cb344-742"><a href="#cb344-742" aria-hidden="true" tabindex="-1"></a>  ideology_118_house,</span>
<span id="cb344-743"><a href="#cb344-743" aria-hidden="true" tabindex="-1"></a>  ideology_115_senate,</span>
<span id="cb344-744"><a href="#cb344-744" aria-hidden="true" tabindex="-1"></a>  ideology_116_senate,</span>
<span id="cb344-745"><a href="#cb344-745" aria-hidden="true" tabindex="-1"></a>  ideology_117_senate,</span>
<span id="cb344-746"><a href="#cb344-746" aria-hidden="true" tabindex="-1"></a>  ideology_118_senate)</span>
<span id="cb344-747"><a href="#cb344-747" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(chamber_ideology<span class="sc">$</span>congress)</span>
<span id="cb344-748"><a href="#cb344-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-749"><a href="#cb344-749" aria-hidden="true" tabindex="-1"></a>chamber_ideology<span class="sc">$</span>congress <span class="ot">&lt;-</span> <span class="fu">as.character</span>(chamber_ideology<span class="sc">$</span>congress)</span>
<span id="cb344-750"><a href="#cb344-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-751"><a href="#cb344-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-752"><a href="#cb344-752" aria-hidden="true" tabindex="-1"></a>ideology merge</span>
<span id="cb344-753"><a href="#cb344-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-756"><a href="#cb344-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-757"><a href="#cb344-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ideology-merge</span></span>
<span id="cb344-758"><a href="#cb344-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-759"><a href="#cb344-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-760"><a href="#cb344-760" aria-hidden="true" tabindex="-1"></a>merge_ideology <span class="ot">&lt;-</span> <span class="cf">function</span>(df, ideology_df, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb344-761"><a href="#cb344-761" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-762"><a href="#cb344-762" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 0: 格式统一</span></span>
<span id="cb344-763"><a href="#cb344-763" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-764"><a href="#cb344-764" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-765"><a href="#cb344-765" aria-hidden="true" tabindex="-1"></a>      <span class="at">bioguide_id =</span> <span class="fu">toupper</span>(<span class="fu">str_trim</span>(bioguide_id)),</span>
<span id="cb344-766"><a href="#cb344-766" aria-hidden="true" tabindex="-1"></a>      <span class="at">congress    =</span> <span class="fu">as.character</span>(congress),</span>
<span id="cb344-767"><a href="#cb344-767" aria-hidden="true" tabindex="-1"></a>      <span class="at">chamber     =</span> <span class="fu">tolower</span>(<span class="fu">str_trim</span>(chamber))</span>
<span id="cb344-768"><a href="#cb344-768" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-769"><a href="#cb344-769" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-770"><a href="#cb344-770" aria-hidden="true" tabindex="-1"></a>  ideology_df <span class="ot">&lt;-</span> ideology_df <span class="sc">%&gt;%</span></span>
<span id="cb344-771"><a href="#cb344-771" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-772"><a href="#cb344-772" aria-hidden="true" tabindex="-1"></a>      <span class="at">bioguide_id =</span> <span class="fu">toupper</span>(<span class="fu">str_trim</span>(bioguide_id)),</span>
<span id="cb344-773"><a href="#cb344-773" aria-hidden="true" tabindex="-1"></a>      <span class="at">congress    =</span> <span class="fu">as.character</span>(congress),</span>
<span id="cb344-774"><a href="#cb344-774" aria-hidden="true" tabindex="-1"></a>      <span class="at">chamber     =</span> <span class="fu">tolower</span>(<span class="fu">str_trim</span>(chamber))</span>
<span id="cb344-775"><a href="#cb344-775" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-776"><a href="#cb344-776" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: 去重，确保唯一匹配</span></span>
<span id="cb344-777"><a href="#cb344-777" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(bioguide_id, congress, chamber) <span class="sc">%&gt;%</span></span>
<span id="cb344-778"><a href="#cb344-778" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-779"><a href="#cb344-779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb344-780"><a href="#cb344-780" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-781"><a href="#cb344-781" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: 选择必要列</span></span>
<span id="cb344-782"><a href="#cb344-782" aria-hidden="true" tabindex="-1"></a>  ideology_df <span class="ot">&lt;-</span> ideology_df <span class="sc">%&gt;%</span></span>
<span id="cb344-783"><a href="#cb344-783" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(bioguide_id, congress, chamber, ideology) <span class="sc">%&gt;%</span></span>
<span id="cb344-784"><a href="#cb344-784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">ideology_new =</span> ideology)</span>
<span id="cb344-785"><a href="#cb344-785" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-786"><a href="#cb344-786" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: left_join</span></span>
<span id="cb344-787"><a href="#cb344-787" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-788"><a href="#cb344-788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(ideology_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"bioguide_id"</span>, <span class="st">"congress"</span>, <span class="st">"chamber"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-789"><a href="#cb344-789" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ideology =</span> <span class="fu">coalesce</span>(ideology, ideology_new)) <span class="sc">%&gt;%</span></span>
<span id="cb344-790"><a href="#cb344-790" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>ideology_new)</span>
<span id="cb344-791"><a href="#cb344-791" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-792"><a href="#cb344-792" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 4: 输出匹配情况</span></span>
<span id="cb344-793"><a href="#cb344-793" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) {</span>
<span id="cb344-794"><a href="#cb344-794" aria-hidden="true" tabindex="-1"></a>    n_missing <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(df<span class="sc">$</span>ideology))</span>
<span id="cb344-795"><a href="#cb344-795" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"✅ Merge complete. Remaining NA ideology:"</span>, n_missing, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-796"><a href="#cb344-796" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-797"><a href="#cb344-797" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-798"><a href="#cb344-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb344-799"><a href="#cb344-799" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-800"><a href="#cb344-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-801"><a href="#cb344-801" aria-hidden="true" tabindex="-1"></a>adver_sum1 <span class="ot">&lt;-</span> <span class="fu">merge_ideology</span>(adver_sum1, chamber_ideology)</span>
<span id="cb344-802"><a href="#cb344-802" aria-hidden="true" tabindex="-1"></a>legis_sum1 <span class="ot">&lt;-</span> <span class="fu">merge_ideology</span>(legis_sum1, chamber_ideology)</span>
<span id="cb344-803"><a href="#cb344-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-804"><a href="#cb344-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-805"><a href="#cb344-805" aria-hidden="true" tabindex="-1"></a>ideology missing distribution: missing at random</span>
<span id="cb344-806"><a href="#cb344-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-809"><a href="#cb344-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-810"><a href="#cb344-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ideology-missing</span></span>
<span id="cb344-811"><a href="#cb344-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-812"><a href="#cb344-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-813"><a href="#cb344-813" aria-hidden="true" tabindex="-1"></a>check_missing_ideology <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">df_name =</span> <span class="st">"dataset"</span>) {</span>
<span id="cb344-814"><a href="#cb344-814" aria-hidden="true" tabindex="-1"></a>  missing_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(ideology))</span>
<span id="cb344-815"><a href="#cb344-815" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-816"><a href="#cb344-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✅"</span>, df_name, <span class="st">"total missing:"</span>, <span class="fu">nrow</span>(missing_df), <span class="st">"/"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb344-817"><a href="#cb344-817" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-818"><a href="#cb344-818" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Missing by party</span></span>
<span id="cb344-819"><a href="#cb344-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Missing by party:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-820"><a href="#cb344-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(missing_df<span class="sc">$</span>party))</span>
<span id="cb344-821"><a href="#cb344-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-822"><a href="#cb344-822" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-823"><a href="#cb344-823" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Missing by state</span></span>
<span id="cb344-824"><a href="#cb344-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Missing by state:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-825"><a href="#cb344-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(missing_df<span class="sc">$</span>state_code))</span>
<span id="cb344-826"><a href="#cb344-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-827"><a href="#cb344-827" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-828"><a href="#cb344-828" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Missing by chamber</span></span>
<span id="cb344-829"><a href="#cb344-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Missing by chamber:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-830"><a href="#cb344-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(missing_df<span class="sc">$</span>chamber))</span>
<span id="cb344-831"><a href="#cb344-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-832"><a href="#cb344-832" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-833"><a href="#cb344-833" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cross-tab: party x chamber</span></span>
<span id="cb344-834"><a href="#cb344-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Missing by party x chamber:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-835"><a href="#cb344-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(missing_df<span class="sc">$</span>party, missing_df<span class="sc">$</span>chamber))</span>
<span id="cb344-836"><a href="#cb344-836" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-837"><a href="#cb344-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-838"><a href="#cb344-838" aria-hidden="true" tabindex="-1"></a><span class="fu">check_missing_ideology</span>(adver_sum1, <span class="st">"adver_sum1"</span>)</span>
<span id="cb344-839"><a href="#cb344-839" aria-hidden="true" tabindex="-1"></a><span class="fu">check_missing_ideology</span>(legis_sum1, <span class="st">"legis_sum1"</span>)</span>
<span id="cb344-840"><a href="#cb344-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-841"><a href="#cb344-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-842"><a href="#cb344-842" aria-hidden="true" tabindex="-1"></a><span class="fu"># data aggregation and generation</span></span>
<span id="cb344-843"><a href="#cb344-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-844"><a href="#cb344-844" aria-hidden="true" tabindex="-1"></a><span class="fu">## individual level aggregation</span></span>
<span id="cb344-845"><a href="#cb344-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-846"><a href="#cb344-846" aria-hidden="true" tabindex="-1"></a>generate function: generate_decision_with_traits()</span>
<span id="cb344-847"><a href="#cb344-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-848"><a href="#cb344-848" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This function aggregates prediction and importance metrics for each legislator across different datasets, such as train, test,or merged. It computes the relative importance of 3 behavioral modes - intl, dom, and prof, and assigns each legislator a dominant decision category based on their most prominent behavior. It finally merges these aggregated results with demographic and institutional traits like gender, party, and ideology.</span></span>
<span id="cb344-849"><a href="#cb344-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-852"><a href="#cb344-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-853"><a href="#cb344-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: generate-decision-with-traits</span></span>
<span id="cb344-854"><a href="#cb344-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-855"><a href="#cb344-855" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Function: generate_decision_with_traits ----</span></span>
<span id="cb344-856"><a href="#cb344-856" aria-hidden="true" tabindex="-1"></a>generate_decision_with_traits <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">mode =</span> <span class="st">"all"</span>) {</span>
<span id="cb344-857"><a href="#cb344-857" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parameter validation</span></span>
<span id="cb344-858"><a href="#cb344-858" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>mode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"all"</span>, <span class="st">"train"</span>, <span class="st">"test"</span>, <span class="st">"merged"</span>)) {</span>
<span id="cb344-859"><a href="#cb344-859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"mode must be 'all', 'train', 'test', or 'merged'"</span>)</span>
<span id="cb344-860"><a href="#cb344-860" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-861"><a href="#cb344-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-862"><a href="#cb344-862" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- step 1: data filtering ----</span></span>
<span id="cb344-863"><a href="#cb344-863" aria-hidden="true" tabindex="-1"></a>  df_subset <span class="ot">&lt;-</span> <span class="cf">if</span> (mode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"all"</span>, <span class="st">"merged"</span>)) df <span class="cf">else</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> mode)</span>
<span id="cb344-864"><a href="#cb344-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-865"><a href="#cb344-865" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- step 2: data aggregation ----</span></span>
<span id="cb344-866"><a href="#cb344-866" aria-hidden="true" tabindex="-1"></a>  group_vars <span class="ot">&lt;-</span> <span class="cf">if</span> (mode <span class="sc">==</span> <span class="st">"merged"</span>) {</span>
<span id="cb344-867"><a href="#cb344-867" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"congress"</span>)</span>
<span id="cb344-868"><a href="#cb344-868" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb344-869"><a href="#cb344-869" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"congress"</span>, <span class="st">"dataset"</span>)</span>
<span id="cb344-870"><a href="#cb344-870" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-871"><a href="#cb344-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-872"><a href="#cb344-872" aria-hidden="true" tabindex="-1"></a>  df_clean <span class="ot">&lt;-</span> df_subset <span class="sc">%&gt;%</span></span>
<span id="cb344-873"><a href="#cb344-873" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(group_vars))) <span class="sc">%&gt;%</span></span>
<span id="cb344-874"><a href="#cb344-874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb344-875"><a href="#cb344-875" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_intl =</span> <span class="fu">sum</span>(importance_intl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-876"><a href="#cb344-876" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_dom  =</span> <span class="fu">sum</span>(importance_dom,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-877"><a href="#cb344-877" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_prof =</span> <span class="fu">sum</span>(importance_prof, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-878"><a href="#cb344-878" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_all  =</span> <span class="fu">sum</span>(importance_all,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-879"><a href="#cb344-879" aria-hidden="true" tabindex="-1"></a>      <span class="at">pred =</span> <span class="fu">mean</span>(pred, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-880"><a href="#cb344-880" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-881"><a href="#cb344-881" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-882"><a href="#cb344-882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-883"><a href="#cb344-883" aria-hidden="true" tabindex="-1"></a>      <span class="at">intl_percentage =</span> <span class="fu">ifelse</span>(importance_all <span class="sc">&gt;</span> <span class="dv">0</span>, importance_intl <span class="sc">/</span> importance_all, <span class="cn">NA_real_</span>),</span>
<span id="cb344-884"><a href="#cb344-884" aria-hidden="true" tabindex="-1"></a>      <span class="at">dom_percentage  =</span> <span class="fu">ifelse</span>(importance_all <span class="sc">&gt;</span> <span class="dv">0</span>, importance_dom  <span class="sc">/</span> importance_all, <span class="cn">NA_real_</span>),</span>
<span id="cb344-885"><a href="#cb344-885" aria-hidden="true" tabindex="-1"></a>      <span class="at">prof_percentage =</span> <span class="fu">ifelse</span>(importance_all <span class="sc">&gt;</span> <span class="dv">0</span>, importance_prof <span class="sc">/</span> importance_all, <span class="cn">NA_real_</span>),</span>
<span id="cb344-886"><a href="#cb344-886" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_val =</span> <span class="fu">pmax</span>(intl_percentage, dom_percentage, prof_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-887"><a href="#cb344-887" aria-hidden="true" tabindex="-1"></a>      <span class="at">decision =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-888"><a href="#cb344-888" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(max_val) <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb344-889"><a href="#cb344-889" aria-hidden="true" tabindex="-1"></a>        intl_percentage <span class="sc">==</span> max_val <span class="sc">&amp;</span> dom_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> prof_percentage <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"intl"</span>,</span>
<span id="cb344-890"><a href="#cb344-890" aria-hidden="true" tabindex="-1"></a>        dom_percentage  <span class="sc">==</span> max_val <span class="sc">&amp;</span> intl_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> prof_percentage <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"dom"</span>,</span>
<span id="cb344-891"><a href="#cb344-891" aria-hidden="true" tabindex="-1"></a>        prof_percentage <span class="sc">==</span> max_val <span class="sc">&amp;</span> intl_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> dom_percentage <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"prof"</span>,</span>
<span id="cb344-892"><a href="#cb344-892" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"tie"</span></span>
<span id="cb344-893"><a href="#cb344-893" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-894"><a href="#cb344-894" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-895"><a href="#cb344-895" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>max_val, <span class="sc">-</span>importance_all)</span>
<span id="cb344-896"><a href="#cb344-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-897"><a href="#cb344-897" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- step3: trait merging ----</span></span>
<span id="cb344-898"><a href="#cb344-898" aria-hidden="true" tabindex="-1"></a>  traits <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-899"><a href="#cb344-899" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(full_name, congress, dataset, party, chamber, committee_el,</span>
<span id="cb344-900"><a href="#cb344-900" aria-hidden="true" tabindex="-1"></a>           gender, age, seniority, ideology, district, state_code, bioguide_id) <span class="sc">%&gt;%</span></span>
<span id="cb344-901"><a href="#cb344-901" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb344-902"><a href="#cb344-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-903"><a href="#cb344-903" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">==</span> <span class="st">"merged"</span>) {</span>
<span id="cb344-904"><a href="#cb344-904" aria-hidden="true" tabindex="-1"></a>    traits <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span></span>
<span id="cb344-905"><a href="#cb344-905" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(full_name, congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-906"><a href="#cb344-906" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb344-907"><a href="#cb344-907" aria-hidden="true" tabindex="-1"></a>        <span class="at">party =</span> <span class="fu">first</span>(party),</span>
<span id="cb344-908"><a href="#cb344-908" aria-hidden="true" tabindex="-1"></a>        <span class="at">chamber =</span> <span class="fu">first</span>(chamber),</span>
<span id="cb344-909"><a href="#cb344-909" aria-hidden="true" tabindex="-1"></a>        <span class="at">committee_el =</span> <span class="fu">first</span>(<span class="fu">na.omit</span>(committee_el)),</span>
<span id="cb344-910"><a href="#cb344-910" aria-hidden="true" tabindex="-1"></a>        <span class="at">gender =</span> <span class="fu">first</span>(gender),</span>
<span id="cb344-911"><a href="#cb344-911" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-912"><a href="#cb344-912" aria-hidden="true" tabindex="-1"></a>        <span class="at">seniority =</span> <span class="fu">mean</span>(seniority, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-913"><a href="#cb344-913" aria-hidden="true" tabindex="-1"></a>        <span class="at">ideology =</span> <span class="fu">mean</span>(ideology, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-914"><a href="#cb344-914" aria-hidden="true" tabindex="-1"></a>        <span class="at">district =</span> <span class="fu">first</span>(district),</span>
<span id="cb344-915"><a href="#cb344-915" aria-hidden="true" tabindex="-1"></a>        <span class="at">state_code =</span> <span class="fu">first</span>(state_code),</span>
<span id="cb344-916"><a href="#cb344-916" aria-hidden="true" tabindex="-1"></a>        <span class="at">bioguide_id =</span> <span class="fu">first</span>(bioguide_id),</span>
<span id="cb344-917"><a href="#cb344-917" aria-hidden="true" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-918"><a href="#cb344-918" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-919"><a href="#cb344-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-920"><a href="#cb344-920" aria-hidden="true" tabindex="-1"></a>    df_final <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb344-921"><a href="#cb344-921" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(traits, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"congress"</span>))</span>
<span id="cb344-922"><a href="#cb344-922" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb344-923"><a href="#cb344-923" aria-hidden="true" tabindex="-1"></a>    df_final <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb344-924"><a href="#cb344-924" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(traits, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"full_name"</span>, <span class="st">"congress"</span>, <span class="st">"dataset"</span>))</span>
<span id="cb344-925"><a href="#cb344-925" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-926"><a href="#cb344-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-927"><a href="#cb344-927" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- step 4: join and label formatting ----</span></span>
<span id="cb344-928"><a href="#cb344-928" aria-hidden="true" tabindex="-1"></a>  df_final <span class="ot">&lt;-</span> df_final <span class="sc">%&gt;%</span></span>
<span id="cb344-929"><a href="#cb344-929" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)))</span>
<span id="cb344-930"><a href="#cb344-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-931"><a href="#cb344-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_final)</span>
<span id="cb344-932"><a href="#cb344-932" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-933"><a href="#cb344-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-934"><a href="#cb344-934" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- application ----</span></span>
<span id="cb344-935"><a href="#cb344-935" aria-hidden="true" tabindex="-1"></a><span class="co">#df_train &lt;- generate_decision_with_traits_dual(df, mode = "train")</span></span>
<span id="cb344-936"><a href="#cb344-936" aria-hidden="true" tabindex="-1"></a><span class="co">#df_test &lt;- generate_decision_with_traits_dual(df, mode = "test")</span></span>
<span id="cb344-937"><a href="#cb344-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-938"><a href="#cb344-938" aria-hidden="true" tabindex="-1"></a><span class="co"># adv</span></span>
<span id="cb344-939"><a href="#cb344-939" aria-hidden="true" tabindex="-1"></a>adver_cg <span class="ot">&lt;-</span> <span class="fu">generate_decision_with_traits</span>(adver_sum1, <span class="at">mode =</span> <span class="st">"merged"</span>)</span>
<span id="cb344-940"><a href="#cb344-940" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-941"><a href="#cb344-941" aria-hidden="true" tabindex="-1"></a>legis_cg <span class="ot">&lt;-</span> <span class="fu">generate_decision_with_traits</span>(legis_sum1, <span class="at">mode =</span> <span class="st">"merged"</span>)</span>
<span id="cb344-942"><a href="#cb344-942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-943"><a href="#cb344-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-944"><a href="#cb344-944" aria-hidden="true" tabindex="-1"></a><span class="fu">## topic level aggregation</span></span>
<span id="cb344-945"><a href="#cb344-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-946"><a href="#cb344-946" aria-hidden="true" tabindex="-1"></a>generate function: generate_decision_with_issue()</span>
<span id="cb344-947"><a href="#cb344-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-948"><a href="#cb344-948" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This function processes legislative data to summarize each legislator's issue-level decision pattern (international, domestic, or professional). It groups the data by legislator, Congress session, and issue, aggregates importance scores, and calculates the dominant decision type for each group.</span></span>
<span id="cb344-949"><a href="#cb344-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-952"><a href="#cb344-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-953"><a href="#cb344-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: generate decision with issues</span></span>
<span id="cb344-954"><a href="#cb344-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-955"><a href="#cb344-955" aria-hidden="true" tabindex="-1"></a>generate_decision_with_issues <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">set_name =</span> <span class="st">"all"</span>) {</span>
<span id="cb344-956"><a href="#cb344-956" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Optional filter by dataset (train/test)</span></span>
<span id="cb344-957"><a href="#cb344-957" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (set_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"train"</span>, <span class="st">"test"</span>)) {</span>
<span id="cb344-958"><a href="#cb344-958" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> set_name)</span>
<span id="cb344-959"><a href="#cb344-959" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-960"><a href="#cb344-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-961"><a href="#cb344-961" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: Group by issue-congress level and summarize</span></span>
<span id="cb344-962"><a href="#cb344-962" aria-hidden="true" tabindex="-1"></a>  df_clean <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-963"><a href="#cb344-963" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(issue, congress, committee_el) <span class="sc">%&gt;%</span>  <span class="co"># 保留 dataset 信息</span></span>
<span id="cb344-964"><a href="#cb344-964" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb344-965"><a href="#cb344-965" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">sum</span>(label, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-966"><a href="#cb344-966" aria-hidden="true" tabindex="-1"></a>      <span class="at">pred =</span> <span class="fu">mean</span>(pred, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-967"><a href="#cb344-967" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_intl =</span> <span class="fu">sum</span>(importance_intl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-968"><a href="#cb344-968" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_dom =</span> <span class="fu">sum</span>(importance_dom, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-969"><a href="#cb344-969" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance_prof =</span> <span class="fu">sum</span>(importance_prof, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-970"><a href="#cb344-970" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb344-971"><a href="#cb344-971" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-972"><a href="#cb344-972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-973"><a href="#cb344-973" aria-hidden="true" tabindex="-1"></a>      <span class="at">total =</span> importance_intl <span class="sc">+</span> importance_dom <span class="sc">+</span> importance_prof,</span>
<span id="cb344-974"><a href="#cb344-974" aria-hidden="true" tabindex="-1"></a>      <span class="at">intl_percentage =</span> <span class="fu">ifelse</span>(total <span class="sc">&gt;</span> <span class="dv">0</span>, importance_intl <span class="sc">/</span> total, <span class="cn">NA_real_</span>),</span>
<span id="cb344-975"><a href="#cb344-975" aria-hidden="true" tabindex="-1"></a>      <span class="at">dom_percentage  =</span> <span class="fu">ifelse</span>(total <span class="sc">&gt;</span> <span class="dv">0</span>, importance_dom  <span class="sc">/</span> total, <span class="cn">NA_real_</span>),</span>
<span id="cb344-976"><a href="#cb344-976" aria-hidden="true" tabindex="-1"></a>      <span class="at">prof_percentage =</span> <span class="fu">ifelse</span>(total <span class="sc">&gt;</span> <span class="dv">0</span>, importance_prof <span class="sc">/</span> total, <span class="cn">NA_real_</span>),</span>
<span id="cb344-977"><a href="#cb344-977" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_val =</span> <span class="fu">pmax</span>(intl_percentage, dom_percentage, prof_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-978"><a href="#cb344-978" aria-hidden="true" tabindex="-1"></a>      <span class="at">decision =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-979"><a href="#cb344-979" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(max_val) <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb344-980"><a href="#cb344-980" aria-hidden="true" tabindex="-1"></a>        intl_percentage <span class="sc">==</span> max_val <span class="sc">&amp;</span> dom_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> prof_percentage <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"intl"</span>,</span>
<span id="cb344-981"><a href="#cb344-981" aria-hidden="true" tabindex="-1"></a>        dom_percentage  <span class="sc">==</span> max_val <span class="sc">&amp;</span> intl_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> prof_percentage <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"dom"</span>,</span>
<span id="cb344-982"><a href="#cb344-982" aria-hidden="true" tabindex="-1"></a>        prof_percentage <span class="sc">==</span> max_val <span class="sc">&amp;</span> intl_percentage <span class="sc">!=</span> max_val <span class="sc">&amp;</span> dom_percentage  <span class="sc">!=</span> max_val <span class="sc">~</span> <span class="st">"prof"</span>,</span>
<span id="cb344-983"><a href="#cb344-983" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"tie"</span></span>
<span id="cb344-984"><a href="#cb344-984" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-985"><a href="#cb344-985" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-986"><a href="#cb344-986" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>max_val, <span class="sc">-</span>total)</span>
<span id="cb344-987"><a href="#cb344-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-988"><a href="#cb344-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_clean)</span>
<span id="cb344-989"><a href="#cb344-989" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-990"><a href="#cb344-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-991"><a href="#cb344-991" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- application ----</span></span>
<span id="cb344-992"><a href="#cb344-992" aria-hidden="true" tabindex="-1"></a>adver_tp <span class="ot">&lt;-</span> <span class="fu">generate_decision_with_issues</span>(adver_sum)</span>
<span id="cb344-993"><a href="#cb344-993" aria-hidden="true" tabindex="-1"></a>legis_tp <span class="ot">&lt;-</span> <span class="fu">generate_decision_with_issues</span>(legis_sum)</span>
<span id="cb344-994"><a href="#cb344-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-995"><a href="#cb344-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-996"><a href="#cb344-996" aria-hidden="true" tabindex="-1"></a><span class="fu"># overall descriptive analysis for individual</span></span>
<span id="cb344-997"><a href="#cb344-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-998"><a href="#cb344-998" aria-hidden="true" tabindex="-1"></a>This block visualizes the distribution of legislators' decision types (intl/dom/prof) in both adver and legis datasets. It includes overall bar plots and congress-specific facet plots. Additionally, it inspects label distributions across congress, party, chamber, gender, and committee.</span>
<span id="cb344-999"><a href="#cb344-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1000"><a href="#cb344-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## distribution plots</span></span>
<span id="cb344-1001"><a href="#cb344-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1002"><a href="#cb344-1002" aria-hidden="true" tabindex="-1"></a>overall</span>
<span id="cb344-1003"><a href="#cb344-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1006"><a href="#cb344-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1007"><a href="#cb344-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: overall barplot</span></span>
<span id="cb344-1008"><a href="#cb344-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1009"><a href="#cb344-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1010"><a href="#cb344-1010" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-1011"><a href="#cb344-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adver_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb344-1012"><a href="#cb344-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb344-1013"><a href="#cb344-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb344-1014"><a href="#cb344-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb344-1015"><a href="#cb344-1015" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1016"><a href="#cb344-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label=</span>..count..), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb344-1017"><a href="#cb344-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen adver"</span>,</span>
<span id="cb344-1018"><a href="#cb344-1018" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"decision mode"</span>,</span>
<span id="cb344-1019"><a href="#cb344-1019" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"number"</span>) <span class="sc">+</span></span>
<span id="cb344-1020"><a href="#cb344-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb344-1021"><a href="#cb344-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1022"><a href="#cb344-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1023"><a href="#cb344-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#legis</span></span>
<span id="cb344-1024"><a href="#cb344-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(legis_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb344-1025"><a href="#cb344-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb344-1026"><a href="#cb344-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb344-1027"><a href="#cb344-1027" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb344-1028"><a href="#cb344-1028" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1029"><a href="#cb344-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label=</span>..count..), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb344-1030"><a href="#cb344-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen legis"</span>,</span>
<span id="cb344-1031"><a href="#cb344-1031" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"decision mode"</span>,</span>
<span id="cb344-1032"><a href="#cb344-1032" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"number"</span>) <span class="sc">+</span></span>
<span id="cb344-1033"><a href="#cb344-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb344-1034"><a href="#cb344-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1035"><a href="#cb344-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1036"><a href="#cb344-1036" aria-hidden="true" tabindex="-1"></a>by congress</span>
<span id="cb344-1037"><a href="#cb344-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1040"><a href="#cb344-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1041"><a href="#cb344-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: overall barplot by congress</span></span>
<span id="cb344-1042"><a href="#cb344-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adver_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb344-1043"><a href="#cb344-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb344-1044"><a href="#cb344-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb344-1045"><a href="#cb344-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb344-1046"><a href="#cb344-1046" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb344-1047"><a href="#cb344-1047" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1048"><a href="#cb344-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> congress, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb344-1049"><a href="#cb344-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen adver"</span>,</span>
<span id="cb344-1050"><a href="#cb344-1050" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decision Mode"</span>,</span>
<span id="cb344-1051"><a href="#cb344-1051" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number"</span>) <span class="sc">+</span></span>
<span id="cb344-1052"><a href="#cb344-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb344-1053"><a href="#cb344-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1054"><a href="#cb344-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(legis_cg, <span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb344-1055"><a href="#cb344-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb344-1056"><a href="#cb344-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb344-1057"><a href="#cb344-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb344-1058"><a href="#cb344-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>)</span>
<span id="cb344-1059"><a href="#cb344-1059" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1060"><a href="#cb344-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> congress, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb344-1061"><a href="#cb344-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"decision mode by congressmen legis"</span>,</span>
<span id="cb344-1062"><a href="#cb344-1062" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decision Mode"</span>,</span>
<span id="cb344-1063"><a href="#cb344-1063" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number"</span>) <span class="sc">+</span></span>
<span id="cb344-1064"><a href="#cb344-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb344-1065"><a href="#cb344-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1066"><a href="#cb344-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1067"><a href="#cb344-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">## distribution map</span></span>
<span id="cb344-1068"><a href="#cb344-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1069"><a href="#cb344-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">### map dataset generation and cleansing</span></span>
<span id="cb344-1070"><a href="#cb344-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1073"><a href="#cb344-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1074"><a href="#cb344-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mapdata preparation</span></span>
<span id="cb344-1075"><a href="#cb344-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1076"><a href="#cb344-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1077"><a href="#cb344-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- mapdata for house ----</span></span>
<span id="cb344-1078"><a href="#cb344-1078" aria-hidden="true" tabindex="-1"></a>adver_cg_heatmap <span class="ot">&lt;-</span> adver_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1079"><a href="#cb344-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chamber <span class="sc">==</span> <span class="st">"house of representatives"</span>)</span>
<span id="cb344-1080"><a href="#cb344-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1081"><a href="#cb344-1081" aria-hidden="true" tabindex="-1"></a>legis_cg_heatmap <span class="ot">&lt;-</span> legis_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1082"><a href="#cb344-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chamber <span class="sc">==</span> <span class="st">"house of representatives"</span>)</span>
<span id="cb344-1083"><a href="#cb344-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1084"><a href="#cb344-1084" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- mapdata for senate ----</span></span>
<span id="cb344-1085"><a href="#cb344-1085" aria-hidden="true" tabindex="-1"></a>adver_cg_heatmap1 <span class="ot">&lt;-</span> adver_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1086"><a href="#cb344-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chamber <span class="sc">==</span> <span class="st">"senate"</span>)</span>
<span id="cb344-1087"><a href="#cb344-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1088"><a href="#cb344-1088" aria-hidden="true" tabindex="-1"></a>legis_cg_heatmap1 <span class="ot">&lt;-</span> legis_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1089"><a href="#cb344-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chamber <span class="sc">==</span> <span class="st">"senate"</span>)</span>
<span id="cb344-1090"><a href="#cb344-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1091"><a href="#cb344-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1092"><a href="#cb344-1092" aria-hidden="true" tabindex="-1"></a>district cleansing</span>
<span id="cb344-1093"><a href="#cb344-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1096"><a href="#cb344-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1097"><a href="#cb344-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: district cleansing for mapdata</span></span>
<span id="cb344-1098"><a href="#cb344-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1099"><a href="#cb344-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1100"><a href="#cb344-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(adver_cg_heatmap<span class="sc">$</span>district[<span class="fu">is.na</span>(<span class="fu">as.integer</span>(adver_cg_heatmap<span class="sc">$</span>district))]) <span class="co"># debug district data issue</span></span>
<span id="cb344-1101"><a href="#cb344-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1102"><a href="#cb344-1102" aria-hidden="true" tabindex="-1"></a>adver_cg_heatmap  <span class="ot">&lt;-</span> adver_cg_heatmap  <span class="sc">%&gt;%</span></span>
<span id="cb344-1103"><a href="#cb344-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-1104"><a href="#cb344-1104" aria-hidden="true" tabindex="-1"></a>    <span class="at">district_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-1105"><a href="#cb344-1105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"At Large"</span>, district, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"00"</span>,</span>
<span id="cb344-1106"><a href="#cb344-1106" aria-hidden="true" tabindex="-1"></a>      state_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"AS"</span>, <span class="st">"GU"</span>, <span class="st">"MP"</span>, <span class="st">"PR"</span>, <span class="st">"VI"</span>) <span class="sc">~</span> <span class="st">"98"</span>,</span>
<span id="cb344-1107"><a href="#cb344-1107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^[0-9]+$"</span>, district) <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, <span class="fu">as.integer</span>(district)),</span>
<span id="cb344-1108"><a href="#cb344-1108" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^[0-9]+(st|nd|rd|th)$"</span>, district, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="fu">sprintf</span>(</span>
<span id="cb344-1109"><a href="#cb344-1109" aria-hidden="true" tabindex="-1"></a>        <span class="st">"%02d"</span>, <span class="fu">as.integer</span>(<span class="fu">str_extract</span>(district, <span class="st">"^[0-9]+"</span>))</span>
<span id="cb344-1110"><a href="#cb344-1110" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb344-1111"><a href="#cb344-1111" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  </span>
<span id="cb344-1112"><a href="#cb344-1112" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb344-1113"><a href="#cb344-1113" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_district =</span> <span class="fu">paste0</span>(state_code, <span class="st">"-"</span>, district_clean)</span>
<span id="cb344-1114"><a href="#cb344-1114" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># turn at-large into 00</span></span>
<span id="cb344-1115"><a href="#cb344-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(adver_cg_heatmap<span class="sc">$</span>district_clean[<span class="fu">is.na</span>(<span class="fu">as.integer</span>(adver_cg_heatmap<span class="sc">$</span>district_clean))]) <span class="co"># check results</span></span>
<span id="cb344-1116"><a href="#cb344-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1117"><a href="#cb344-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(legis_cg_heatmap<span class="sc">$</span>district[<span class="fu">is.na</span>(<span class="fu">as.integer</span>(legis_cg_heatmap<span class="sc">$</span>district))]) <span class="co"># debug district data issue</span></span>
<span id="cb344-1118"><a href="#cb344-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1119"><a href="#cb344-1119" aria-hidden="true" tabindex="-1"></a>legis_cg_heatmap  <span class="ot">&lt;-</span> legis_cg_heatmap  <span class="sc">%&gt;%</span></span>
<span id="cb344-1120"><a href="#cb344-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb344-1121"><a href="#cb344-1121" aria-hidden="true" tabindex="-1"></a>    <span class="at">district_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-1122"><a href="#cb344-1122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"At Large"</span>, district, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"00"</span>,</span>
<span id="cb344-1123"><a href="#cb344-1123" aria-hidden="true" tabindex="-1"></a>      state_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"AS"</span>, <span class="st">"GU"</span>, <span class="st">"MP"</span>, <span class="st">"PR"</span>, <span class="st">"VI"</span>) <span class="sc">~</span> <span class="st">"98"</span>,</span>
<span id="cb344-1124"><a href="#cb344-1124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^[0-9]+$"</span>, district) <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, <span class="fu">as.integer</span>(district)),</span>
<span id="cb344-1125"><a href="#cb344-1125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^[0-9]+(st|nd|rd|th)$"</span>, district, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="fu">sprintf</span>(</span>
<span id="cb344-1126"><a href="#cb344-1126" aria-hidden="true" tabindex="-1"></a>        <span class="st">"%02d"</span>, <span class="fu">as.integer</span>(<span class="fu">str_extract</span>(district, <span class="st">"^[0-9]+"</span>))</span>
<span id="cb344-1127"><a href="#cb344-1127" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb344-1128"><a href="#cb344-1128" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  </span>
<span id="cb344-1129"><a href="#cb344-1129" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb344-1130"><a href="#cb344-1130" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_district =</span> <span class="fu">paste0</span>(state_code, <span class="st">"-"</span>, district_clean)</span>
<span id="cb344-1131"><a href="#cb344-1131" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1132"><a href="#cb344-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(legis_cg_heatmap<span class="sc">$</span>district_clean[<span class="fu">is.na</span>(<span class="fu">as.integer</span>(legis_cg_heatmap<span class="sc">$</span>district_clean))]) </span>
<span id="cb344-1133"><a href="#cb344-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1134"><a href="#cb344-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1135"><a href="#cb344-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">### flip-key construction </span></span>
<span id="cb344-1136"><a href="#cb344-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1139"><a href="#cb344-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1140"><a href="#cb344-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: state flip key</span></span>
<span id="cb344-1141"><a href="#cb344-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1142"><a href="#cb344-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1143"><a href="#cb344-1143" aria-hidden="true" tabindex="-1"></a><span class="co"># fips-state</span></span>
<span id="cb344-1144"><a href="#cb344-1144" aria-hidden="true" tabindex="-1"></a>fips_state_map <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb344-1145"><a href="#cb344-1145" aria-hidden="true" tabindex="-1"></a>  <span class="at">fips =</span> <span class="fu">c</span>(</span>
<span id="cb344-1146"><a href="#cb344-1146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"01"</span>,<span class="st">"02"</span>,<span class="st">"04"</span>,<span class="st">"05"</span>,<span class="st">"06"</span>,<span class="st">"08"</span>,<span class="st">"09"</span>,<span class="st">"10"</span>,<span class="st">"12"</span>,<span class="st">"13"</span>,<span class="st">"15"</span>,<span class="st">"16"</span>,<span class="st">"17"</span>,<span class="st">"18"</span>,<span class="st">"19"</span>,</span>
<span id="cb344-1147"><a href="#cb344-1147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"20"</span>,<span class="st">"21"</span>,<span class="st">"22"</span>,<span class="st">"23"</span>,<span class="st">"24"</span>,<span class="st">"25"</span>,<span class="st">"26"</span>,<span class="st">"27"</span>,<span class="st">"28"</span>,<span class="st">"29"</span>,<span class="st">"30"</span>,<span class="st">"31"</span>,<span class="st">"32"</span>,<span class="st">"33"</span>,<span class="st">"34"</span>,</span>
<span id="cb344-1148"><a href="#cb344-1148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"35"</span>,<span class="st">"36"</span>,<span class="st">"37"</span>,<span class="st">"38"</span>,<span class="st">"39"</span>,<span class="st">"40"</span>,<span class="st">"41"</span>,<span class="st">"42"</span>,<span class="st">"44"</span>,<span class="st">"45"</span>,<span class="st">"46"</span>,<span class="st">"47"</span>,<span class="st">"48"</span>,<span class="st">"49"</span>,<span class="st">"50"</span>,</span>
<span id="cb344-1149"><a href="#cb344-1149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"51"</span>,<span class="st">"53"</span>,<span class="st">"54"</span>,<span class="st">"55"</span>,<span class="st">"56"</span>,<span class="st">"11"</span>,<span class="st">"60"</span>,<span class="st">"66"</span>,<span class="st">"69"</span>,<span class="st">"72"</span>,<span class="st">"78"</span></span>
<span id="cb344-1150"><a href="#cb344-1150" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-1151"><a href="#cb344-1151" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">c</span>(</span>
<span id="cb344-1152"><a href="#cb344-1152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AL"</span>,<span class="st">"AK"</span>,<span class="st">"AZ"</span>,<span class="st">"AR"</span>,<span class="st">"CA"</span>,<span class="st">"CO"</span>,<span class="st">"CT"</span>,<span class="st">"DE"</span>,<span class="st">"FL"</span>,<span class="st">"GA"</span>,<span class="st">"HI"</span>,<span class="st">"ID"</span>,<span class="st">"IL"</span>,<span class="st">"IN"</span>,<span class="st">"IA"</span>,</span>
<span id="cb344-1153"><a href="#cb344-1153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KS"</span>,<span class="st">"KY"</span>,<span class="st">"LA"</span>,<span class="st">"ME"</span>,<span class="st">"MD"</span>,<span class="st">"MA"</span>,<span class="st">"MI"</span>,<span class="st">"MN"</span>,<span class="st">"MS"</span>,<span class="st">"MO"</span>,<span class="st">"MT"</span>,<span class="st">"NE"</span>,<span class="st">"NV"</span>,<span class="st">"NH"</span>,<span class="st">"NJ"</span>,</span>
<span id="cb344-1154"><a href="#cb344-1154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NM"</span>,<span class="st">"NY"</span>,<span class="st">"NC"</span>,<span class="st">"ND"</span>,<span class="st">"OH"</span>,<span class="st">"OK"</span>,<span class="st">"OR"</span>,<span class="st">"PA"</span>,<span class="st">"RI"</span>,<span class="st">"SC"</span>,<span class="st">"SD"</span>,<span class="st">"TN"</span>,<span class="st">"TX"</span>,<span class="st">"UT"</span>,<span class="st">"VT"</span>,</span>
<span id="cb344-1155"><a href="#cb344-1155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"VA"</span>,<span class="st">"WA"</span>,<span class="st">"WV"</span>,<span class="st">"WI"</span>,<span class="st">"WY"</span>,<span class="st">"DC"</span>,<span class="st">"AS"</span>,<span class="st">"GU"</span>,<span class="st">"MP"</span>,<span class="st">"PR"</span>,<span class="st">"VI"</span></span>
<span id="cb344-1156"><a href="#cb344-1156" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-1157"><a href="#cb344-1157" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb344-1158"><a href="#cb344-1158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-1159"><a href="#cb344-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1160"><a href="#cb344-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># custom transformers</span></span>
<span id="cb344-1161"><a href="#cb344-1161" aria-hidden="true" tabindex="-1"></a>state_to_fips <span class="ot">&lt;-</span> <span class="cf">function</span>(state_code) {</span>
<span id="cb344-1162"><a href="#cb344-1162" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> fips_state_map<span class="sc">$</span>fips[<span class="fu">match</span>(state_code, fips_state_map<span class="sc">$</span>state)]</span>
<span id="cb344-1163"><a href="#cb344-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb344-1164"><a href="#cb344-1164" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-1165"><a href="#cb344-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1166"><a href="#cb344-1166" aria-hidden="true" tabindex="-1"></a>fips_to_state <span class="ot">&lt;-</span> <span class="cf">function</span>(fips_code) {</span>
<span id="cb344-1167"><a href="#cb344-1167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sure fips_code is character</span></span>
<span id="cb344-1168"><a href="#cb344-1168" aria-hidden="true" tabindex="-1"></a>  fips_code <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%02s"</span>, <span class="fu">as.character</span>(fips_code))</span>
<span id="cb344-1169"><a href="#cb344-1169" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> fips_state_map<span class="sc">$</span>state[<span class="fu">match</span>(fips_code, fips_state_map<span class="sc">$</span>fips)]</span>
<span id="cb344-1170"><a href="#cb344-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb344-1171"><a href="#cb344-1171" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-1172"><a href="#cb344-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1173"><a href="#cb344-1173" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb344-1174"><a href="#cb344-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">fips_to_state</span>(<span class="st">"01"</span>)  <span class="co"># shoule be "AL"</span></span>
<span id="cb344-1175"><a href="#cb344-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">fips_to_state</span>(<span class="dv">9</span>)     <span class="co"># shoule be "CT"</span></span>
<span id="cb344-1176"><a href="#cb344-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">fips_to_state</span>(<span class="dv">23</span>)   <span class="co"># shoule be ME</span></span>
<span id="cb344-1177"><a href="#cb344-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">fips_to_state</span>(<span class="dv">44</span>)   <span class="co"># shoule be RI</span></span>
<span id="cb344-1178"><a href="#cb344-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">fips_to_state</span>(<span class="dv">6</span>)   <span class="co"># shoule be CA</span></span>
<span id="cb344-1179"><a href="#cb344-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1180"><a href="#cb344-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1181"><a href="#cb344-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">### house map generation function</span></span>
<span id="cb344-1182"><a href="#cb344-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1185"><a href="#cb344-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1186"><a href="#cb344-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: map function</span></span>
<span id="cb344-1187"><a href="#cb344-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1188"><a href="#cb344-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1189"><a href="#cb344-1189" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------ house map function ------------------</span></span>
<span id="cb344-1190"><a href="#cb344-1190" aria-hidden="true" tabindex="-1"></a>plot_decision_map_by_congress <span class="ot">&lt;-</span> <span class="cf">function</span>(congress_num,</span>
<span id="cb344-1191"><a href="#cb344-1191" aria-hidden="true" tabindex="-1"></a>                                          decision_data,</span>
<span id="cb344-1192"><a href="#cb344-1192" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">model_type =</span> <span class="fu">c</span>(<span class="st">"adver"</span>, <span class="st">"legis"</span>),</span>
<span id="cb344-1193"><a href="#cb344-1193" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">save_path =</span> <span class="cn">NULL</span>,</span>
<span id="cb344-1194"><a href="#cb344-1194" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">save_width =</span> <span class="dv">10</span>,</span>
<span id="cb344-1195"><a href="#cb344-1195" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">save_height =</span> <span class="dv">7</span>) {</span>
<span id="cb344-1196"><a href="#cb344-1196" aria-hidden="true" tabindex="-1"></a>  model_type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(model_type)</span>
<span id="cb344-1197"><a href="#cb344-1197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1198"><a href="#cb344-1198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- congress match ----</span></span>
<span id="cb344-1199"><a href="#cb344-1199" aria-hidden="true" tabindex="-1"></a>  map_year <span class="ot">&lt;-</span> <span class="cf">switch</span>(</span>
<span id="cb344-1200"><a href="#cb344-1200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(congress_num),</span>
<span id="cb344-1201"><a href="#cb344-1201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"115"</span> <span class="ot">=</span> <span class="dv">2016</span>,</span>
<span id="cb344-1202"><a href="#cb344-1202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"116"</span> <span class="ot">=</span> <span class="dv">2020</span>,</span>
<span id="cb344-1203"><a href="#cb344-1203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"117"</span> <span class="ot">=</span> <span class="dv">2020</span>,</span>
<span id="cb344-1204"><a href="#cb344-1204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"118"</span> <span class="ot">=</span> <span class="dv">2022</span>,</span>
<span id="cb344-1205"><a href="#cb344-1205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unsupported congress number."</span>)</span>
<span id="cb344-1206"><a href="#cb344-1206" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1207"><a href="#cb344-1207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1208"><a href="#cb344-1208" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- district match ----</span></span>
<span id="cb344-1209"><a href="#cb344-1209" aria-hidden="true" tabindex="-1"></a>  district_col <span class="ot">&lt;-</span> <span class="cf">switch</span>(</span>
<span id="cb344-1210"><a href="#cb344-1210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(congress_num),</span>
<span id="cb344-1211"><a href="#cb344-1211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"115"</span> <span class="ot">=</span> <span class="st">"CD115FP"</span>,</span>
<span id="cb344-1212"><a href="#cb344-1212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"116"</span> <span class="ot">=</span> <span class="st">"CD116FP"</span>,</span>
<span id="cb344-1213"><a href="#cb344-1213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"117"</span> <span class="ot">=</span> <span class="st">"CD116FP"</span>,</span>
<span id="cb344-1214"><a href="#cb344-1214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"118"</span> <span class="ot">=</span> <span class="st">"CD118FP"</span>,</span>
<span id="cb344-1215"><a href="#cb344-1215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unsupported congress number."</span>)</span>
<span id="cb344-1216"><a href="#cb344-1216" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1217"><a href="#cb344-1217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1218"><a href="#cb344-1218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- local fallback paths ----</span></span>
<span id="cb344-1219"><a href="#cb344-1219" aria-hidden="true" tabindex="-1"></a>  local_paths <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-1220"><a href="#cb344-1220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"115"</span> <span class="ot">=</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/map data from us census/cb_2016_us_cd115_500k/cb_2016_us_cd115_500k.shp"</span>,</span>
<span id="cb344-1221"><a href="#cb344-1221" aria-hidden="true" tabindex="-1"></a>    <span class="st">"116"</span> <span class="ot">=</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/map data from us census/tl_2020_us_cd116/tl_2020_us_cd116.shp"</span>,</span>
<span id="cb344-1222"><a href="#cb344-1222" aria-hidden="true" tabindex="-1"></a>    <span class="st">"117"</span> <span class="ot">=</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/map data from us census/tl_2020_us_cd116/tl_2020_us_cd116.shp"</span>, <span class="co"># same as 116</span></span>
<span id="cb344-1223"><a href="#cb344-1223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"118"</span> <span class="ot">=</span> <span class="st">"/Users/kunyazhan/Documents/GitHub/decodeCompetition/input/map data from us census/cb_2022_us_cd118_20m/cb_2022_us_cd118_20m.shp"</span></span>
<span id="cb344-1224"><a href="#cb344-1224" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1225"><a href="#cb344-1225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1226"><a href="#cb344-1226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- load map data ----</span></span>
<span id="cb344-1227"><a href="#cb344-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"🗺️ Loading congressional district map for "</span>, congress_num, <span class="st">"th Congress..."</span>)</span>
<span id="cb344-1228"><a href="#cb344-1228" aria-hidden="true" tabindex="-1"></a>  cd_map <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb344-1229"><a href="#cb344-1229" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb344-1230"><a href="#cb344-1230" aria-hidden="true" tabindex="-1"></a>      tigris<span class="sc">::</span><span class="fu">congressional_districts</span>(<span class="at">cb =</span> <span class="cn">TRUE</span>, <span class="at">year =</span> map_year)</span>
<span id="cb344-1231"><a href="#cb344-1231" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb344-1232"><a href="#cb344-1232" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb344-1233"><a href="#cb344-1233" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"⚠️ Cloud download failed. Loading from local file instead..."</span>)</span>
<span id="cb344-1234"><a href="#cb344-1234" aria-hidden="true" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_read</span>(local_paths[[<span class="fu">as.character</span>(congress_num)]], <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-1235"><a href="#cb344-1235" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-1236"><a href="#cb344-1236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1237"><a href="#cb344-1237" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1238"><a href="#cb344-1238" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- map data cleaning ----</span></span>
<span id="cb344-1239"><a href="#cb344-1239" aria-hidden="true" tabindex="-1"></a>  cd_map <span class="ot">&lt;-</span> cd_map <span class="sc">%&gt;%</span></span>
<span id="cb344-1240"><a href="#cb344-1240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-1241"><a href="#cb344-1241" aria-hidden="true" tabindex="-1"></a>      <span class="at">state_code =</span> <span class="fu">fips_to_state</span>(STATEFP),</span>
<span id="cb344-1242"><a href="#cb344-1242" aria-hidden="true" tabindex="-1"></a>      <span class="at">district_code =</span> <span class="fu">as.character</span>(<span class="sc">!!</span>rlang<span class="sc">::</span><span class="fu">sym</span>(district_col)),</span>
<span id="cb344-1243"><a href="#cb344-1243" aria-hidden="true" tabindex="-1"></a>      <span class="at">district_clean =</span> <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, <span class="fu">as.integer</span>(district_code)),</span>
<span id="cb344-1244"><a href="#cb344-1244" aria-hidden="true" tabindex="-1"></a>      <span class="at">state_district =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(<span class="fu">paste0</span>(state_code, <span class="st">"-"</span>, district_clean))</span>
<span id="cb344-1245"><a href="#cb344-1245" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-1246"><a href="#cb344-1246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1247"><a href="#cb344-1247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- decision data preparing ----</span></span>
<span id="cb344-1248"><a href="#cb344-1248" aria-hidden="true" tabindex="-1"></a>  decision_df <span class="ot">&lt;-</span> decision_data <span class="sc">%&gt;%</span></span>
<span id="cb344-1249"><a href="#cb344-1249" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(congress <span class="sc">==</span> <span class="fu">as.character</span>(congress_num)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1250"><a href="#cb344-1250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-1251"><a href="#cb344-1251" aria-hidden="true" tabindex="-1"></a>      <span class="at">state_district =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(<span class="fu">as.character</span>(state_district)),</span>
<span id="cb344-1252"><a href="#cb344-1252" aria-hidden="true" tabindex="-1"></a>      <span class="at">party =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-1253"><a href="#cb344-1253" aria-hidden="true" tabindex="-1"></a>        party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"Republican"</span>, <span class="st">"REP"</span>) <span class="sc">~</span> <span class="st">"R"</span>,</span>
<span id="cb344-1254"><a href="#cb344-1254" aria-hidden="true" tabindex="-1"></a>        party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"D"</span>, <span class="st">"Democratic"</span>, <span class="st">"DEM"</span>) <span class="sc">~</span> <span class="st">"D"</span>,</span>
<span id="cb344-1255"><a href="#cb344-1255" aria-hidden="true" tabindex="-1"></a>        party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"I"</span>, <span class="st">"Independent"</span>, <span class="st">"IND"</span>) <span class="sc">~</span> <span class="st">"I"</span>,</span>
<span id="cb344-1256"><a href="#cb344-1256" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb344-1257"><a href="#cb344-1257" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb344-1258"><a href="#cb344-1258" aria-hidden="true" tabindex="-1"></a>      <span class="at">decision =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-1259"><a href="#cb344-1259" aria-hidden="true" tabindex="-1"></a>        decision <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"intl"</span>, <span class="st">"international"</span>) <span class="sc">~</span> <span class="st">"intl"</span>,</span>
<span id="cb344-1260"><a href="#cb344-1260" aria-hidden="true" tabindex="-1"></a>        decision <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"dom"</span>, <span class="st">"domestic"</span>) <span class="sc">~</span> <span class="st">"dom"</span>,</span>
<span id="cb344-1261"><a href="#cb344-1261" aria-hidden="true" tabindex="-1"></a>        decision <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"prof"</span>, <span class="st">"professional"</span>) <span class="sc">~</span> <span class="st">"prof"</span>,</span>
<span id="cb344-1262"><a href="#cb344-1262" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb344-1263"><a href="#cb344-1263" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-1264"><a href="#cb344-1264" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-1265"><a href="#cb344-1265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1266"><a href="#cb344-1266" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- join map ----</span></span>
<span id="cb344-1267"><a href="#cb344-1267" aria-hidden="true" tabindex="-1"></a>  plot_df <span class="ot">&lt;-</span> cd_map <span class="sc">%&gt;%</span></span>
<span id="cb344-1268"><a href="#cb344-1268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(decision_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(state_district, decision, party),</span>
<span id="cb344-1269"><a href="#cb344-1269" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="st">"state_district"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-1270"><a href="#cb344-1270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-1271"><a href="#cb344-1271" aria-hidden="true" tabindex="-1"></a>      <span class="at">group_var =</span> <span class="fu">ifelse</span>(</span>
<span id="cb344-1272"><a href="#cb344-1272" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(party) <span class="sc">|</span> <span class="fu">is.na</span>(decision) <span class="sc">|</span> party <span class="sc">==</span> <span class="st">""</span> <span class="sc">|</span> decision <span class="sc">==</span> <span class="st">""</span>,</span>
<span id="cb344-1273"><a href="#cb344-1273" aria-hidden="true" tabindex="-1"></a>        <span class="st">"missing"</span>,</span>
<span id="cb344-1274"><a href="#cb344-1274" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(party, <span class="st">"_"</span>, decision)</span>
<span id="cb344-1275"><a href="#cb344-1275" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-1276"><a href="#cb344-1276" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-1277"><a href="#cb344-1277" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1278"><a href="#cb344-1278" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- color scheme ----</span></span>
<span id="cb344-1279"><a href="#cb344-1279" aria-hidden="true" tabindex="-1"></a>  pal_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb344-1280"><a href="#cb344-1280" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R_intl"</span> <span class="ot">=</span> <span class="st">"#ef8a62"</span>, <span class="st">"R_dom"</span> <span class="ot">=</span> <span class="st">"#b2182b"</span>, <span class="st">"R_prof"</span> <span class="ot">=</span> <span class="st">"#fddbc7"</span>,</span>
<span id="cb344-1281"><a href="#cb344-1281" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I_intl"</span> <span class="ot">=</span> <span class="st">"#9e9ac8"</span>, <span class="st">"I_dom"</span> <span class="ot">=</span> <span class="st">"#756bb1"</span>, <span class="st">"I_prof"</span> <span class="ot">=</span> <span class="st">"#dadaeb"</span>,</span>
<span id="cb344-1282"><a href="#cb344-1282" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D_intl"</span> <span class="ot">=</span> <span class="st">"#67a9cf"</span>, <span class="st">"D_dom"</span> <span class="ot">=</span> <span class="st">"#2166ac"</span>, <span class="st">"D_prof"</span> <span class="ot">=</span> <span class="st">"#d1e5f0"</span>,</span>
<span id="cb344-1283"><a href="#cb344-1283" aria-hidden="true" tabindex="-1"></a>    <span class="st">"missing"</span> <span class="ot">=</span> <span class="st">"grey80"</span></span>
<span id="cb344-1284"><a href="#cb344-1284" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1285"><a href="#cb344-1285" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1286"><a href="#cb344-1286" aria-hidden="true" tabindex="-1"></a>  all_levels <span class="ot">&lt;-</span> <span class="fu">names</span>(pal_vec)</span>
<span id="cb344-1287"><a href="#cb344-1287" aria-hidden="true" tabindex="-1"></a>  plot_df <span class="ot">&lt;-</span> plot_df <span class="sc">%&gt;%</span></span>
<span id="cb344-1288"><a href="#cb344-1288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">group_var =</span> <span class="fu">factor</span>(group_var, <span class="at">levels =</span> all_levels))</span>
<span id="cb344-1289"><a href="#cb344-1289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1290"><a href="#cb344-1290" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- main map ----</span></span>
<span id="cb344-1291"><a href="#cb344-1291" aria-hidden="true" tabindex="-1"></a>  main_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df) <span class="sc">+</span></span>
<span id="cb344-1292"><a href="#cb344-1292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> group_var), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb344-1293"><a href="#cb344-1293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_vec, <span class="at">drop =</span> <span class="cn">FALSE</span>, <span class="at">name =</span> <span class="st">"Party + Decision"</span>) <span class="sc">+</span></span>
<span id="cb344-1294"><a href="#cb344-1294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb344-1295"><a href="#cb344-1295" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb344-1296"><a href="#cb344-1296" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(model_type <span class="sc">==</span> <span class="st">"adver"</span>, <span class="st">"Adver"</span>, <span class="st">"Legis"</span>),</span>
<span id="cb344-1297"><a href="#cb344-1297" aria-hidden="true" tabindex="-1"></a>        <span class="st">" Decision Mode by District ("</span>, congress_num, <span class="st">"th Congress)"</span></span>
<span id="cb344-1298"><a href="#cb344-1298" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-1299"><a href="#cb344-1299" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb344-1300"><a href="#cb344-1300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-1301"><a href="#cb344-1301" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb344-1302"><a href="#cb344-1302" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">125</span>, <span class="sc">-</span><span class="dv">65</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">50</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-1303"><a href="#cb344-1303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1304"><a href="#cb344-1304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Alaska &amp; Hawaii ----</span></span>
<span id="cb344-1305"><a href="#cb344-1305" aria-hidden="true" tabindex="-1"></a>  alaska_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(plot_df, state_code <span class="sc">==</span> <span class="st">"AK"</span>)) <span class="sc">+</span></span>
<span id="cb344-1306"><a href="#cb344-1306" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> group_var), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb344-1307"><a href="#cb344-1307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_vec, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb344-1308"><a href="#cb344-1308" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="sc">-</span><span class="dv">130</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">72</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb344-1309"><a href="#cb344-1309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb344-1310"><a href="#cb344-1310" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1311"><a href="#cb344-1311" aria-hidden="true" tabindex="-1"></a>  hawaii_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(plot_df, state_code <span class="sc">==</span> <span class="st">"HI"</span>)) <span class="sc">+</span></span>
<span id="cb344-1312"><a href="#cb344-1312" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> group_var), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb344-1313"><a href="#cb344-1313" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_vec, <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb344-1314"><a href="#cb344-1314" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">161</span>, <span class="sc">-</span><span class="dv">154</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">23</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb344-1315"><a href="#cb344-1315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb344-1316"><a href="#cb344-1316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1317"><a href="#cb344-1317" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- combine ----</span></span>
<span id="cb344-1318"><a href="#cb344-1318" aria-hidden="true" tabindex="-1"></a>  final_map <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb344-1319"><a href="#cb344-1319" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">draw_plot</span>(main_map, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb344-1320"><a href="#cb344-1320" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">draw_plot</span>(alaska_map, <span class="at">x =</span> <span class="fl">0.03</span>, <span class="at">y =</span> <span class="fl">0.15</span>, <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">height =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb344-1321"><a href="#cb344-1321" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">draw_plot</span>(hawaii_map, <span class="at">x =</span> <span class="fl">0.20</span>, <span class="at">y =</span> <span class="fl">0.15</span>, <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">height =</span> <span class="fl">0.25</span>)</span>
<span id="cb344-1322"><a href="#cb344-1322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1323"><a href="#cb344-1323" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(save_path)) {</span>
<span id="cb344-1324"><a href="#cb344-1324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">filename =</span> save_path, <span class="at">plot =</span> final_map, <span class="at">width =</span> save_width, <span class="at">height =</span> save_height)</span>
<span id="cb344-1325"><a href="#cb344-1325" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-1326"><a href="#cb344-1326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1327"><a href="#cb344-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_map)</span>
<span id="cb344-1328"><a href="#cb344-1328" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-1329"><a href="#cb344-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1330"><a href="#cb344-1330" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- application ----</span></span>
<span id="cb344-1331"><a href="#cb344-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-1332"><a href="#cb344-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">115</span>, adver_cg_heatmap, <span class="at">model_type =</span> <span class="st">"adver"</span>,</span>
<span id="cb344-1333"><a href="#cb344-1333" aria-hidden="true" tabindex="-1"></a>                               <span class="at">save_path =</span> <span class="st">"adver_115_map.png"</span>)</span>
<span id="cb344-1334"><a href="#cb344-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1335"><a href="#cb344-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">116</span>, adver_cg_heatmap, <span class="at">model_type =</span> <span class="st">"adver"</span>,</span>
<span id="cb344-1336"><a href="#cb344-1336" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"adver_116_map.png"</span>)</span>
<span id="cb344-1337"><a href="#cb344-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1338"><a href="#cb344-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">117</span>, adver_cg_heatmap, <span class="at">model_type =</span> <span class="st">"adver"</span>,</span>
<span id="cb344-1339"><a href="#cb344-1339" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"adver_117_map.png"</span>)</span>
<span id="cb344-1340"><a href="#cb344-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1341"><a href="#cb344-1341" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">118</span>, adver_cg_heatmap, <span class="at">model_type =</span> <span class="st">"adver"</span>,</span>
<span id="cb344-1342"><a href="#cb344-1342" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"adver_118_map.png"</span>)</span>
<span id="cb344-1343"><a href="#cb344-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1344"><a href="#cb344-1344" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-1345"><a href="#cb344-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1346"><a href="#cb344-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">115</span>, legis_cg_heatmap, <span class="at">model_type =</span> <span class="st">"legis"</span>,</span>
<span id="cb344-1347"><a href="#cb344-1347" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"legis_115_map.png"</span>)</span>
<span id="cb344-1348"><a href="#cb344-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1349"><a href="#cb344-1349" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">116</span>, legis_cg_heatmap, <span class="at">model_type =</span> <span class="st">"legis"</span>,</span>
<span id="cb344-1350"><a href="#cb344-1350" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"legis_116_map.png"</span>)</span>
<span id="cb344-1351"><a href="#cb344-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1352"><a href="#cb344-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">117</span>, legis_cg_heatmap, <span class="at">model_type =</span> <span class="st">"legis"</span>,</span>
<span id="cb344-1353"><a href="#cb344-1353" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"legis_117_map.png"</span>)</span>
<span id="cb344-1354"><a href="#cb344-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1355"><a href="#cb344-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_map_by_congress</span>(<span class="dv">118</span>, legis_cg_heatmap, <span class="at">model_type =</span> <span class="st">"legis"</span>,</span>
<span id="cb344-1356"><a href="#cb344-1356" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_path =</span> <span class="st">"legis_118_map.png"</span>)</span>
<span id="cb344-1357"><a href="#cb344-1357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1358"><a href="#cb344-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1359"><a href="#cb344-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">### senate map function (need further debug)</span></span>
<span id="cb344-1360"><a href="#cb344-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1363"><a href="#cb344-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1364"><a href="#cb344-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: senate map function</span></span>
<span id="cb344-1365"><a href="#cb344-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1366"><a href="#cb344-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1367"><a href="#cb344-1367" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------ senate map function（needs further debug） ------------------</span></span>
<span id="cb344-1368"><a href="#cb344-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_decision_map_by_congress_senate_debug &lt;- function(congress_num,</span></span>
<span id="cb344-1369"><a href="#cb344-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       decision_data,</span></span>
<span id="cb344-1370"><a href="#cb344-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       model_type = c("adver", "legis"),</span></span>
<span id="cb344-1371"><a href="#cb344-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       save_path = NULL,</span></span>
<span id="cb344-1372"><a href="#cb344-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       save_width = 10,</span></span>
<span id="cb344-1373"><a href="#cb344-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       save_height = 7,</span></span>
<span id="cb344-1374"><a href="#cb344-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       shapefile_path = #"cb_2020_us_state_20m/cb_2020_us_state_20m.shp") {</span></span>
<span id="cb344-1375"><a href="#cb344-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#  library(dplyr)</span></span>
<span id="cb344-1376"><a href="#cb344-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#  library(sf)</span></span>
<span id="cb344-1377"><a href="#cb344-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#  library(ggplot2)</span></span>
<span id="cb344-1378"><a href="#cb344-1378" aria-hidden="true" tabindex="-1"></a><span class="co">#  library(stringr)</span></span>
<span id="cb344-1379"><a href="#cb344-1379" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1380"><a href="#cb344-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#  model_type &lt;- match.arg(model_type)</span></span>
<span id="cb344-1381"><a href="#cb344-1381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1382"><a href="#cb344-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("???? 开始读取州地图...\n")</span></span>
<span id="cb344-1383"><a href="#cb344-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#  states_map &lt;- sf::st_read(shapefile_path, quiet = TRUE) %&gt;%</span></span>
<span id="cb344-1384"><a href="#cb344-1384" aria-hidden="true" tabindex="-1"></a><span class="co">#    filter(!STUSPS %in% c("PR", "VI", "GU", "MP", "AS")) %&gt;%</span></span>
<span id="cb344-1385"><a href="#cb344-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(state_code = toupper(STUSPS))</span></span>
<span id="cb344-1386"><a href="#cb344-1386" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1387"><a href="#cb344-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("州地图数据前几行:\n")</span></span>
<span id="cb344-1388"><a href="#cb344-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#  print(head(states_map %&gt;% st_drop_geometry() %&gt;% select(STATEFP, STUSPS, state_code)))</span></span>
<span id="cb344-1389"><a href="#cb344-1389" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1390"><a href="#cb344-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("???? 读取决策数据...\n")</span></span>
<span id="cb344-1391"><a href="#cb344-1391" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1392"><a href="#cb344-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#  decision_df &lt;- decision_data %&gt;%</span></span>
<span id="cb344-1393"><a href="#cb344-1393" aria-hidden="true" tabindex="-1"></a><span class="co">#    filter(congress == as.character(congress_num)) %&gt;%</span></span>
<span id="cb344-1394"><a href="#cb344-1394" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(</span></span>
<span id="cb344-1395"><a href="#cb344-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#      state_code = toupper(str_trim(as.character(state_code))),</span></span>
<span id="cb344-1396"><a href="#cb344-1396" aria-hidden="true" tabindex="-1"></a><span class="co">#      party = as.character(party),</span></span>
<span id="cb344-1397"><a href="#cb344-1397" aria-hidden="true" tabindex="-1"></a><span class="co">#      decision = as.character(decision)</span></span>
<span id="cb344-1398"><a href="#cb344-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#    ) %&gt;%</span></span>
<span id="cb344-1399"><a href="#cb344-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#    group_by(state_code) %&gt;%</span></span>
<span id="cb344-1400"><a href="#cb344-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#    summarize(</span></span>
<span id="cb344-1401"><a href="#cb344-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#      party = first(na.omit(party)),</span></span>
<span id="cb344-1402"><a href="#cb344-1402" aria-hidden="true" tabindex="-1"></a><span class="co">#      decision = first(na.omit(decision)),</span></span>
<span id="cb344-1403"><a href="#cb344-1403" aria-hidden="true" tabindex="-1"></a><span class="co">#      group_var = ifelse(</span></span>
<span id="cb344-1404"><a href="#cb344-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#        is.na(party) | is.na(decision) | party == "" | decision == "",</span></span>
<span id="cb344-1405"><a href="#cb344-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#        "missing",</span></span>
<span id="cb344-1406"><a href="#cb344-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#        paste0(party, "_", decision)</span></span>
<span id="cb344-1407"><a href="#cb344-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#      ),</span></span>
<span id="cb344-1408"><a href="#cb344-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#      .groups = "drop"</span></span>
<span id="cb344-1409"><a href="#cb344-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#    )</span></span>
<span id="cb344-1410"><a href="#cb344-1410" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1411"><a href="#cb344-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("决策数据前几行:\n")</span></span>
<span id="cb344-1412"><a href="#cb344-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#  print(head(decision_df))</span></span>
<span id="cb344-1413"><a href="#cb344-1413" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1414"><a href="#cb344-1414" aria-hidden="true" tabindex="-1"></a><span class="co">#  missing_states &lt;- setdiff(decision_df$state_code, states_map$state_code)</span></span>
<span id="cb344-1415"><a href="#cb344-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#  if (length(missing_states) &gt; 0) {</span></span>
<span id="cb344-1416"><a href="#cb344-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#    warning("这些 state_code 在地图数据中找不到: ", paste(missing_states, collapse = ", #"))</span></span>
<span id="cb344-1417"><a href="#cb344-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#  } else {</span></span>
<span id="cb344-1418"><a href="#cb344-1418" aria-hidden="true" tabindex="-1"></a><span class="co">#    cat("??? 所有 state_code 都匹配。\n")</span></span>
<span id="cb344-1419"><a href="#cb344-1419" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb344-1420"><a href="#cb344-1420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1421"><a href="#cb344-1421" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("???? 计算州中心点...\n")</span></span>
<span id="cb344-1422"><a href="#cb344-1422" aria-hidden="true" tabindex="-1"></a><span class="co">#  state_centroids &lt;- states_map %&gt;%</span></span>
<span id="cb344-1423"><a href="#cb344-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#    st_centroid() %&gt;%</span></span>
<span id="cb344-1424"><a href="#cb344-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#    st_coordinates() %&gt;%</span></span>
<span id="cb344-1425"><a href="#cb344-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#    as.data.frame() %&gt;%</span></span>
<span id="cb344-1426"><a href="#cb344-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(state_code = states_map$state_code)</span></span>
<span id="cb344-1427"><a href="#cb344-1427" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1428"><a href="#cb344-1428" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("州中心点数据前几行:\n")</span></span>
<span id="cb344-1429"><a href="#cb344-1429" aria-hidden="true" tabindex="-1"></a><span class="co">#  print(head(state_centroids))</span></span>
<span id="cb344-1430"><a href="#cb344-1430" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1431"><a href="#cb344-1431" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("???? 合并决策数据和中心点...\n")</span></span>
<span id="cb344-1432"><a href="#cb344-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot_points &lt;- decision_df %&gt;%</span></span>
<span id="cb344-1433"><a href="#cb344-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#    left_join(state_centroids, by = "state_code")</span></span>
<span id="cb344-1434"><a href="#cb344-1434" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1435"><a href="#cb344-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#  cat("合并后数据前几行:\n")</span></span>
<span id="cb344-1436"><a href="#cb344-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#  print(head(plot_points))</span></span>
<span id="cb344-1437"><a href="#cb344-1437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1438"><a href="#cb344-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#  if (nrow(plot_points) == 0) {</span></span>
<span id="cb344-1439"><a href="#cb344-1439" aria-hidden="true" tabindex="-1"></a><span class="co">#    stop("??? 合并后没有数据！请检查 state_code 是否一致。")</span></span>
<span id="cb344-1440"><a href="#cb344-1440" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb344-1441"><a href="#cb344-1441" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1442"><a href="#cb344-1442" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot_points &lt;- plot_points %&gt;%</span></span>
<span id="cb344-1443"><a href="#cb344-1443" aria-hidden="true" tabindex="-1"></a><span class="co">#    group_by(state_code) %&gt;%</span></span>
<span id="cb344-1444"><a href="#cb344-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(</span></span>
<span id="cb344-1445"><a href="#cb344-1445" aria-hidden="true" tabindex="-1"></a><span class="co">#      X = X + runif(n(), -0.3, 0.3),</span></span>
<span id="cb344-1446"><a href="#cb344-1446" aria-hidden="true" tabindex="-1"></a><span class="co">#      Y = Y + runif(n(), -0.3, 0.3)</span></span>
<span id="cb344-1447"><a href="#cb344-1447" aria-hidden="true" tabindex="-1"></a><span class="co">#    ) %&gt;%</span></span>
<span id="cb344-1448"><a href="#cb344-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#    ungroup()</span></span>
<span id="cb344-1449"><a href="#cb344-1449" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1450"><a href="#cb344-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#  pal_vec &lt;- c(</span></span>
<span id="cb344-1451"><a href="#cb344-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#    "R_intl"  = "#b2182b", "R_dom"   = "#ef8a62", "R_prof"  = "#fddbc7",</span></span>
<span id="cb344-1452"><a href="#cb344-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#    "I_intl"  = "#756bb1", "I_dom"   = "#9e9ac8", "I_prof"  = "#dadaeb",</span></span>
<span id="cb344-1453"><a href="#cb344-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#    "D_intl"  = "#2166ac", "D_dom"   = "#67a9cf", "D_prof"  = "#d1e5f0",</span></span>
<span id="cb344-1454"><a href="#cb344-1454" aria-hidden="true" tabindex="-1"></a><span class="co">#    "missing" = "grey80"</span></span>
<span id="cb344-1455"><a href="#cb344-1455" aria-hidden="true" tabindex="-1"></a><span class="co">#  )</span></span>
<span id="cb344-1456"><a href="#cb344-1456" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1457"><a href="#cb344-1457" aria-hidden="true" tabindex="-1"></a><span class="co">#  all_levels &lt;- c("R_intl","R_dom","R_prof",</span></span>
<span id="cb344-1458"><a href="#cb344-1458" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "I_intl","I_dom","I_prof",</span></span>
<span id="cb344-1459"><a href="#cb344-1459" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "D_intl","D_dom","D_prof",</span></span>
<span id="cb344-1460"><a href="#cb344-1460" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "missing")</span></span>
<span id="cb344-1461"><a href="#cb344-1461" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1462"><a href="#cb344-1462" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot_points &lt;- plot_points %&gt;%</span></span>
<span id="cb344-1463"><a href="#cb344-1463" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(group_var = factor(group_var, levels = all_levels))</span></span>
<span id="cb344-1464"><a href="#cb344-1464" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1465"><a href="#cb344-1465" aria-hidden="true" tabindex="-1"></a><span class="co">#  pal_vec &lt;- pal_vec[names(pal_vec) %in% levels(plot_points$group_var)]</span></span>
<span id="cb344-1466"><a href="#cb344-1466" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1467"><a href="#cb344-1467" aria-hidden="true" tabindex="-1"></a><span class="co">#  main_map &lt;- ggplot() +</span></span>
<span id="cb344-1468"><a href="#cb344-1468" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_sf(data = states_map, fill = "white", color = "black", size = 0.2) +</span></span>
<span id="cb344-1469"><a href="#cb344-1469" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_point(data = plot_points,</span></span>
<span id="cb344-1470"><a href="#cb344-1470" aria-hidden="true" tabindex="-1"></a><span class="co">#               aes(x = X, y = Y, fill = group_var),</span></span>
<span id="cb344-1471"><a href="#cb344-1471" aria-hidden="true" tabindex="-1"></a><span class="co">#               shape = 21, size = 3, color = "black") +</span></span>
<span id="cb344-1472"><a href="#cb344-1472" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_fill_manual(values = pal_vec, drop = FALSE, name = "Party + Decision") +</span></span>
<span id="cb344-1473"><a href="#cb344-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(</span></span>
<span id="cb344-1474"><a href="#cb344-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#      title = paste0(ifelse(model_type == "adver", "Adver", "Legis"),</span></span>
<span id="cb344-1475"><a href="#cb344-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#                     " Senate Decision Mode by State (", congress_num, "th)")</span></span>
<span id="cb344-1476"><a href="#cb344-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#    ) +</span></span>
<span id="cb344-1477"><a href="#cb344-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#    theme_minimal(base_size = 14) +</span></span>
<span id="cb344-1478"><a href="#cb344-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#    theme(legend.position = "bottom") +</span></span>
<span id="cb344-1479"><a href="#cb344-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#    coord_sf(xlim = c(-125, -65), ylim = c(24, 50), expand = FALSE)</span></span>
<span id="cb344-1480"><a href="#cb344-1480" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1481"><a href="#cb344-1481" aria-hidden="true" tabindex="-1"></a><span class="co">#  if (!is.null(save_path)) {</span></span>
<span id="cb344-1482"><a href="#cb344-1482" aria-hidden="true" tabindex="-1"></a><span class="co">#    ggsave(filename = save_path, plot = main_map, width = save_width, height = #save_height)</span></span>
<span id="cb344-1483"><a href="#cb344-1483" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb344-1484"><a href="#cb344-1484" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-1485"><a href="#cb344-1485" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(list(</span></span>
<span id="cb344-1486"><a href="#cb344-1486" aria-hidden="true" tabindex="-1"></a><span class="co">#    plot = main_map,</span></span>
<span id="cb344-1487"><a href="#cb344-1487" aria-hidden="true" tabindex="-1"></a><span class="co">#    states_map = states_map,</span></span>
<span id="cb344-1488"><a href="#cb344-1488" aria-hidden="true" tabindex="-1"></a><span class="co">#    decision_df = decision_df,</span></span>
<span id="cb344-1489"><a href="#cb344-1489" aria-hidden="true" tabindex="-1"></a><span class="co">#    state_centroids = state_centroids,</span></span>
<span id="cb344-1490"><a href="#cb344-1490" aria-hidden="true" tabindex="-1"></a><span class="co">#    plot_points = plot_points</span></span>
<span id="cb344-1491"><a href="#cb344-1491" aria-hidden="true" tabindex="-1"></a><span class="co">#  ))</span></span>
<span id="cb344-1492"><a href="#cb344-1492" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb344-1493"><a href="#cb344-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1494"><a href="#cb344-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1497"><a href="#cb344-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1498"><a href="#cb344-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: senate map debug</span></span>
<span id="cb344-1499"><a href="#cb344-1499" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1500"><a href="#cb344-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1501"><a href="#cb344-1501" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_decision_map_by_congress_senate_debug(</span></span>
<span id="cb344-1502"><a href="#cb344-1502" aria-hidden="true" tabindex="-1"></a><span class="co">#  115,</span></span>
<span id="cb344-1503"><a href="#cb344-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#  adver_cg_heatmap1,</span></span>
<span id="cb344-1504"><a href="#cb344-1504" aria-hidden="true" tabindex="-1"></a><span class="co">#  model_type = "adver",</span></span>
<span id="cb344-1505"><a href="#cb344-1505" aria-hidden="true" tabindex="-1"></a><span class="co">#  save_path = "adver_115_map_state.png",</span></span>
<span id="cb344-1506"><a href="#cb344-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#  shapefile_path = "cb_2020_us_state_20m/cb_2020_us_state_20m.shp"</span></span>
<span id="cb344-1507"><a href="#cb344-1507" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb344-1508"><a href="#cb344-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1509"><a href="#cb344-1509" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(states_map$state_code)</span></span>
<span id="cb344-1510"><a href="#cb344-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(adver_cg_heatmap1$state_code)</span></span>
<span id="cb344-1511"><a href="#cb344-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1512"><a href="#cb344-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># map cleansing ----</span></span>
<span id="cb344-1513"><a href="#cb344-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1514"><a href="#cb344-1514" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 读取本地 shapefile</span></span>
<span id="cb344-1515"><a href="#cb344-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#states_map &lt;- st_read("cb_2020_us_state_20m/cb_2020_us_state_20m.shp")</span></span>
<span id="cb344-1516"><a href="#cb344-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1517"><a href="#cb344-1517" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 去掉不是州的区域（比如波多黎各、关岛等）</span></span>
<span id="cb344-1518"><a href="#cb344-1518" aria-hidden="true" tabindex="-1"></a><span class="co">#states_map &lt;- states_map %&gt;% </span></span>
<span id="cb344-1519"><a href="#cb344-1519" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(!STUSPS %in% c("PR", "VI", "GU", "MP", "AS"))</span></span>
<span id="cb344-1520"><a href="#cb344-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1521"><a href="#cb344-1521" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 改列名，把 STUSPS 作为 state_code</span></span>
<span id="cb344-1522"><a href="#cb344-1522" aria-hidden="true" tabindex="-1"></a><span class="co">#states_map &lt;- states_map %&gt;%</span></span>
<span id="cb344-1523"><a href="#cb344-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(state_code = STUSPS)</span></span>
<span id="cb344-1524"><a href="#cb344-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1525"><a href="#cb344-1525" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 合并 shapefile 和你的数据</span></span>
<span id="cb344-1526"><a href="#cb344-1526" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_df &lt;- states_map %&gt;%</span></span>
<span id="cb344-1527"><a href="#cb344-1527" aria-hidden="true" tabindex="-1"></a><span class="co">#  left_join(adver_cg_heatmap1 %&gt;% </span></span>
<span id="cb344-1528"><a href="#cb344-1528" aria-hidden="true" tabindex="-1"></a><span class="co">#              select(state_code, decision, party),</span></span>
<span id="cb344-1529"><a href="#cb344-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#            by = "state_code") %&gt;%</span></span>
<span id="cb344-1530"><a href="#cb344-1530" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(</span></span>
<span id="cb344-1531"><a href="#cb344-1531" aria-hidden="true" tabindex="-1"></a><span class="co">#    party = as.character(party),</span></span>
<span id="cb344-1532"><a href="#cb344-1532" aria-hidden="true" tabindex="-1"></a><span class="co">#    decision = as.character(decision),</span></span>
<span id="cb344-1533"><a href="#cb344-1533" aria-hidden="true" tabindex="-1"></a><span class="co">#    group_var = ifelse(</span></span>
<span id="cb344-1534"><a href="#cb344-1534" aria-hidden="true" tabindex="-1"></a><span class="co">#      is.na(party) | is.na(decision) | party == "" | decision == "",</span></span>
<span id="cb344-1535"><a href="#cb344-1535" aria-hidden="true" tabindex="-1"></a><span class="co">#      "missing",</span></span>
<span id="cb344-1536"><a href="#cb344-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#      paste0(party, "_", decision)</span></span>
<span id="cb344-1537"><a href="#cb344-1537" aria-hidden="true" tabindex="-1"></a><span class="co">#    )</span></span>
<span id="cb344-1538"><a href="#cb344-1538" aria-hidden="true" tabindex="-1"></a><span class="co">#  )</span></span>
<span id="cb344-1539"><a href="#cb344-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1540"><a href="#cb344-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1541"><a href="#cb344-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1542"><a href="#cb344-1542" aria-hidden="true" tabindex="-1"></a><span class="fu"># overall descriptive analysis for issues</span></span>
<span id="cb344-1543"><a href="#cb344-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1544"><a href="#cb344-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">## analysis based on original data</span></span>
<span id="cb344-1545"><a href="#cb344-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1546"><a href="#cb344-1546" aria-hidden="true" tabindex="-1"></a><span class="fu">### news_data</span></span>
<span id="cb344-1547"><a href="#cb344-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1548"><a href="#cb344-1548" aria-hidden="true" tabindex="-1"></a>hereby using original data news_data and bills_data to depict issues</span>
<span id="cb344-1549"><a href="#cb344-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1552"><a href="#cb344-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1553"><a href="#cb344-1553" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: news_data cleansing</span></span>
<span id="cb344-1554"><a href="#cb344-1554" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1555"><a href="#cb344-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1556"><a href="#cb344-1556" aria-hidden="true" tabindex="-1"></a>news_data_aug <span class="ot">&lt;-</span> news_data <span class="sc">%&gt;%</span></span>
<span id="cb344-1557"><a href="#cb344-1557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="fu">as.integer</span>(congress)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1558"><a href="#cb344-1558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb344-1559"><a href="#cb344-1559" aria-hidden="true" tabindex="-1"></a>    adver_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1560"><a href="#cb344-1560" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="fu">as.integer</span>(congress)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-1561"><a href="#cb344-1561" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(bioguide_id, congress, chamber, gender, party, committee_el),</span>
<span id="cb344-1562"><a href="#cb344-1562" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"mid"</span> <span class="ot">=</span> <span class="st">"bioguide_id"</span>, <span class="st">"congress"</span> <span class="ot">=</span> <span class="st">"congress"</span>)</span>
<span id="cb344-1563"><a href="#cb344-1563" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1564"><a href="#cb344-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1565"><a href="#cb344-1565" aria-hidden="true" tabindex="-1"></a>news_data<span class="sc">$</span>congress <span class="ot">&lt;-</span> <span class="fu">as.character</span>(news_data<span class="sc">$</span>congress)</span>
<span id="cb344-1566"><a href="#cb344-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1567"><a href="#cb344-1567" aria-hidden="true" tabindex="-1"></a>missing_keys <span class="ot">&lt;-</span> news_data <span class="sc">%&gt;%</span></span>
<span id="cb344-1568"><a href="#cb344-1568" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mid, congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-1569"><a href="#cb344-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-1570"><a href="#cb344-1570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(adver_sum1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(bioguide_id, congress) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(),</span>
<span id="cb344-1571"><a href="#cb344-1571" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"mid"</span> <span class="ot">=</span> <span class="st">"bioguide_id"</span>, <span class="st">"congress"</span>))</span>
<span id="cb344-1572"><a href="#cb344-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1573"><a href="#cb344-1573" aria-hidden="true" tabindex="-1"></a>news_data_clean <span class="ot">&lt;-</span> news_data_aug <span class="sc">%&gt;%</span></span>
<span id="cb344-1574"><a href="#cb344-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(chamber), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(party)) </span>
<span id="cb344-1575"><a href="#cb344-1575" aria-hidden="true" tabindex="-1"></a><span class="co"># already proven that these data belongs to legislators who did not continue to serve the congress</span></span>
<span id="cb344-1576"><a href="#cb344-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1577"><a href="#cb344-1577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1578"><a href="#cb344-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1579"><a href="#cb344-1579" aria-hidden="true" tabindex="-1"></a>issues have major change on news data from 115th to 118th congress</span>
<span id="cb344-1580"><a href="#cb344-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1583"><a href="#cb344-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1584"><a href="#cb344-1584" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues news dramatic change</span></span>
<span id="cb344-1585"><a href="#cb344-1585" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1586"><a href="#cb344-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1587"><a href="#cb344-1587" aria-hidden="true" tabindex="-1"></a>issue_trend <span class="ot">&lt;-</span> news_data_clean <span class="sc">%&gt;%</span></span>
<span id="cb344-1588"><a href="#cb344-1588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1589"><a href="#cb344-1589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">news_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1590"><a href="#cb344-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1591"><a href="#cb344-1591" aria-hidden="true" tabindex="-1"></a><span class="co"># find the most drastic change </span></span>
<span id="cb344-1592"><a href="#cb344-1592" aria-hidden="true" tabindex="-1"></a>issue_trend_change <span class="ot">&lt;-</span> issue_trend <span class="sc">%&gt;%</span></span>
<span id="cb344-1593"><a href="#cb344-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1594"><a href="#cb344-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb344-1595"><a href="#cb344-1595" aria-hidden="true" tabindex="-1"></a>    <span class="at">change =</span> (news_count[congress <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">as.numeric</span>(congress))] <span class="sc">-</span> news_count[congress <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(congress))]) <span class="sc">/</span></span>
<span id="cb344-1596"><a href="#cb344-1596" aria-hidden="true" tabindex="-1"></a>             news_count[congress <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(congress))],</span>
<span id="cb344-1597"><a href="#cb344-1597" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-1598"><a href="#cb344-1598" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-1599"><a href="#cb344-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(change)))  <span class="co"># rank according to the absolute change</span></span>
<span id="cb344-1600"><a href="#cb344-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1601"><a href="#cb344-1601" aria-hidden="true" tabindex="-1"></a>top_issues <span class="ot">&lt;-</span> issue_trend_change <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(issue)</span>
<span id="cb344-1602"><a href="#cb344-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1603"><a href="#cb344-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1604"><a href="#cb344-1604" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb344-1605"><a href="#cb344-1605" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(issue_trend <span class="sc">%&gt;%</span> <span class="fu">filter</span>(issue <span class="sc">%in%</span> top_issues),</span>
<span id="cb344-1606"><a href="#cb344-1606" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(congress), <span class="at">y =</span> news_count, <span class="at">color =</span> issue)) <span class="sc">+</span></span>
<span id="cb344-1607"><a href="#cb344-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb344-1608"><a href="#cb344-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb344-1609"><a href="#cb344-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-1610"><a href="#cb344-1610" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"issue change 115–118"</span>,</span>
<span id="cb344-1611"><a href="#cb344-1611" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-1612"><a href="#cb344-1612" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"news number"</span>,</span>
<span id="cb344-1613"><a href="#cb344-1613" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"issue"</span></span>
<span id="cb344-1614"><a href="#cb344-1614" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1615"><a href="#cb344-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1616"><a href="#cb344-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb344-1617"><a href="#cb344-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb344-1618"><a href="#cb344-1618" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb344-1619"><a href="#cb344-1619" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-1620"><a href="#cb344-1620" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1621"><a href="#cb344-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1622"><a href="#cb344-1622" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"issue change most 115–118_news.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1623"><a href="#cb344-1623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1624"><a href="#cb344-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1625"><a href="#cb344-1625" aria-hidden="true" tabindex="-1"></a>trends plot for all issues</span>
<span id="cb344-1626"><a href="#cb344-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1629"><a href="#cb344-1629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1630"><a href="#cb344-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues news all trend</span></span>
<span id="cb344-1631"><a href="#cb344-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1632"><a href="#cb344-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1633"><a href="#cb344-1633" aria-hidden="true" tabindex="-1"></a>n_colors <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(issue_trend<span class="sc">$</span>issue)) <span class="co"># 获取议题数量</span></span>
<span id="cb344-1634"><a href="#cb344-1634" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">distinctColorPalette</span>(n_colors)</span>
<span id="cb344-1635"><a href="#cb344-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1636"><a href="#cb344-1636" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(issue_trend, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(congress), <span class="at">y =</span> news_count, <span class="at">color =</span> issue)) <span class="sc">+</span></span>
<span id="cb344-1637"><a href="#cb344-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb344-1638"><a href="#cb344-1638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb344-1639"><a href="#cb344-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-1640"><a href="#cb344-1640" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"issue change per Congress"</span>,</span>
<span id="cb344-1641"><a href="#cb344-1641" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-1642"><a href="#cb344-1642" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"news number"</span>,</span>
<span id="cb344-1643"><a href="#cb344-1643" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"issue"</span></span>
<span id="cb344-1644"><a href="#cb344-1644" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1645"><a href="#cb344-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1646"><a href="#cb344-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb344-1647"><a href="#cb344-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb344-1648"><a href="#cb344-1648" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb344-1649"><a href="#cb344-1649" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-1650"><a href="#cb344-1650" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1651"><a href="#cb344-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1652"><a href="#cb344-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1653"><a href="#cb344-1653" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"issue change all 115–118_news.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1654"><a href="#cb344-1654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1655"><a href="#cb344-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1656"><a href="#cb344-1656" aria-hidden="true" tabindex="-1"></a>issue attention by gender and party</span>
<span id="cb344-1657"><a href="#cb344-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1660"><a href="#cb344-1660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1661"><a href="#cb344-1661" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gender party issue attention</span></span>
<span id="cb344-1662"><a href="#cb344-1662" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1663"><a href="#cb344-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1664"><a href="#cb344-1664" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 每个议员在每届对某议题的关注次数</span></span>
<span id="cb344-1665"><a href="#cb344-1665" aria-hidden="true" tabindex="-1"></a>issue_counts_mid <span class="ot">&lt;-</span> news_data_clean <span class="sc">%&gt;%</span></span>
<span id="cb344-1666"><a href="#cb344-1666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, gender, party, mid, issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1667"><a href="#cb344-1667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_issue_mentions =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1668"><a href="#cb344-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1669"><a href="#cb344-1669" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 聚合到 gender × party 层面</span></span>
<span id="cb344-1670"><a href="#cb344-1670" aria-hidden="true" tabindex="-1"></a>issue_counts_gender_party <span class="ot">&lt;-</span> issue_counts_mid <span class="sc">%&gt;%</span></span>
<span id="cb344-1671"><a href="#cb344-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, gender, party, issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1672"><a href="#cb344-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_mentions =</span> <span class="fu">sum</span>(n_issue_mentions), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1673"><a href="#cb344-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1674"><a href="#cb344-1674" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 取每届每个 gender × party 的 Top 5 议题</span></span>
<span id="cb344-1675"><a href="#cb344-1675" aria-hidden="true" tabindex="-1"></a>top_issues_gender_party <span class="ot">&lt;-</span> issue_counts_gender_party <span class="sc">%&gt;%</span></span>
<span id="cb344-1676"><a href="#cb344-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, gender, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1677"><a href="#cb344-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> total_mentions, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb344-1678"><a href="#cb344-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(congress, gender, party, <span class="fu">desc</span>(total_mentions))</span>
<span id="cb344-1679"><a href="#cb344-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1680"><a href="#cb344-1680" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb344-1681"><a href="#cb344-1681" aria-hidden="true" tabindex="-1"></a>top_issues_gender_party</span>
<span id="cb344-1682"><a href="#cb344-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1683"><a href="#cb344-1683" aria-hidden="true" tabindex="-1"></a><span class="co"># 导出为 CSV</span></span>
<span id="cb344-1684"><a href="#cb344-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_issues_gender_party, <span class="st">"top_issues_gender_party_news.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-1685"><a href="#cb344-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1686"><a href="#cb344-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1687"><a href="#cb344-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1688"><a href="#cb344-1688" aria-hidden="true" tabindex="-1"></a>calculating shanon-entropy for issue news</span>
<span id="cb344-1689"><a href="#cb344-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1692"><a href="#cb344-1692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1693"><a href="#cb344-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues shanon entropy news</span></span>
<span id="cb344-1694"><a href="#cb344-1694" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1695"><a href="#cb344-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1696"><a href="#cb344-1696" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个议员在每个 congress × issue 的出现次数</span></span>
<span id="cb344-1697"><a href="#cb344-1697" aria-hidden="true" tabindex="-1"></a>issue_dist <span class="ot">&lt;-</span> news_data_clean <span class="sc">%&gt;%</span></span>
<span id="cb344-1698"><a href="#cb344-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mid), <span class="sc">!</span><span class="fu">is.na</span>(issue), <span class="sc">!</span><span class="fu">is.na</span>(congress)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1699"><a href="#cb344-1699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mid, congress, issue, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1700"><a href="#cb344-1700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1701"><a href="#cb344-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1702"><a href="#cb344-1702" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个议员在每个 congress 的总新闻数</span></span>
<span id="cb344-1703"><a href="#cb344-1703" aria-hidden="true" tabindex="-1"></a>issue_total <span class="ot">&lt;-</span> issue_dist <span class="sc">%&gt;%</span></span>
<span id="cb344-1704"><a href="#cb344-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mid, congress, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1705"><a href="#cb344-1705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1706"><a href="#cb344-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1707"><a href="#cb344-1707" aria-hidden="true" tabindex="-1"></a><span class="co"># 合并并计算 p_k</span></span>
<span id="cb344-1708"><a href="#cb344-1708" aria-hidden="true" tabindex="-1"></a>issue_prob <span class="ot">&lt;-</span> issue_dist <span class="sc">%&gt;%</span></span>
<span id="cb344-1709"><a href="#cb344-1709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(issue_total,</span>
<span id="cb344-1710"><a href="#cb344-1710" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"mid"</span>, <span class="st">"congress"</span>, <span class="st">"gender"</span>, <span class="st">"chamber"</span>, <span class="st">"party"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1711"><a href="#cb344-1711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> total)</span>
<span id="cb344-1712"><a href="#cb344-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1713"><a href="#cb344-1713" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Shannon entropy</span></span>
<span id="cb344-1714"><a href="#cb344-1714" aria-hidden="true" tabindex="-1"></a>entropy_news <span class="ot">&lt;-</span> issue_prob <span class="sc">%&gt;%</span></span>
<span id="cb344-1715"><a href="#cb344-1715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mid, congress, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1716"><a href="#cb344-1716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb344-1717"><a href="#cb344-1717" aria-hidden="true" tabindex="-1"></a>    <span class="at">shannon_entropy =</span> <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p)),   <span class="co"># 默认自然对数</span></span>
<span id="cb344-1718"><a href="#cb344-1718" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_issues =</span> <span class="fu">n_distinct</span>(issue),</span>
<span id="cb344-1719"><a href="#cb344-1719" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_news =</span> <span class="fu">sum</span>(n),</span>
<span id="cb344-1720"><a href="#cb344-1720" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-1721"><a href="#cb344-1721" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1722"><a href="#cb344-1722" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(entropy_news)</span>
<span id="cb344-1723"><a href="#cb344-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1724"><a href="#cb344-1724" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb344-1725"><a href="#cb344-1725" aria-hidden="true" tabindex="-1"></a>entropy_summary <span class="ot">&lt;-</span> entropy_news <span class="sc">%&gt;%</span></span>
<span id="cb344-1726"><a href="#cb344-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-1727"><a href="#cb344-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_entropy =</span> <span class="fu">mean</span>(shannon_entropy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-1728"><a href="#cb344-1728" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_entropy =</span> <span class="fu">median</span>(shannon_entropy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb344-1729"><a href="#cb344-1729" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(entropy_summary, <span class="fu">aes</span>(<span class="at">x =</span> congress, <span class="at">y =</span> mean_entropy)) <span class="sc">+</span></span>
<span id="cb344-1730"><a href="#cb344-1730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb344-1731"><a href="#cb344-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb344-1732"><a href="#cb344-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1733"><a href="#cb344-1733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Congress"</span>, <span class="at">y =</span> <span class="st">"Mean Shannon Entropy"</span>,</span>
<span id="cb344-1734"><a href="#cb344-1734" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"News Average Attention Diversity by Congress"</span>)</span>
<span id="cb344-1735"><a href="#cb344-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1736"><a href="#cb344-1736" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Average Attention Diversity by Congress-news.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1737"><a href="#cb344-1737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1738"><a href="#cb344-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1739"><a href="#cb344-1739" aria-hidden="true" tabindex="-1"></a><span class="fu">### bills data</span></span>
<span id="cb344-1740"><a href="#cb344-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1741"><a href="#cb344-1741" aria-hidden="true" tabindex="-1"></a>bills data cleansing</span>
<span id="cb344-1742"><a href="#cb344-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1745"><a href="#cb344-1745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1746"><a href="#cb344-1746" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: bills data cleansing</span></span>
<span id="cb344-1747"><a href="#cb344-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1748"><a href="#cb344-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1749"><a href="#cb344-1749" aria-hidden="true" tabindex="-1"></a>bills_data_aug <span class="ot">&lt;-</span> bills_data <span class="sc">%&gt;%</span></span>
<span id="cb344-1750"><a href="#cb344-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="fu">as.integer</span>(congress)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1751"><a href="#cb344-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb344-1752"><a href="#cb344-1752" aria-hidden="true" tabindex="-1"></a>    legis_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-1753"><a href="#cb344-1753" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">congress =</span> <span class="fu">as.integer</span>(congress)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-1754"><a href="#cb344-1754" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(bioguide_id, congress, chamber, gender, party, committee_el),</span>
<span id="cb344-1755"><a href="#cb344-1755" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"bioguide_id"</span> <span class="ot">=</span> <span class="st">"bioguide_id"</span>, <span class="st">"congress"</span> <span class="ot">=</span> <span class="st">"congress"</span>)</span>
<span id="cb344-1756"><a href="#cb344-1756" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1757"><a href="#cb344-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1758"><a href="#cb344-1758" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bills_data_aug)</span>
<span id="cb344-1759"><a href="#cb344-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(bills_data_aug<span class="sc">$</span>party))</span>
<span id="cb344-1760"><a href="#cb344-1760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1761"><a href="#cb344-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1762"><a href="#cb344-1762" aria-hidden="true" tabindex="-1"></a>issues have major change on bills data from 115th to 118th congress</span>
<span id="cb344-1763"><a href="#cb344-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1766"><a href="#cb344-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1767"><a href="#cb344-1767" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues bills dramatic change</span></span>
<span id="cb344-1768"><a href="#cb344-1768" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1769"><a href="#cb344-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1770"><a href="#cb344-1770" aria-hidden="true" tabindex="-1"></a>issue_trend <span class="ot">&lt;-</span> bills_data_aug <span class="sc">%&gt;%</span></span>
<span id="cb344-1771"><a href="#cb344-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress, issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1772"><a href="#cb344-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">news_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1773"><a href="#cb344-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1774"><a href="#cb344-1774" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- 找出变化最剧烈的议题 -----</span></span>
<span id="cb344-1775"><a href="#cb344-1775" aria-hidden="true" tabindex="-1"></a>issue_trend_change <span class="ot">&lt;-</span> issue_trend <span class="sc">%&gt;%</span></span>
<span id="cb344-1776"><a href="#cb344-1776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1777"><a href="#cb344-1777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb344-1778"><a href="#cb344-1778" aria-hidden="true" tabindex="-1"></a>    <span class="at">change =</span> (news_count[congress <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">as.numeric</span>(congress))] <span class="sc">-</span> news_count[congress <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(congress))]) <span class="sc">/</span></span>
<span id="cb344-1779"><a href="#cb344-1779" aria-hidden="true" tabindex="-1"></a>             news_count[congress <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(congress))],</span>
<span id="cb344-1780"><a href="#cb344-1780" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-1781"><a href="#cb344-1781" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-1782"><a href="#cb344-1782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(change)))  <span class="co"># 按绝对变化排序</span></span>
<span id="cb344-1783"><a href="#cb344-1783" aria-hidden="true" tabindex="-1"></a>top_issues <span class="ot">&lt;-</span> issue_trend_change <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(issue)</span>
<span id="cb344-1784"><a href="#cb344-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1785"><a href="#cb344-1785" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- plot -----</span></span>
<span id="cb344-1786"><a href="#cb344-1786" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(issue_trend <span class="sc">%&gt;%</span> <span class="fu">filter</span>(issue <span class="sc">%in%</span> top_issues),</span>
<span id="cb344-1787"><a href="#cb344-1787" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(congress), <span class="at">y =</span> news_count, <span class="at">color =</span> issue)) <span class="sc">+</span></span>
<span id="cb344-1788"><a href="#cb344-1788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb344-1789"><a href="#cb344-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb344-1790"><a href="#cb344-1790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-1791"><a href="#cb344-1791" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top Issues Trend Across Congress 115–118"</span>,</span>
<span id="cb344-1792"><a href="#cb344-1792" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-1793"><a href="#cb344-1793" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"bills number"</span>,</span>
<span id="cb344-1794"><a href="#cb344-1794" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"issue"</span></span>
<span id="cb344-1795"><a href="#cb344-1795" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1796"><a href="#cb344-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1797"><a href="#cb344-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb344-1798"><a href="#cb344-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb344-1799"><a href="#cb344-1799" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb344-1800"><a href="#cb344-1800" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-1801"><a href="#cb344-1801" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1802"><a href="#cb344-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1803"><a href="#cb344-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"issue change most 115–118_bills.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1804"><a href="#cb344-1804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1805"><a href="#cb344-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1806"><a href="#cb344-1806" aria-hidden="true" tabindex="-1"></a>bills trends plot for all issues</span>
<span id="cb344-1807"><a href="#cb344-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1810"><a href="#cb344-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1811"><a href="#cb344-1811" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues bills all trend</span></span>
<span id="cb344-1812"><a href="#cb344-1812" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1813"><a href="#cb344-1813" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb344-1814"><a href="#cb344-1814" aria-hidden="true" tabindex="-1"></a>n_colors <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(issue_trend<span class="sc">$</span>issue)) <span class="co"># 获取议题数量</span></span>
<span id="cb344-1815"><a href="#cb344-1815" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">distinctColorPalette</span>(n_colors)</span>
<span id="cb344-1816"><a href="#cb344-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1817"><a href="#cb344-1817" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(issue_trend, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(congress), <span class="at">y =</span> news_count, <span class="at">color =</span> issue)) <span class="sc">+</span></span>
<span id="cb344-1818"><a href="#cb344-1818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb344-1819"><a href="#cb344-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb344-1820"><a href="#cb344-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-1821"><a href="#cb344-1821" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"issue change per Congress"</span>,</span>
<span id="cb344-1822"><a href="#cb344-1822" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-1823"><a href="#cb344-1823" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"bills number"</span>,</span>
<span id="cb344-1824"><a href="#cb344-1824" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"issue"</span></span>
<span id="cb344-1825"><a href="#cb344-1825" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-1826"><a href="#cb344-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1827"><a href="#cb344-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb344-1828"><a href="#cb344-1828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb344-1829"><a href="#cb344-1829" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb344-1830"><a href="#cb344-1830" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-1831"><a href="#cb344-1831" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1832"><a href="#cb344-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1833"><a href="#cb344-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1834"><a href="#cb344-1834" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"issue change all 115–118_bills.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1835"><a href="#cb344-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1836"><a href="#cb344-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1837"><a href="#cb344-1837" aria-hidden="true" tabindex="-1"></a>calculating shanon-entropy for bills news</span>
<span id="cb344-1838"><a href="#cb344-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1841"><a href="#cb344-1841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1842"><a href="#cb344-1842" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issues shanon entropy bills</span></span>
<span id="cb344-1843"><a href="#cb344-1843" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1844"><a href="#cb344-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1845"><a href="#cb344-1845" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个议员在每个 congress × issue 的出现次数</span></span>
<span id="cb344-1846"><a href="#cb344-1846" aria-hidden="true" tabindex="-1"></a>issue_dist <span class="ot">&lt;-</span> bills_data_aug <span class="sc">%&gt;%</span></span>
<span id="cb344-1847"><a href="#cb344-1847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bioguide_id), <span class="sc">!</span><span class="fu">is.na</span>(issue), <span class="sc">!</span><span class="fu">is.na</span>(congress)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1848"><a href="#cb344-1848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bioguide_id, congress, issue, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1849"><a href="#cb344-1849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1850"><a href="#cb344-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1851"><a href="#cb344-1851" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个议员在每个 congress 的总新闻数</span></span>
<span id="cb344-1852"><a href="#cb344-1852" aria-hidden="true" tabindex="-1"></a>issue_total <span class="ot">&lt;-</span> issue_dist <span class="sc">%&gt;%</span></span>
<span id="cb344-1853"><a href="#cb344-1853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bioguide_id, congress, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1854"><a href="#cb344-1854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1855"><a href="#cb344-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1856"><a href="#cb344-1856" aria-hidden="true" tabindex="-1"></a><span class="co"># 合并并计算 p_k</span></span>
<span id="cb344-1857"><a href="#cb344-1857" aria-hidden="true" tabindex="-1"></a>issue_prob <span class="ot">&lt;-</span> issue_dist <span class="sc">%&gt;%</span></span>
<span id="cb344-1858"><a href="#cb344-1858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(issue_total,</span>
<span id="cb344-1859"><a href="#cb344-1859" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"bioguide_id"</span>, <span class="st">"congress"</span>, <span class="st">"gender"</span>, <span class="st">"chamber"</span>, <span class="st">"party"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1860"><a href="#cb344-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> total)</span>
<span id="cb344-1861"><a href="#cb344-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1862"><a href="#cb344-1862" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Shannon entropy</span></span>
<span id="cb344-1863"><a href="#cb344-1863" aria-hidden="true" tabindex="-1"></a>entropy_bills <span class="ot">&lt;-</span> issue_prob <span class="sc">%&gt;%</span></span>
<span id="cb344-1864"><a href="#cb344-1864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bioguide_id, congress, gender, chamber, party) <span class="sc">%&gt;%</span></span>
<span id="cb344-1865"><a href="#cb344-1865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb344-1866"><a href="#cb344-1866" aria-hidden="true" tabindex="-1"></a>    <span class="at">shannon_entropy =</span> <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p)),   <span class="co"># 默认自然对数</span></span>
<span id="cb344-1867"><a href="#cb344-1867" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_issues =</span> <span class="fu">n_distinct</span>(issue),</span>
<span id="cb344-1868"><a href="#cb344-1868" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_news =</span> <span class="fu">sum</span>(n),</span>
<span id="cb344-1869"><a href="#cb344-1869" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb344-1870"><a href="#cb344-1870" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-1871"><a href="#cb344-1871" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(entropy_bills)</span>
<span id="cb344-1872"><a href="#cb344-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1873"><a href="#cb344-1873" aria-hidden="true" tabindex="-1"></a><span class="co"># violin plot</span></span>
<span id="cb344-1874"><a href="#cb344-1874" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(entropy_bills, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(congress), <span class="at">y =</span> shannon_entropy)) <span class="sc">+</span></span>
<span id="cb344-1875"><a href="#cb344-1875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb344-1876"><a href="#cb344-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb344-1877"><a href="#cb344-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1878"><a href="#cb344-1878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Congress"</span>, <span class="at">y =</span> <span class="st">"Shannon Entropy"</span>,</span>
<span id="cb344-1879"><a href="#cb344-1879" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Attention Diversity per Congress"</span>)</span>
<span id="cb344-1880"><a href="#cb344-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1881"><a href="#cb344-1881" aria-hidden="true" tabindex="-1"></a><span class="co"># line graph</span></span>
<span id="cb344-1882"><a href="#cb344-1882" aria-hidden="true" tabindex="-1"></a>entropy_summary <span class="ot">&lt;-</span> entropy_bills <span class="sc">%&gt;%</span></span>
<span id="cb344-1883"><a href="#cb344-1883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-1884"><a href="#cb344-1884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_entropy =</span> <span class="fu">mean</span>(shannon_entropy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-1885"><a href="#cb344-1885" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_entropy =</span> <span class="fu">median</span>(shannon_entropy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb344-1886"><a href="#cb344-1886" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(entropy_summary, <span class="fu">aes</span>(<span class="at">x =</span> congress, <span class="at">y =</span> mean_entropy)) <span class="sc">+</span></span>
<span id="cb344-1887"><a href="#cb344-1887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb344-1888"><a href="#cb344-1888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb344-1889"><a href="#cb344-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-1890"><a href="#cb344-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Congress"</span>, <span class="at">y =</span> <span class="st">"Mean Shannon Entropy"</span>,</span>
<span id="cb344-1891"><a href="#cb344-1891" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Bills Average Attention Diversity by Congress"</span>)</span>
<span id="cb344-1892"><a href="#cb344-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1893"><a href="#cb344-1893" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Average Attention Diversity by Congress-bills.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1894"><a href="#cb344-1894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1895"><a href="#cb344-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1896"><a href="#cb344-1896" aria-hidden="true" tabindex="-1"></a><span class="fu">## issue analysis using adver_tp and legis_tp</span></span>
<span id="cb344-1897"><a href="#cb344-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1898"><a href="#cb344-1898" aria-hidden="true" tabindex="-1"></a><span class="fu">### issue heatmap by congress</span></span>
<span id="cb344-1899"><a href="#cb344-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1902"><a href="#cb344-1902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1903"><a href="#cb344-1903" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: issue heatmap by congress</span></span>
<span id="cb344-1904"><a href="#cb344-1904" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1905"><a href="#cb344-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1906"><a href="#cb344-1906" aria-hidden="true" tabindex="-1"></a>plot_decision_mode_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">title =</span> <span class="st">"Decision Mode by Issue and Congress"</span>, <span class="at">save_path =</span> <span class="cn">NULL</span>) {</span>
<span id="cb344-1907"><a href="#cb344-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1908"><a href="#cb344-1908" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 检查变量</span></span>
<span id="cb344-1909"><a href="#cb344-1909" aria-hidden="true" tabindex="-1"></a>  required_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"issue"</span>, <span class="st">"congress"</span>, <span class="st">"decision"</span>)</span>
<span id="cb344-1910"><a href="#cb344-1910" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(required_vars <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb344-1911"><a href="#cb344-1911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Input dataframe must contain columns: issue, congress, decision."</span>)</span>
<span id="cb344-1912"><a href="#cb344-1912" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-1913"><a href="#cb344-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1914"><a href="#cb344-1914" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 数据准备</span></span>
<span id="cb344-1915"><a href="#cb344-1915" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-1916"><a href="#cb344-1916" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb344-1917"><a href="#cb344-1917" aria-hidden="true" tabindex="-1"></a>      <span class="at">decision =</span> <span class="fu">factor</span>(decision, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"intl"</span>, <span class="st">"dom"</span>, <span class="st">"prof"</span>)),</span>
<span id="cb344-1918"><a href="#cb344-1918" aria-hidden="true" tabindex="-1"></a>      <span class="at">congress =</span> <span class="fu">as.factor</span>(congress)</span>
<span id="cb344-1919"><a href="#cb344-1919" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-1920"><a href="#cb344-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1921"><a href="#cb344-1921" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 绘图</span></span>
<span id="cb344-1922"><a href="#cb344-1922" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> congress, <span class="at">y =</span> <span class="fu">reorder</span>(issue, <span class="fu">desc</span>(issue)), <span class="at">fill =</span> decision)) <span class="sc">+</span></span>
<span id="cb344-1923"><a href="#cb344-1923" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb344-1924"><a href="#cb344-1924" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb344-1925"><a href="#cb344-1925" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"intl"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"dom"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>, <span class="st">"prof"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>),</span>
<span id="cb344-1926"><a href="#cb344-1926" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.value =</span> <span class="st">"grey90"</span></span>
<span id="cb344-1927"><a href="#cb344-1927" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb344-1928"><a href="#cb344-1928" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb344-1929"><a href="#cb344-1929" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> title,</span>
<span id="cb344-1930"><a href="#cb344-1930" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-1931"><a href="#cb344-1931" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Issue"</span>,</span>
<span id="cb344-1932"><a href="#cb344-1932" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Decision Mode"</span></span>
<span id="cb344-1933"><a href="#cb344-1933" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb344-1934"><a href="#cb344-1934" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb344-1935"><a href="#cb344-1935" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb344-1936"><a href="#cb344-1936" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb344-1937"><a href="#cb344-1937" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb344-1938"><a href="#cb344-1938" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb344-1939"><a href="#cb344-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1940"><a href="#cb344-1940" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 保存图片（如果提供了路径）</span></span>
<span id="cb344-1941"><a href="#cb344-1941" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(save_path)) {</span>
<span id="cb344-1942"><a href="#cb344-1942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">filename =</span> save_path, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-1943"><a href="#cb344-1943" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-1944"><a href="#cb344-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1945"><a href="#cb344-1945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb344-1946"><a href="#cb344-1946" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-1947"><a href="#cb344-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1948"><a href="#cb344-1948" aria-hidden="true" tabindex="-1"></a><span class="co"># use of function plot_decision_mode_heatmap()</span></span>
<span id="cb344-1949"><a href="#cb344-1949" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_mode_heatmap</span>(legis_tp, <span class="at">title =</span> <span class="st">"Legislative Decision Mode by Issue and Congress"</span>, <span class="at">save_path =</span> <span class="st">"legis_mode.png"</span>)</span>
<span id="cb344-1950"><a href="#cb344-1950" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decision_mode_heatmap</span>(adver_tp, <span class="at">title =</span> <span class="st">"Advertise Decision Mode by Issue and Congress"</span>, <span class="at">save_path =</span> <span class="st">"adver_mode.png"</span>)</span>
<span id="cb344-1951"><a href="#cb344-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1952"><a href="#cb344-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-1953"><a href="#cb344-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1954"><a href="#cb344-1954" aria-hidden="true" tabindex="-1"></a><span class="fu">### focal issue of each congress</span></span>
<span id="cb344-1955"><a href="#cb344-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1958"><a href="#cb344-1958" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-1959"><a href="#cb344-1959" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: congress focal issue</span></span>
<span id="cb344-1960"><a href="#cb344-1960" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-1961"><a href="#cb344-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1962"><a href="#cb344-1962" aria-hidden="true" tabindex="-1"></a>plot_issue_trend_by_congress <span class="ot">&lt;-</span> <span class="cf">function</span>(df, </span>
<span id="cb344-1963"><a href="#cb344-1963" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">save_path =</span> <span class="cn">NULL</span>, </span>
<span id="cb344-1964"><a href="#cb344-1964" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">file_name =</span> <span class="st">"issue_trend_heatmap.png"</span>,</span>
<span id="cb344-1965"><a href="#cb344-1965" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">width =</span> <span class="dv">10</span>, </span>
<span id="cb344-1966"><a href="#cb344-1966" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">height =</span> <span class="dv">8</span>, </span>
<span id="cb344-1967"><a href="#cb344-1967" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">dpi =</span> <span class="dv">300</span>,</span>
<span id="cb344-1968"><a href="#cb344-1968" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">scale_type =</span> <span class="fu">c</span>(<span class="st">"raw"</span>, <span class="st">"normalized"</span>, <span class="st">"log"</span>)) {</span>
<span id="cb344-1969"><a href="#cb344-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1970"><a href="#cb344-1970" aria-hidden="true" tabindex="-1"></a>  scale_type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(scale_type)</span>
<span id="cb344-1971"><a href="#cb344-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1972"><a href="#cb344-1972" aria-hidden="true" tabindex="-1"></a>  issue_congress_label <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb344-1973"><a href="#cb344-1973" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(issue), <span class="sc">!</span><span class="fu">is.na</span>(congress), <span class="sc">!</span><span class="fu">is.na</span>(label)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1974"><a href="#cb344-1974" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(congress, issue) <span class="sc">%&gt;%</span></span>
<span id="cb344-1975"><a href="#cb344-1975" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_label =</span> <span class="fu">sum</span>(label, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb344-1976"><a href="#cb344-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1977"><a href="#cb344-1977" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply scale transformation</span></span>
<span id="cb344-1978"><a href="#cb344-1978" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (scale_type <span class="sc">==</span> <span class="st">"normalized"</span>) {</span>
<span id="cb344-1979"><a href="#cb344-1979" aria-hidden="true" tabindex="-1"></a>    issue_congress_label <span class="ot">&lt;-</span> issue_congress_label <span class="sc">%&gt;%</span></span>
<span id="cb344-1980"><a href="#cb344-1980" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(congress) <span class="sc">%&gt;%</span></span>
<span id="cb344-1981"><a href="#cb344-1981" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">scaled_label =</span> total_label <span class="sc">/</span> <span class="fu">sum</span>(total_label, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb344-1982"><a href="#cb344-1982" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>()</span>
<span id="cb344-1983"><a href="#cb344-1983" aria-hidden="true" tabindex="-1"></a>    fill_col <span class="ot">&lt;-</span> <span class="st">"scaled_label"</span></span>
<span id="cb344-1984"><a href="#cb344-1984" aria-hidden="true" tabindex="-1"></a>    fill_title <span class="ot">&lt;-</span> <span class="st">"Normalized</span><span class="sc">\n</span><span class="st">Proportion"</span></span>
<span id="cb344-1985"><a href="#cb344-1985" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (scale_type <span class="sc">==</span> <span class="st">"log"</span>) {</span>
<span id="cb344-1986"><a href="#cb344-1986" aria-hidden="true" tabindex="-1"></a>    issue_congress_label <span class="ot">&lt;-</span> issue_congress_label <span class="sc">%&gt;%</span></span>
<span id="cb344-1987"><a href="#cb344-1987" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">scaled_label =</span> <span class="fu">log1p</span>(total_label))  <span class="co"># log(1 + x)</span></span>
<span id="cb344-1988"><a href="#cb344-1988" aria-hidden="true" tabindex="-1"></a>    fill_col <span class="ot">&lt;-</span> <span class="st">"scaled_label"</span></span>
<span id="cb344-1989"><a href="#cb344-1989" aria-hidden="true" tabindex="-1"></a>    fill_title <span class="ot">&lt;-</span> <span class="st">"Log(Label + 1)"</span></span>
<span id="cb344-1990"><a href="#cb344-1990" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb344-1991"><a href="#cb344-1991" aria-hidden="true" tabindex="-1"></a>    fill_col <span class="ot">&lt;-</span> <span class="st">"total_label"</span></span>
<span id="cb344-1992"><a href="#cb344-1992" aria-hidden="true" tabindex="-1"></a>    fill_title <span class="ot">&lt;-</span> <span class="st">"Label Count"</span></span>
<span id="cb344-1993"><a href="#cb344-1993" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-1994"><a href="#cb344-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-1995"><a href="#cb344-1995" aria-hidden="true" tabindex="-1"></a>  heatmap_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(issue_congress_label, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(congress), <span class="at">y =</span> <span class="fu">reorder</span>(issue, <span class="fu">desc</span>(issue)), <span class="at">fill =</span> .data[[fill_col]])) <span class="sc">+</span></span>
<span id="cb344-1996"><a href="#cb344-1996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb344-1997"><a href="#cb344-1997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#fee8c8"</span>, <span class="at">high =</span> <span class="st">"#e34a33"</span>) <span class="sc">+</span></span>
<span id="cb344-1998"><a href="#cb344-1998" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb344-1999"><a href="#cb344-1999" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Most Discussed Issues by Congress"</span>,</span>
<span id="cb344-2000"><a href="#cb344-2000" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Congress"</span>,</span>
<span id="cb344-2001"><a href="#cb344-2001" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Issue"</span>,</span>
<span id="cb344-2002"><a href="#cb344-2002" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> fill_title</span>
<span id="cb344-2003"><a href="#cb344-2003" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb344-2004"><a href="#cb344-2004" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-2005"><a href="#cb344-2005" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb344-2006"><a href="#cb344-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2007"><a href="#cb344-2007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(heatmap_plot)</span>
<span id="cb344-2008"><a href="#cb344-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2009"><a href="#cb344-2009" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(save_path)) {</span>
<span id="cb344-2010"><a href="#cb344-2010" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">filename =</span> save_path, <span class="at">plot =</span> heatmap_plot, <span class="at">width =</span> width, <span class="at">height =</span> height, <span class="at">dpi =</span> dpi)</span>
<span id="cb344-2011"><a href="#cb344-2011" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2012"><a href="#cb344-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2013"><a href="#cb344-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(heatmap_plot))</span>
<span id="cb344-2014"><a href="#cb344-2014" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-2015"><a href="#cb344-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2016"><a href="#cb344-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_issue_trend_by_congress</span>(adver_tp, <span class="at">save_path =</span> <span class="st">"adver_issue_trend.png"</span>, <span class="at">scale_type =</span> <span class="st">"normalized"</span>)</span>
<span id="cb344-2017"><a href="#cb344-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_issue_trend_by_congress</span>(legis_tp, <span class="at">save_path =</span><span class="st">"legis_issue_trend.png"</span>, <span class="at">scale_type =</span> <span class="st">"normalized"</span>)</span>
<span id="cb344-2018"><a href="#cb344-2018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2019"><a href="#cb344-2019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2020"><a href="#cb344-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2021"><a href="#cb344-2021" aria-hidden="true" tabindex="-1"></a><span class="fu"># lgbm features importance analysis</span></span>
<span id="cb344-2022"><a href="#cb344-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2023"><a href="#cb344-2023" aria-hidden="true" tabindex="-1"></a><span class="fu"># key characteristics analysis </span></span>
<span id="cb344-2024"><a href="#cb344-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2025"><a href="#cb344-2025" aria-hidden="true" tabindex="-1"></a>this part will use regression and logistic model to see the key relationship between legislators' personal characteristics and decision mode</span>
<span id="cb344-2026"><a href="#cb344-2026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2027"><a href="#cb344-2027" aria-hidden="true" tabindex="-1"></a><span class="fu">## dependent variables: is.dom </span></span>
<span id="cb344-2028"><a href="#cb344-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2029"><a href="#cb344-2029" aria-hidden="true" tabindex="-1"></a><span class="fu">### data cleansing</span></span>
<span id="cb344-2030"><a href="#cb344-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2033"><a href="#cb344-2033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2034"><a href="#cb344-2034" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom data preparing</span></span>
<span id="cb344-2035"><a href="#cb344-2035" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2036"><a href="#cb344-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2037"><a href="#cb344-2037" aria-hidden="true" tabindex="-1"></a><span class="co"># turn decision into is.dom</span></span>
<span id="cb344-2038"><a href="#cb344-2038" aria-hidden="true" tabindex="-1"></a>adver_cg <span class="ot">&lt;-</span> adver_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-2039"><a href="#cb344-2039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is.dom =</span> <span class="fu">ifelse</span>(decision <span class="sc">==</span> <span class="st">"dom"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb344-2040"><a href="#cb344-2040" aria-hidden="true" tabindex="-1"></a>legis_cg <span class="ot">&lt;-</span> legis_cg <span class="sc">%&gt;%</span></span>
<span id="cb344-2041"><a href="#cb344-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is.dom =</span> <span class="fu">ifelse</span>(decision <span class="sc">==</span> <span class="st">"dom"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb344-2042"><a href="#cb344-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2043"><a href="#cb344-2043" aria-hidden="true" tabindex="-1"></a><span class="co"># turn party into is.republican</span></span>
<span id="cb344-2044"><a href="#cb344-2044" aria-hidden="true" tabindex="-1"></a>adver_cg <span class="ot">&lt;-</span> adver_cg <span class="sc">%&gt;%</span> </span>
<span id="cb344-2045"><a href="#cb344-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is.republican =</span> <span class="fu">ifelse</span>(party <span class="sc">==</span> <span class="st">"Republican"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb344-2046"><a href="#cb344-2046" aria-hidden="true" tabindex="-1"></a>legis_cg <span class="ot">&lt;-</span> legis_cg <span class="sc">%&gt;%</span> </span>
<span id="cb344-2047"><a href="#cb344-2047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is.republican =</span> <span class="fu">ifelse</span>(party <span class="sc">==</span> <span class="st">"Republican"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb344-2048"><a href="#cb344-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2049"><a href="#cb344-2049" aria-hidden="true" tabindex="-1"></a><span class="co"># turn categorical vector into numeric </span></span>
<span id="cb344-2050"><a href="#cb344-2050" aria-hidden="true" tabindex="-1"></a>adver_cg<span class="sc">$</span>gender_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(adver_cg<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb344-2051"><a href="#cb344-2051" aria-hidden="true" tabindex="-1"></a>legis_cg<span class="sc">$</span>gender_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(legis_cg<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb344-2052"><a href="#cb344-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2053"><a href="#cb344-2053" aria-hidden="true" tabindex="-1"></a>legis_cg<span class="sc">$</span>chamber_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(legis_cg<span class="sc">$</span>chamber <span class="sc">==</span> <span class="st">"Senate"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb344-2054"><a href="#cb344-2054" aria-hidden="true" tabindex="-1"></a>adver_cg<span class="sc">$</span>chamber_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(adver_cg<span class="sc">$</span>chamber <span class="sc">==</span> <span class="st">"Senate"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb344-2055"><a href="#cb344-2055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2056"><a href="#cb344-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2057"><a href="#cb344-2057" aria-hidden="true" tabindex="-1"></a>check co-linearity</span>
<span id="cb344-2058"><a href="#cb344-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2061"><a href="#cb344-2061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2062"><a href="#cb344-2062" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom co-linerality check</span></span>
<span id="cb344-2063"><a href="#cb344-2063" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2064"><a href="#cb344-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2065"><a href="#cb344-2065" aria-hidden="true" tabindex="-1"></a><span class="co"># age vs seniority</span></span>
<span id="cb344-2066"><a href="#cb344-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(adver_cg<span class="sc">$</span>age, adver_cg<span class="sc">$</span>seniority, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb344-2067"><a href="#cb344-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(legis_cg<span class="sc">$</span>age, legis_cg<span class="sc">$</span>seniority, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb344-2068"><a href="#cb344-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2069"><a href="#cb344-2069" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology vs chamber</span></span>
<span id="cb344-2070"><a href="#cb344-2070" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> is.republican, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2071"><a href="#cb344-2071" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> is.republican, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2072"><a href="#cb344-2072" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(adver_cg<span class="sc">$</span>ideology, adver_cg<span class="sc">$</span>is.republican, <span class="at">method =</span> <span class="st">"pearson"</span>) </span>
<span id="cb344-2073"><a href="#cb344-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2074"><a href="#cb344-2074" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology vs chamber</span></span>
<span id="cb344-2075"><a href="#cb344-2075" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> chamber, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2076"><a href="#cb344-2076" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> chamber, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2077"><a href="#cb344-2077" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(adver_cg<span class="sc">$</span>ideology, adver_cg<span class="sc">$</span>chamber_numeric, <span class="at">method =</span> <span class="st">"pearson"</span>) </span>
<span id="cb344-2078"><a href="#cb344-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2079"><a href="#cb344-2079" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> gender, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2080"><a href="#cb344-2080" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ideology <span class="sc">~</span> gender, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2081"><a href="#cb344-2081" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(adver_cg<span class="sc">$</span>ideology, adver_cg<span class="sc">$</span>gender_numeric, <span class="at">method =</span> <span class="st">"pearson"</span>) </span>
<span id="cb344-2082"><a href="#cb344-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2083"><a href="#cb344-2083" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican vs chamber</span></span>
<span id="cb344-2084"><a href="#cb344-2084" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adver_cg<span class="sc">$</span>is.republican, adver_cg<span class="sc">$</span>chamber)</span>
<span id="cb344-2085"><a href="#cb344-2085" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(adver_cg<span class="sc">$</span>is.republican, adver_cg<span class="sc">$</span>chamber))</span>
<span id="cb344-2086"><a href="#cb344-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2087"><a href="#cb344-2087" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(legis_cg<span class="sc">$</span>is.republican, legis_cg<span class="sc">$</span>chamber)</span>
<span id="cb344-2088"><a href="#cb344-2088" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(legis_cg<span class="sc">$</span>is.republican, legis_cg<span class="sc">$</span>chamber))</span>
<span id="cb344-2089"><a href="#cb344-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2090"><a href="#cb344-2090" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican vs gender</span></span>
<span id="cb344-2091"><a href="#cb344-2091" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adver_cg<span class="sc">$</span>is.republican, adver_cg<span class="sc">$</span>gender)</span>
<span id="cb344-2092"><a href="#cb344-2092" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(adver_cg<span class="sc">$</span>is.republican, adver_cg<span class="sc">$</span>chamber))</span>
<span id="cb344-2093"><a href="#cb344-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2094"><a href="#cb344-2094" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(legis_cg<span class="sc">$</span>is.republican, legis_cg<span class="sc">$</span>chamber)</span>
<span id="cb344-2095"><a href="#cb344-2095" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(legis_cg<span class="sc">$</span>is.republican, legis_cg<span class="sc">$</span>chamber))</span>
<span id="cb344-2096"><a href="#cb344-2096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2097"><a href="#cb344-2097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2098"><a href="#cb344-2098" aria-hidden="true" tabindex="-1"></a><span class="fu">### multiple variables logit model </span></span>
<span id="cb344-2099"><a href="#cb344-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2100"><a href="#cb344-2100" aria-hidden="true" tabindex="-1"></a>lasso</span>
<span id="cb344-2101"><a href="#cb344-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2104"><a href="#cb344-2104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2105"><a href="#cb344-2105" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit mul1</span></span>
<span id="cb344-2106"><a href="#cb344-2106" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2107"><a href="#cb344-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2108"><a href="#cb344-2108" aria-hidden="true" tabindex="-1"></a>run_glmnet_selection <span class="ot">&lt;-</span> <span class="cf">function</span>(data, formula, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>) {</span>
<span id="cb344-2109"><a href="#cb344-2109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 处理缺失值</span></span>
<span id="cb344-2110"><a href="#cb344-2110" aria-hidden="true" tabindex="-1"></a>  complete_data <span class="ot">&lt;-</span> <span class="fu">model.frame</span>(formula, <span class="at">data =</span> data, <span class="at">na.action =</span> na.omit)</span>
<span id="cb344-2111"><a href="#cb344-2111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2112"><a href="#cb344-2112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 自变量矩阵</span></span>
<span id="cb344-2113"><a href="#cb344-2113" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(formula, <span class="at">data =</span> complete_data)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb344-2114"><a href="#cb344-2114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2115"><a href="#cb344-2115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 因变量</span></span>
<span id="cb344-2116"><a href="#cb344-2116" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> complete_data[[<span class="fu">as.character</span>(formula[[<span class="dv">2</span>]])]]</span>
<span id="cb344-2117"><a href="#cb344-2117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2118"><a href="#cb344-2118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 拟合 lasso/ridge/elnet</span></span>
<span id="cb344-2119"><a href="#cb344-2119" aria-hidden="true" tabindex="-1"></a>  cv_fit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X, y, <span class="at">family =</span> family, <span class="at">alpha =</span> alpha)</span>
<span id="cb344-2120"><a href="#cb344-2120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2121"><a href="#cb344-2121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 可视化交叉验证误差</span></span>
<span id="cb344-2122"><a href="#cb344-2122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cv_fit, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"CV for alpha ="</span>, alpha, <span class="st">", family ="</span>, family))</span>
<span id="cb344-2123"><a href="#cb344-2123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2124"><a href="#cb344-2124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 输出最佳 lambda 和系数</span></span>
<span id="cb344-2125"><a href="#cb344-2125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Best lambda:"</span>, cv_fit<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-2126"><a href="#cb344-2126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">coef</span>(cv_fit, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb344-2127"><a href="#cb344-2127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2128"><a href="#cb344-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cv_fit)</span>
<span id="cb344-2129"><a href="#cb344-2129" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-2130"><a href="#cb344-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2131"><a href="#cb344-2131" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-2132"><a href="#cb344-2132" aria-hidden="true" tabindex="-1"></a>cv_lasso_adver <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(adver_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb344-2133"><a href="#cb344-2133" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2134"><a href="#cb344-2134" aria-hidden="true" tabindex="-1"></a>cv_ridge_adver <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(adver_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb344-2135"><a href="#cb344-2135" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2136"><a href="#cb344-2136" aria-hidden="true" tabindex="-1"></a>cv_elnet_adver <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(adver_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb344-2137"><a href="#cb344-2137" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2138"><a href="#cb344-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2139"><a href="#cb344-2139" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-2140"><a href="#cb344-2140" aria-hidden="true" tabindex="-1"></a>cv_lasso_legis <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(legis_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb344-2141"><a href="#cb344-2141" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2142"><a href="#cb344-2142" aria-hidden="true" tabindex="-1"></a>cv_ridge_legis <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(legis_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb344-2143"><a href="#cb344-2143" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2144"><a href="#cb344-2144" aria-hidden="true" tabindex="-1"></a>cv_elnet_legis <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(legis_cg, is.dom <span class="sc">~</span> age <span class="sc">+</span> party <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb344-2145"><a href="#cb344-2145" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb344-2146"><a href="#cb344-2146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2147"><a href="#cb344-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2148"><a href="#cb344-2148" aria-hidden="true" tabindex="-1"></a>set reference</span>
<span id="cb344-2149"><a href="#cb344-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2152"><a href="#cb344-2152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2153"><a href="#cb344-2153" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit mul2</span></span>
<span id="cb344-2154"><a href="#cb344-2154" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2155"><a href="#cb344-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2156"><a href="#cb344-2156" aria-hidden="true" tabindex="-1"></a><span class="co"># set references</span></span>
<span id="cb344-2157"><a href="#cb344-2157" aria-hidden="true" tabindex="-1"></a>set_reference_levels <span class="ot">&lt;-</span> <span class="cf">function</span>(df,</span>
<span id="cb344-2158"><a href="#cb344-2158" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_party =</span> <span class="st">"democratic"</span>,</span>
<span id="cb344-2159"><a href="#cb344-2159" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_is.republican =</span> <span class="st">"0"</span>,</span>
<span id="cb344-2160"><a href="#cb344-2160" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_chamber =</span> <span class="st">"Senate"</span>) {</span>
<span id="cb344-2161"><a href="#cb344-2161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2162"><a href="#cb344-2162" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"party"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) {</span>
<span id="cb344-2163"><a href="#cb344-2163" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>party <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>party)  <span class="co"># 转换为factor</span></span>
<span id="cb344-2164"><a href="#cb344-2164" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>party <span class="ot">&lt;-</span> <span class="fu">relevel</span>(df<span class="sc">$</span>party, <span class="at">ref =</span> ref_party)  <span class="co"># 设置reference level</span></span>
<span id="cb344-2165"><a href="#cb344-2165" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2166"><a href="#cb344-2166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2167"><a href="#cb344-2167" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (<span class="st">"party"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) {</span>
<span id="cb344-2168"><a href="#cb344-2168" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>is.republican <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>is.republican)  <span class="co"># 转换为factor</span></span>
<span id="cb344-2169"><a href="#cb344-2169" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>is.republican <span class="ot">&lt;-</span> <span class="fu">relevel</span>(df<span class="sc">$</span>is.republican, <span class="at">ref =</span> ref_is.republican)  <span class="co"># 设置reference level</span></span>
<span id="cb344-2170"><a href="#cb344-2170" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2171"><a href="#cb344-2171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2172"><a href="#cb344-2172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"chamber"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df)) {</span>
<span id="cb344-2173"><a href="#cb344-2173" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>chamber <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>chamber)</span>
<span id="cb344-2174"><a href="#cb344-2174" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>chamber <span class="ot">&lt;-</span> <span class="fu">relevel</span>(df<span class="sc">$</span>chamber, <span class="at">ref =</span> ref_chamber)</span>
<span id="cb344-2175"><a href="#cb344-2175" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2176"><a href="#cb344-2176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2177"><a href="#cb344-2177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb344-2178"><a href="#cb344-2178" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-2179"><a href="#cb344-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2180"><a href="#cb344-2180" aria-hidden="true" tabindex="-1"></a>adver_cg <span class="ot">&lt;-</span> <span class="fu">set_reference_levels</span>(adver_cg,</span>
<span id="cb344-2181"><a href="#cb344-2181" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_party =</span> <span class="st">"Democratic"</span>,</span>
<span id="cb344-2182"><a href="#cb344-2182" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_is.republican =</span> <span class="st">"0"</span>,</span>
<span id="cb344-2183"><a href="#cb344-2183" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_chamber =</span> <span class="st">"senate"</span>)</span>
<span id="cb344-2184"><a href="#cb344-2184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2185"><a href="#cb344-2185" aria-hidden="true" tabindex="-1"></a>legis_cg <span class="ot">&lt;-</span> <span class="fu">set_reference_levels</span>(legis_cg,</span>
<span id="cb344-2186"><a href="#cb344-2186" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_party =</span> <span class="st">"Democratic"</span>,</span>
<span id="cb344-2187"><a href="#cb344-2187" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_is.republican =</span> <span class="st">"0"</span>,</span>
<span id="cb344-2188"><a href="#cb344-2188" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ref_chamber =</span> <span class="st">"senate"</span>)</span>
<span id="cb344-2189"><a href="#cb344-2189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2190"><a href="#cb344-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2191"><a href="#cb344-2191" aria-hidden="true" tabindex="-1"></a>set analysis function to save time</span>
<span id="cb344-2192"><a href="#cb344-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2195"><a href="#cb344-2195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2196"><a href="#cb344-2196" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit mul3</span></span>
<span id="cb344-2197"><a href="#cb344-2197" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2198"><a href="#cb344-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2199"><a href="#cb344-2199" aria-hidden="true" tabindex="-1"></a><span class="co"># analysis function</span></span>
<span id="cb344-2200"><a href="#cb344-2200" aria-hidden="true" tabindex="-1"></a>analyze_logit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb344-2201"><a href="#cb344-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(broom)</span>
<span id="cb344-2202"><a href="#cb344-2202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2203"><a href="#cb344-2203" aria-hidden="true" tabindex="-1"></a>  tidy_model <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb344-2204"><a href="#cb344-2204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>),</span>
<span id="cb344-2205"><a href="#cb344-2205" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb344-2206"><a href="#cb344-2206" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Error in tidy(): "</span>, e<span class="sc">$</span>message)</span>
<span id="cb344-2207"><a href="#cb344-2207" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb344-2208"><a href="#cb344-2208" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-2209"><a href="#cb344-2209" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-2210"><a href="#cb344-2210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2211"><a href="#cb344-2211" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(tidy_model)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb344-2212"><a href="#cb344-2212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2213"><a href="#cb344-2213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 检查是否包含 conf.low 和 conf.high，若无则用 NA 填充</span></span>
<span id="cb344-2214"><a href="#cb344-2214" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"conf.low"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tidy_model)) tidy_model<span class="sc">$</span>conf.low <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb344-2215"><a href="#cb344-2215" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"conf.high"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tidy_model)) tidy_model<span class="sc">$</span>conf.high <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb344-2216"><a href="#cb344-2216" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2217"><a href="#cb344-2217" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> tidy_model <span class="sc">%&gt;%</span></span>
<span id="cb344-2218"><a href="#cb344-2218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb344-2219"><a href="#cb344-2219" aria-hidden="true" tabindex="-1"></a>      <span class="at">odds_ratio =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb344-2220"><a href="#cb344-2220" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.low.or =</span> <span class="fu">exp</span>(conf.low),</span>
<span id="cb344-2221"><a href="#cb344-2221" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.high.or =</span> <span class="fu">exp</span>(conf.high),</span>
<span id="cb344-2222"><a href="#cb344-2222" aria-hidden="true" tabindex="-1"></a>      <span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb344-2223"><a href="#cb344-2223" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb344-2224"><a href="#cb344-2224" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.01</span>  <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb344-2225"><a href="#cb344-2225" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>  <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb344-2226"><a href="#cb344-2226" aria-hidden="true" tabindex="-1"></a>        p.value <span class="sc">&lt;</span> <span class="fl">0.1</span>   <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb344-2227"><a href="#cb344-2227" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb344-2228"><a href="#cb344-2228" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb344-2229"><a href="#cb344-2229" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb344-2230"><a href="#cb344-2230" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(term, estimate, odds_ratio, conf.low.or, conf.high.or,</span>
<span id="cb344-2231"><a href="#cb344-2231" aria-hidden="true" tabindex="-1"></a>           std.error, p.value, significance)</span>
<span id="cb344-2232"><a href="#cb344-2232" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2233"><a href="#cb344-2233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(model))</span>
<span id="cb344-2234"><a href="#cb344-2234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(coefs)</span>
<span id="cb344-2235"><a href="#cb344-2235" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2236"><a href="#cb344-2236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pseudo R-squared (McFadden)</span></span>
<span id="cb344-2237"><a href="#cb344-2237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"pscl"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb344-2238"><a href="#cb344-2238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(pscl)</span>
<span id="cb344-2239"><a href="#cb344-2239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pseudo R-squared:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-2240"><a href="#cb344-2240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(pscl<span class="sc">::</span><span class="fu">pR2</span>(model))</span>
<span id="cb344-2241"><a href="#cb344-2241" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb344-2242"><a href="#cb344-2242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Install 'pscl' package for pseudo R-squared calculation."</span>)</span>
<span id="cb344-2243"><a href="#cb344-2243" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2244"><a href="#cb344-2244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2245"><a href="#cb344-2245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coefs)</span>
<span id="cb344-2246"><a href="#cb344-2246" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-2247"><a href="#cb344-2247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2248"><a href="#cb344-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2249"><a href="#cb344-2249" aria-hidden="true" tabindex="-1"></a>models training - adver</span>
<span id="cb344-2250"><a href="#cb344-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2253"><a href="#cb344-2253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2254"><a href="#cb344-2254" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit mul4</span></span>
<span id="cb344-2255"><a href="#cb344-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2256"><a href="#cb344-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2257"><a href="#cb344-2257" aria-hidden="true" tabindex="-1"></a><span class="co"># model 0</span></span>
<span id="cb344-2258"><a href="#cb344-2258" aria-hidden="true" tabindex="-1"></a>adver_logit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> seniority <span class="sc">+</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2259"><a href="#cb344-2259" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2260"><a href="#cb344-2260" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2261"><a href="#cb344-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2262"><a href="#cb344-2262" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted model</span></span>
<span id="cb344-2263"><a href="#cb344-2263" aria-hidden="true" tabindex="-1"></a>adver_logit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span>  chamber <span class="sc">+</span> ideology <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2264"><a href="#cb344-2264" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2265"><a href="#cb344-2265" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2266"><a href="#cb344-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2267"><a href="#cb344-2267" aria-hidden="true" tabindex="-1"></a>adver_logit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span>  chamber <span class="sc">+</span> is.republican <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2268"><a href="#cb344-2268" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2269"><a href="#cb344-2269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2270"><a href="#cb344-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2271"><a href="#cb344-2271" aria-hidden="true" tabindex="-1"></a>adver_logit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span>  chamber <span class="sc">+</span> is.republican <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2272"><a href="#cb344-2272" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2273"><a href="#cb344-2273" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2274"><a href="#cb344-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2275"><a href="#cb344-2275" aria-hidden="true" tabindex="-1"></a>adver_logit4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span>  chamber <span class="sc">+</span> ideology <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2276"><a href="#cb344-2276" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2277"><a href="#cb344-2277" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2278"><a href="#cb344-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2279"><a href="#cb344-2279" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb344-2280"><a href="#cb344-2280" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2281"><a href="#cb344-2281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2282"><a href="#cb344-2282" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adver All"</span> <span class="ot">=</span> adver_logit0,</span>
<span id="cb344-2283"><a href="#cb344-2283" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> adver_logit1,</span>
<span id="cb344-2284"><a href="#cb344-2284" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> adver_logit2,</span>
<span id="cb344-2285"><a href="#cb344-2285" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> adver_logit3,</span>
<span id="cb344-2286"><a href="#cb344-2286" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> adver_logit4</span>
<span id="cb344-2287"><a href="#cb344-2287" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2288"><a href="#cb344-2288" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2289"><a href="#cb344-2289" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2290"><a href="#cb344-2290" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"logitmodel_adver_isdom.html"</span>,</span>
<span id="cb344-2291"><a href="#cb344-2291" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb344-2292"><a href="#cb344-2292" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"AIC|BIC"</span></span>
<span id="cb344-2293"><a href="#cb344-2293" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2294"><a href="#cb344-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2295"><a href="#cb344-2295" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- vif check ----</span></span>
<span id="cb344-2296"><a href="#cb344-2296" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_logit0)</span>
<span id="cb344-2297"><a href="#cb344-2297" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_logit1)</span>
<span id="cb344-2298"><a href="#cb344-2298" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_logit2)</span>
<span id="cb344-2299"><a href="#cb344-2299" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_logit3)</span>
<span id="cb344-2300"><a href="#cb344-2300" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_logit4)</span>
<span id="cb344-2301"><a href="#cb344-2301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2302"><a href="#cb344-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2303"><a href="#cb344-2303" aria-hidden="true" tabindex="-1"></a>models training - legis</span>
<span id="cb344-2304"><a href="#cb344-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2307"><a href="#cb344-2307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2308"><a href="#cb344-2308" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit mul5</span></span>
<span id="cb344-2309"><a href="#cb344-2309" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2310"><a href="#cb344-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2311"><a href="#cb344-2311" aria-hidden="true" tabindex="-1"></a><span class="co"># model 0</span></span>
<span id="cb344-2312"><a href="#cb344-2312" aria-hidden="true" tabindex="-1"></a>legis_logit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> seniority <span class="sc">+</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2313"><a href="#cb344-2313" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2314"><a href="#cb344-2314" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2315"><a href="#cb344-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2316"><a href="#cb344-2316" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted models</span></span>
<span id="cb344-2317"><a href="#cb344-2317" aria-hidden="true" tabindex="-1"></a>legis_logit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span>  chamber <span class="sc">+</span> ideology <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2318"><a href="#cb344-2318" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2319"><a href="#cb344-2319" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2320"><a href="#cb344-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2321"><a href="#cb344-2321" aria-hidden="true" tabindex="-1"></a>legis_logit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span>  chamber <span class="sc">+</span> is.republican <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2322"><a href="#cb344-2322" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2323"><a href="#cb344-2323" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2324"><a href="#cb344-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2325"><a href="#cb344-2325" aria-hidden="true" tabindex="-1"></a>legis_logit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span>  chamber <span class="sc">+</span> is.republican <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2326"><a href="#cb344-2326" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2327"><a href="#cb344-2327" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2328"><a href="#cb344-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2329"><a href="#cb344-2329" aria-hidden="true" tabindex="-1"></a>legis_logit4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span>  chamber <span class="sc">+</span> ideology <span class="sc">+</span>  gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2330"><a href="#cb344-2330" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2331"><a href="#cb344-2331" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2332"><a href="#cb344-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2333"><a href="#cb344-2333" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb344-2334"><a href="#cb344-2334" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2335"><a href="#cb344-2335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2336"><a href="#cb344-2336" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Legis All"</span> <span class="ot">=</span> legis_logit0,</span>
<span id="cb344-2337"><a href="#cb344-2337" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> legis_logit1,</span>
<span id="cb344-2338"><a href="#cb344-2338" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> legis_logit2,</span>
<span id="cb344-2339"><a href="#cb344-2339" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> legis_logit3,</span>
<span id="cb344-2340"><a href="#cb344-2340" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> legis_logit4</span>
<span id="cb344-2341"><a href="#cb344-2341" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2342"><a href="#cb344-2342" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2343"><a href="#cb344-2343" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2344"><a href="#cb344-2344" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"logitmodel_legis_isdom.html"</span>,</span>
<span id="cb344-2345"><a href="#cb344-2345" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb344-2346"><a href="#cb344-2346" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"AIC|BIC"</span></span>
<span id="cb344-2347"><a href="#cb344-2347" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2348"><a href="#cb344-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2349"><a href="#cb344-2349" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- vif check ----</span></span>
<span id="cb344-2350"><a href="#cb344-2350" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_logit0)</span>
<span id="cb344-2351"><a href="#cb344-2351" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_logit1)</span>
<span id="cb344-2352"><a href="#cb344-2352" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_logit2)</span>
<span id="cb344-2353"><a href="#cb344-2353" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_logit3)</span>
<span id="cb344-2354"><a href="#cb344-2354" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_logit4)</span>
<span id="cb344-2355"><a href="#cb344-2355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2356"><a href="#cb344-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2357"><a href="#cb344-2357" aria-hidden="true" tabindex="-1"></a><span class="fu">#### residual check for logit model</span></span>
<span id="cb344-2358"><a href="#cb344-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2361"><a href="#cb344-2361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2362"><a href="#cb344-2362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: logit model residual check</span></span>
<span id="cb344-2363"><a href="#cb344-2363" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2364"><a href="#cb344-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2365"><a href="#cb344-2365" aria-hidden="true" tabindex="-1"></a>plot_logit_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(model_list, data, <span class="at">output_dir =</span> <span class="st">"logit_residual_plots"</span>, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb344-2366"><a href="#cb344-2366" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2367"><a href="#cb344-2367" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 如果输出文件夹不存在，就新建</span></span>
<span id="cb344-2368"><a href="#cb344-2368" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)) {</span>
<span id="cb344-2369"><a href="#cb344-2369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(output_dir)</span>
<span id="cb344-2370"><a href="#cb344-2370" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2371"><a href="#cb344-2371" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2372"><a href="#cb344-2372" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(model_list)) {</span>
<span id="cb344-2373"><a href="#cb344-2373" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> model_list[[model_name]]</span>
<span id="cb344-2374"><a href="#cb344-2374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2375"><a href="#cb344-2375" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 生成残差</span></span>
<span id="cb344-2376"><a href="#cb344-2376" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> model, <span class="at">n =</span> n)</span>
<span id="cb344-2377"><a href="#cb344-2377" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2378"><a href="#cb344-2378" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 自动获取自变量（去掉因变量）</span></span>
<span id="cb344-2379"><a href="#cb344-2379" aria-hidden="true" tabindex="-1"></a>    predictors <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(<span class="fu">formula</span>(model))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb344-2380"><a href="#cb344-2380" aria-hidden="true" tabindex="-1"></a>    predictors <span class="ot">&lt;-</span> predictors[predictors <span class="sc">%in%</span> <span class="fu">colnames</span>(data)]  <span class="co"># 只保留存在的列</span></span>
<span id="cb344-2381"><a href="#cb344-2381" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2382"><a href="#cb344-2382" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 设置输出文件（一个大图）</span></span>
<span id="cb344-2383"><a href="#cb344-2383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">png</span>(<span class="fu">file.path</span>(output_dir, <span class="fu">paste0</span>(<span class="st">"residuals_"</span>, model_name, <span class="st">"_all.png"</span>)),</span>
<span id="cb344-2384"><a href="#cb344-2384" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">2400</span>, <span class="at">height =</span> <span class="dv">1600</span>, <span class="at">res =</span> <span class="dv">200</span>)</span>
<span id="cb344-2385"><a href="#cb344-2385" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2386"><a href="#cb344-2386" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 设置大图布局：根据变量个数自动排版（2列）</span></span>
<span id="cb344-2387"><a href="#cb344-2387" aria-hidden="true" tabindex="-1"></a>    n_pred <span class="ot">&lt;-</span> <span class="fu">length</span>(predictors)</span>
<span id="cb344-2388"><a href="#cb344-2388" aria-hidden="true" tabindex="-1"></a>    n_row <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n_pred <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb344-2389"><a href="#cb344-2389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(n_row, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))  <span class="co"># 调整边距，避免标题重叠</span></span>
<span id="cb344-2390"><a href="#cb344-2390" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2391"><a href="#cb344-2391" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 遍历 predictor 画子图</span></span>
<span id="cb344-2392"><a href="#cb344-2392" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (var <span class="cf">in</span> predictors) {</span>
<span id="cb344-2393"><a href="#cb344-2393" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotResiduals</span>(res, <span class="at">predictor =</span> data[[var]],</span>
<span id="cb344-2394"><a href="#cb344-2394" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Residuals vs"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, model_name, <span class="st">")"</span>))</span>
<span id="cb344-2395"><a href="#cb344-2395" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-2396"><a href="#cb344-2396" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-2397"><a href="#cb344-2397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dev.off</span>()</span>
<span id="cb344-2398"><a href="#cb344-2398" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-2399"><a href="#cb344-2399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-2400"><a href="#cb344-2400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✅ 每个模型的所有 predictor 残差图已合并保存至："</span>, output_dir, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-2401"><a href="#cb344-2401" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-2402"><a href="#cb344-2402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2403"><a href="#cb344-2403" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb344-2404"><a href="#cb344-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2405"><a href="#cb344-2405" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型列表</span></span>
<span id="cb344-2406"><a href="#cb344-2406" aria-hidden="true" tabindex="-1"></a>model_list_adver_dom_logit <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2407"><a href="#cb344-2407" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom_logit1"</span> <span class="ot">=</span> adver_logit1,</span>
<span id="cb344-2408"><a href="#cb344-2408" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom_logit2"</span> <span class="ot">=</span> adver_logit2,</span>
<span id="cb344-2409"><a href="#cb344-2409" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom_logit3"</span> <span class="ot">=</span> adver_logit3,</span>
<span id="cb344-2410"><a href="#cb344-2410" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom_logit4"</span> <span class="ot">=</span> adver_logit4</span>
<span id="cb344-2411"><a href="#cb344-2411" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2412"><a href="#cb344-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2413"><a href="#cb344-2413" aria-hidden="true" tabindex="-1"></a>model_list_legis_dom_logit <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2414"><a href="#cb344-2414" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom_logit1"</span> <span class="ot">=</span> legis_logit1,</span>
<span id="cb344-2415"><a href="#cb344-2415" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom_logit2"</span> <span class="ot">=</span> legis_logit2,</span>
<span id="cb344-2416"><a href="#cb344-2416" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom_logit3"</span> <span class="ot">=</span> legis_logit3,</span>
<span id="cb344-2417"><a href="#cb344-2417" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom_logit4"</span> <span class="ot">=</span> legis_logit4</span>
<span id="cb344-2418"><a href="#cb344-2418" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2419"><a href="#cb344-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2420"><a href="#cb344-2420" aria-hidden="true" tabindex="-1"></a><span class="co"># 调用函数</span></span>
<span id="cb344-2421"><a href="#cb344-2421" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_logit_residuals</span>(model_list_adver_dom_logit, adver_cg)</span>
<span id="cb344-2422"><a href="#cb344-2422" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_logit_residuals</span>(model_list_legis_dom_logit, legis_cg)</span>
<span id="cb344-2423"><a href="#cb344-2423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2424"><a href="#cb344-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2425"><a href="#cb344-2425" aria-hidden="true" tabindex="-1"></a><span class="fu">### single variable logit model </span></span>
<span id="cb344-2426"><a href="#cb344-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2427"><a href="#cb344-2427" aria-hidden="true" tabindex="-1"></a>models training - adver</span>
<span id="cb344-2428"><a href="#cb344-2428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2431"><a href="#cb344-2431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2432"><a href="#cb344-2432" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit sin1</span></span>
<span id="cb344-2433"><a href="#cb344-2433" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2434"><a href="#cb344-2434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2435"><a href="#cb344-2435" aria-hidden="true" tabindex="-1"></a><span class="co">#adver</span></span>
<span id="cb344-2436"><a href="#cb344-2436" aria-hidden="true" tabindex="-1"></a>adver_logit_age <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2437"><a href="#cb344-2437" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2438"><a href="#cb344-2438" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2439"><a href="#cb344-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2440"><a href="#cb344-2440" aria-hidden="true" tabindex="-1"></a>adver_logit_ideology <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> ideology <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2441"><a href="#cb344-2441" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2442"><a href="#cb344-2442" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2443"><a href="#cb344-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2444"><a href="#cb344-2444" aria-hidden="true" tabindex="-1"></a>adver_logit_is.republican <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> is.republican <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2445"><a href="#cb344-2445" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2446"><a href="#cb344-2446" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2447"><a href="#cb344-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2448"><a href="#cb344-2448" aria-hidden="true" tabindex="-1"></a>adver_logit_gender <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2449"><a href="#cb344-2449" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2450"><a href="#cb344-2450" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2451"><a href="#cb344-2451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2452"><a href="#cb344-2452" aria-hidden="true" tabindex="-1"></a>adver_logit_chamber <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2453"><a href="#cb344-2453" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2454"><a href="#cb344-2454" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2455"><a href="#cb344-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2456"><a href="#cb344-2456" aria-hidden="true" tabindex="-1"></a>adver_logit_seniority <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2457"><a href="#cb344-2457" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-2458"><a href="#cb344-2458" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2459"><a href="#cb344-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2460"><a href="#cb344-2460" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2461"><a href="#cb344-2461" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2462"><a href="#cb344-2462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2463"><a href="#cb344-2463" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> adver_logit_age,</span>
<span id="cb344-2464"><a href="#cb344-2464" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> adver_logit_ideology,</span>
<span id="cb344-2465"><a href="#cb344-2465" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> adver_logit_is.republican,</span>
<span id="cb344-2466"><a href="#cb344-2466" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> adver_logit_gender,</span>
<span id="cb344-2467"><a href="#cb344-2467" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="ot">=</span> adver_logit_chamber,</span>
<span id="cb344-2468"><a href="#cb344-2468" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6"</span> <span class="ot">=</span> adver_logit_seniority</span>
<span id="cb344-2469"><a href="#cb344-2469" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2470"><a href="#cb344-2470" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2471"><a href="#cb344-2471" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2472"><a href="#cb344-2472" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"logitmodel_adver_seperated_isdom.html"</span>,</span>
<span id="cb344-2473"><a href="#cb344-2473" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb344-2474"><a href="#cb344-2474" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"AIC|BIC"</span></span>
<span id="cb344-2475"><a href="#cb344-2475" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2476"><a href="#cb344-2476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2477"><a href="#cb344-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2478"><a href="#cb344-2478" aria-hidden="true" tabindex="-1"></a>models training - legis</span>
<span id="cb344-2479"><a href="#cb344-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2482"><a href="#cb344-2482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2483"><a href="#cb344-2483" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom logit sin2</span></span>
<span id="cb344-2484"><a href="#cb344-2484" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2485"><a href="#cb344-2485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2486"><a href="#cb344-2486" aria-hidden="true" tabindex="-1"></a>legis_logit_age <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2487"><a href="#cb344-2487" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2488"><a href="#cb344-2488" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2489"><a href="#cb344-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2490"><a href="#cb344-2490" aria-hidden="true" tabindex="-1"></a>legis_logit_ideology <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> ideology <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2491"><a href="#cb344-2491" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2492"><a href="#cb344-2492" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2493"><a href="#cb344-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2494"><a href="#cb344-2494" aria-hidden="true" tabindex="-1"></a>legis_logit_is.republican <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> is.republican <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2495"><a href="#cb344-2495" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2496"><a href="#cb344-2496" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2497"><a href="#cb344-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2498"><a href="#cb344-2498" aria-hidden="true" tabindex="-1"></a>legis_logit_gender <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2499"><a href="#cb344-2499" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2500"><a href="#cb344-2500" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2501"><a href="#cb344-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2502"><a href="#cb344-2502" aria-hidden="true" tabindex="-1"></a>legis_logit_chamber <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2503"><a href="#cb344-2503" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2504"><a href="#cb344-2504" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2505"><a href="#cb344-2505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2506"><a href="#cb344-2506" aria-hidden="true" tabindex="-1"></a>legis_logit_seniority <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2507"><a href="#cb344-2507" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-2508"><a href="#cb344-2508" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-2509"><a href="#cb344-2509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2510"><a href="#cb344-2510" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2511"><a href="#cb344-2511" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2512"><a href="#cb344-2512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2513"><a href="#cb344-2513" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> legis_logit_age,</span>
<span id="cb344-2514"><a href="#cb344-2514" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> legis_logit_ideology,</span>
<span id="cb344-2515"><a href="#cb344-2515" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> legis_logit_is.republican,</span>
<span id="cb344-2516"><a href="#cb344-2516" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> legis_logit_gender,</span>
<span id="cb344-2517"><a href="#cb344-2517" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="ot">=</span> legis_logit_chamber,</span>
<span id="cb344-2518"><a href="#cb344-2518" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6"</span> <span class="ot">=</span> legis_logit_seniority</span>
<span id="cb344-2519"><a href="#cb344-2519" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2520"><a href="#cb344-2520" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2521"><a href="#cb344-2521" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2522"><a href="#cb344-2522" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"logitmodel_legis_seperated_isdom.html"</span>,</span>
<span id="cb344-2523"><a href="#cb344-2523" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb344-2524"><a href="#cb344-2524" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"AIC|BIC"</span></span>
<span id="cb344-2525"><a href="#cb344-2525" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2526"><a href="#cb344-2526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2527"><a href="#cb344-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2528"><a href="#cb344-2528" aria-hidden="true" tabindex="-1"></a>coefficient plot</span>
<span id="cb344-2529"><a href="#cb344-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2532"><a href="#cb344-2532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2533"><a href="#cb344-2533" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom coefficient plot</span></span>
<span id="cb344-2534"><a href="#cb344-2534" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2535"><a href="#cb344-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2536"><a href="#cb344-2536" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- model lists -----</span></span>
<span id="cb344-2537"><a href="#cb344-2537" aria-hidden="true" tabindex="-1"></a>adver_lm_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2538"><a href="#cb344-2538" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> adver_logit_age,</span>
<span id="cb344-2539"><a href="#cb344-2539" aria-hidden="true" tabindex="-1"></a>  <span class="at">ideology =</span> adver_logit_ideology,</span>
<span id="cb344-2540"><a href="#cb344-2540" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_republican =</span> adver_logit_is.republican,</span>
<span id="cb344-2541"><a href="#cb344-2541" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> adver_logit_gender,</span>
<span id="cb344-2542"><a href="#cb344-2542" aria-hidden="true" tabindex="-1"></a>  <span class="at">chamber =</span> adver_logit_chamber,</span>
<span id="cb344-2543"><a href="#cb344-2543" aria-hidden="true" tabindex="-1"></a>  <span class="at">seniority =</span> adver_logit_seniority</span>
<span id="cb344-2544"><a href="#cb344-2544" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2545"><a href="#cb344-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2546"><a href="#cb344-2546" aria-hidden="true" tabindex="-1"></a>legis_lm_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2547"><a href="#cb344-2547" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> legis_logit_age,</span>
<span id="cb344-2548"><a href="#cb344-2548" aria-hidden="true" tabindex="-1"></a>  <span class="at">ideology =</span> legis_logit_ideology,</span>
<span id="cb344-2549"><a href="#cb344-2549" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_republican =</span> legis_logit_is.republican,</span>
<span id="cb344-2550"><a href="#cb344-2550" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> legis_logit_gender,</span>
<span id="cb344-2551"><a href="#cb344-2551" aria-hidden="true" tabindex="-1"></a>  <span class="at">chamber =</span> legis_logit_chamber,</span>
<span id="cb344-2552"><a href="#cb344-2552" aria-hidden="true" tabindex="-1"></a>  <span class="at">seniority =</span> legis_logit_seniority</span>
<span id="cb344-2553"><a href="#cb344-2553" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2554"><a href="#cb344-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2555"><a href="#cb344-2555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2556"><a href="#cb344-2556" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- extract coefficient and clean -----</span></span>
<span id="cb344-2557"><a href="#cb344-2557" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-2558"><a href="#cb344-2558" aria-hidden="true" tabindex="-1"></a>coef_adver <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="fu">names</span>(adver_lm_models), <span class="cf">function</span>(name) {</span>
<span id="cb344-2559"><a href="#cb344-2559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(adver_lm_models[[name]]) <span class="sc">%&gt;%</span></span>
<span id="cb344-2560"><a href="#cb344-2560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> name)</span>
<span id="cb344-2561"><a href="#cb344-2561" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb344-2562"><a href="#cb344-2562" aria-hidden="true" tabindex="-1"></a>coef_adver_clean <span class="ot">&lt;-</span> coef_adver <span class="sc">%&gt;%</span></span>
<span id="cb344-2563"><a href="#cb344-2563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Intercept|congress"</span>, term))</span>
<span id="cb344-2564"><a href="#cb344-2564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2565"><a href="#cb344-2565" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-2566"><a href="#cb344-2566" aria-hidden="true" tabindex="-1"></a>coef_legis <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="fu">names</span>(legis_lm_models), <span class="cf">function</span>(name) {</span>
<span id="cb344-2567"><a href="#cb344-2567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(adver_lm_models[[name]]) <span class="sc">%&gt;%</span></span>
<span id="cb344-2568"><a href="#cb344-2568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> name)</span>
<span id="cb344-2569"><a href="#cb344-2569" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb344-2570"><a href="#cb344-2570" aria-hidden="true" tabindex="-1"></a>coef_legis_clean <span class="ot">&lt;-</span> coef_legis <span class="sc">%&gt;%</span></span>
<span id="cb344-2571"><a href="#cb344-2571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Intercept|congress"</span>, term))</span>
<span id="cb344-2572"><a href="#cb344-2572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2573"><a href="#cb344-2573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2574"><a href="#cb344-2574" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- estimate and 95% CI -----</span></span>
<span id="cb344-2575"><a href="#cb344-2575" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coef_adver_clean, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(model, estimate))) <span class="sc">+</span></span>
<span id="cb344-2576"><a href="#cb344-2576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2577"><a href="#cb344-2577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb344-2578"><a href="#cb344-2578" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error),</span>
<span id="cb344-2579"><a href="#cb344-2579" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2580"><a href="#cb344-2580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb344-2581"><a href="#cb344-2581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-2582"><a href="#cb344-2582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-2583"><a href="#cb344-2583" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Coefficient Estimates Across Models"</span>,</span>
<span id="cb344-2584"><a href="#cb344-2584" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate (with 95% CI)"</span>,</span>
<span id="cb344-2585"><a href="#cb344-2585" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictor Variable"</span></span>
<span id="cb344-2586"><a href="#cb344-2586" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-2587"><a href="#cb344-2587" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"adver_logit_single_coefficient.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-2588"><a href="#cb344-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2589"><a href="#cb344-2589" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coef_legis_clean, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(model, estimate))) <span class="sc">+</span></span>
<span id="cb344-2590"><a href="#cb344-2590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2591"><a href="#cb344-2591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb344-2592"><a href="#cb344-2592" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error),</span>
<span id="cb344-2593"><a href="#cb344-2593" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2594"><a href="#cb344-2594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb344-2595"><a href="#cb344-2595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-2596"><a href="#cb344-2596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-2597"><a href="#cb344-2597" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Coefficient Estimates Across Models"</span>,</span>
<span id="cb344-2598"><a href="#cb344-2598" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate (with 95% CI)"</span>,</span>
<span id="cb344-2599"><a href="#cb344-2599" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictor Variable"</span></span>
<span id="cb344-2600"><a href="#cb344-2600" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-2601"><a href="#cb344-2601" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"legis_logit_single_coefficient.png"</span>, <span class="at">plot =</span> p1, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-2602"><a href="#cb344-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2603"><a href="#cb344-2603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2604"><a href="#cb344-2604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2605"><a href="#cb344-2605" aria-hidden="true" tabindex="-1"></a><span class="fu">## dependent variables: dom_percentage </span></span>
<span id="cb344-2606"><a href="#cb344-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2607"><a href="#cb344-2607" aria-hidden="true" tabindex="-1"></a><span class="fu">### multiple variables regression model</span></span>
<span id="cb344-2608"><a href="#cb344-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2609"><a href="#cb344-2609" aria-hidden="true" tabindex="-1"></a>lasso</span>
<span id="cb344-2610"><a href="#cb344-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2613"><a href="#cb344-2613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2614"><a href="#cb344-2614" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage lm mul1</span></span>
<span id="cb344-2615"><a href="#cb344-2615" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2616"><a href="#cb344-2616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2617"><a href="#cb344-2617" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-2618"><a href="#cb344-2618" aria-hidden="true" tabindex="-1"></a>cv_lasso_adver1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2619"><a href="#cb344-2619" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adver_cg,</span>
<span id="cb344-2620"><a href="#cb344-2620" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2621"><a href="#cb344-2621" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb344-2622"><a href="#cb344-2622" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2623"><a href="#cb344-2623" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2624"><a href="#cb344-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2625"><a href="#cb344-2625" aria-hidden="true" tabindex="-1"></a>cv_ridge_adver1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2626"><a href="#cb344-2626" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adver_cg,</span>
<span id="cb344-2627"><a href="#cb344-2627" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2628"><a href="#cb344-2628" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb344-2629"><a href="#cb344-2629" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2630"><a href="#cb344-2630" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2631"><a href="#cb344-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2632"><a href="#cb344-2632" aria-hidden="true" tabindex="-1"></a>cv_elnet_adver1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2633"><a href="#cb344-2633" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adver_cg,</span>
<span id="cb344-2634"><a href="#cb344-2634" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2635"><a href="#cb344-2635" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb344-2636"><a href="#cb344-2636" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2637"><a href="#cb344-2637" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2638"><a href="#cb344-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2639"><a href="#cb344-2639" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-2640"><a href="#cb344-2640" aria-hidden="true" tabindex="-1"></a>cv_lasso_legis1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2641"><a href="#cb344-2641" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> legis_cg,</span>
<span id="cb344-2642"><a href="#cb344-2642" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2643"><a href="#cb344-2643" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb344-2644"><a href="#cb344-2644" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2645"><a href="#cb344-2645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2646"><a href="#cb344-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2647"><a href="#cb344-2647" aria-hidden="true" tabindex="-1"></a>cv_ridge_legis1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2648"><a href="#cb344-2648" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> legis_cg,</span>
<span id="cb344-2649"><a href="#cb344-2649" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2650"><a href="#cb344-2650" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb344-2651"><a href="#cb344-2651" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2652"><a href="#cb344-2652" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2653"><a href="#cb344-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2654"><a href="#cb344-2654" aria-hidden="true" tabindex="-1"></a>cv_elnet_legis1 <span class="ot">&lt;-</span> <span class="fu">run_glmnet_selection</span>(</span>
<span id="cb344-2655"><a href="#cb344-2655" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> legis_cg,</span>
<span id="cb344-2656"><a href="#cb344-2656" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> dom_percentage <span class="sc">~</span> age <span class="sc">+</span> is.republican <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> gender <span class="sc">+</span> seniority <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-2657"><a href="#cb344-2657" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb344-2658"><a href="#cb344-2658" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>  </span>
<span id="cb344-2659"><a href="#cb344-2659" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2660"><a href="#cb344-2660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2661"><a href="#cb344-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2662"><a href="#cb344-2662" aria-hidden="true" tabindex="-1"></a>models training - adver</span>
<span id="cb344-2663"><a href="#cb344-2663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2666"><a href="#cb344-2666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2667"><a href="#cb344-2667" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage lm mul2</span></span>
<span id="cb344-2668"><a href="#cb344-2668" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2669"><a href="#cb344-2669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2670"><a href="#cb344-2670" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb344-2671"><a href="#cb344-2671" aria-hidden="true" tabindex="-1"></a>adver_lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2672"><a href="#cb344-2672" aria-hidden="true" tabindex="-1"></a>                     is.republican <span class="sc">+</span> ideology <span class="sc">+</span> seniority<span class="sc">+</span> </span>
<span id="cb344-2673"><a href="#cb344-2673" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span> </span>
<span id="cb344-2674"><a href="#cb344-2674" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2675"><a href="#cb344-2675" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2676"><a href="#cb344-2676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2677"><a href="#cb344-2677" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted</span></span>
<span id="cb344-2678"><a href="#cb344-2678" aria-hidden="true" tabindex="-1"></a>adver_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2679"><a href="#cb344-2679" aria-hidden="true" tabindex="-1"></a>                     is.republican <span class="sc">+</span> </span>
<span id="cb344-2680"><a href="#cb344-2680" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2681"><a href="#cb344-2681" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2682"><a href="#cb344-2682" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2683"><a href="#cb344-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2684"><a href="#cb344-2684" aria-hidden="true" tabindex="-1"></a>adver_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2685"><a href="#cb344-2685" aria-hidden="true" tabindex="-1"></a>                     ideology <span class="sc">+</span> </span>
<span id="cb344-2686"><a href="#cb344-2686" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2687"><a href="#cb344-2687" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2688"><a href="#cb344-2688" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2689"><a href="#cb344-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2690"><a href="#cb344-2690" aria-hidden="true" tabindex="-1"></a>adver_lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span> </span>
<span id="cb344-2691"><a href="#cb344-2691" aria-hidden="true" tabindex="-1"></a>                     ideology <span class="sc">+</span> </span>
<span id="cb344-2692"><a href="#cb344-2692" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2693"><a href="#cb344-2693" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2694"><a href="#cb344-2694" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2695"><a href="#cb344-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2696"><a href="#cb344-2696" aria-hidden="true" tabindex="-1"></a>adver_lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span> </span>
<span id="cb344-2697"><a href="#cb344-2697" aria-hidden="true" tabindex="-1"></a>                     is.republican <span class="sc">+</span> </span>
<span id="cb344-2698"><a href="#cb344-2698" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2699"><a href="#cb344-2699" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2700"><a href="#cb344-2700" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2701"><a href="#cb344-2701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2702"><a href="#cb344-2702" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2703"><a href="#cb344-2703" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2704"><a href="#cb344-2704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2705"><a href="#cb344-2705" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adver LM"</span> <span class="ot">=</span> adver_lm0,</span>
<span id="cb344-2706"><a href="#cb344-2706" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> adver_lm1,</span>
<span id="cb344-2707"><a href="#cb344-2707" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> adver_lm2,</span>
<span id="cb344-2708"><a href="#cb344-2708" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> adver_lm3,</span>
<span id="cb344-2709"><a href="#cb344-2709" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> adver_lm4</span>
<span id="cb344-2710"><a href="#cb344-2710" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2711"><a href="#cb344-2711" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2712"><a href="#cb344-2712" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2713"><a href="#cb344-2713" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"lmmodels_adver_dom.html"</span>,</span>
<span id="cb344-2714"><a href="#cb344-2714" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb344-2715"><a href="#cb344-2715" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2716"><a href="#cb344-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2717"><a href="#cb344-2717" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- vif check ----</span></span>
<span id="cb344-2718"><a href="#cb344-2718" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_lm0)</span>
<span id="cb344-2719"><a href="#cb344-2719" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_lm1)</span>
<span id="cb344-2720"><a href="#cb344-2720" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_lm2)</span>
<span id="cb344-2721"><a href="#cb344-2721" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_lm3)</span>
<span id="cb344-2722"><a href="#cb344-2722" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(adver_lm4)</span>
<span id="cb344-2723"><a href="#cb344-2723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2724"><a href="#cb344-2724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2725"><a href="#cb344-2725" aria-hidden="true" tabindex="-1"></a>models training - legis</span>
<span id="cb344-2726"><a href="#cb344-2726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2729"><a href="#cb344-2729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2730"><a href="#cb344-2730" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage lm mul3</span></span>
<span id="cb344-2731"><a href="#cb344-2731" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2732"><a href="#cb344-2732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2733"><a href="#cb344-2733" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb344-2734"><a href="#cb344-2734" aria-hidden="true" tabindex="-1"></a>legis_lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2735"><a href="#cb344-2735" aria-hidden="true" tabindex="-1"></a>                     is.republican <span class="sc">+</span> ideology <span class="sc">+</span> seniority<span class="sc">+</span> </span>
<span id="cb344-2736"><a href="#cb344-2736" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span> </span>
<span id="cb344-2737"><a href="#cb344-2737" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2738"><a href="#cb344-2738" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2739"><a href="#cb344-2739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2740"><a href="#cb344-2740" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted</span></span>
<span id="cb344-2741"><a href="#cb344-2741" aria-hidden="true" tabindex="-1"></a>legis_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2742"><a href="#cb344-2742" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span> is.republican </span>
<span id="cb344-2743"><a href="#cb344-2743" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span> <span class="fu">as.factor</span>(congress),   <span class="at">data =</span> legis_cg )</span>
<span id="cb344-2744"><a href="#cb344-2744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2745"><a href="#cb344-2745" aria-hidden="true" tabindex="-1"></a>legis_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> </span>
<span id="cb344-2746"><a href="#cb344-2746" aria-hidden="true" tabindex="-1"></a>                     ideology <span class="sc">+</span> </span>
<span id="cb344-2747"><a href="#cb344-2747" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2748"><a href="#cb344-2748" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2749"><a href="#cb344-2749" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2750"><a href="#cb344-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2751"><a href="#cb344-2751" aria-hidden="true" tabindex="-1"></a>legis_lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span> </span>
<span id="cb344-2752"><a href="#cb344-2752" aria-hidden="true" tabindex="-1"></a>                     ideology <span class="sc">+</span> </span>
<span id="cb344-2753"><a href="#cb344-2753" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2754"><a href="#cb344-2754" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2755"><a href="#cb344-2755" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2756"><a href="#cb344-2756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2757"><a href="#cb344-2757" aria-hidden="true" tabindex="-1"></a>legis_lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span> </span>
<span id="cb344-2758"><a href="#cb344-2758" aria-hidden="true" tabindex="-1"></a>                     is.republican <span class="sc">+</span> </span>
<span id="cb344-2759"><a href="#cb344-2759" aria-hidden="true" tabindex="-1"></a>                     chamber <span class="sc">+</span> gender <span class="sc">+</span></span>
<span id="cb344-2760"><a href="#cb344-2760" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2761"><a href="#cb344-2761" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2762"><a href="#cb344-2762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2763"><a href="#cb344-2763" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2764"><a href="#cb344-2764" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2765"><a href="#cb344-2765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2766"><a href="#cb344-2766" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Legis LM"</span> <span class="ot">=</span> legis_lm0,</span>
<span id="cb344-2767"><a href="#cb344-2767" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> legis_lm1,</span>
<span id="cb344-2768"><a href="#cb344-2768" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> legis_lm2,</span>
<span id="cb344-2769"><a href="#cb344-2769" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> legis_lm3,</span>
<span id="cb344-2770"><a href="#cb344-2770" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> legis_lm4</span>
<span id="cb344-2771"><a href="#cb344-2771" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2772"><a href="#cb344-2772" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2773"><a href="#cb344-2773" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2774"><a href="#cb344-2774" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"lmmodels_legis_dom.html"</span>,</span>
<span id="cb344-2775"><a href="#cb344-2775" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb344-2776"><a href="#cb344-2776" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2777"><a href="#cb344-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2778"><a href="#cb344-2778" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- vif check ----</span></span>
<span id="cb344-2779"><a href="#cb344-2779" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_lm0)</span>
<span id="cb344-2780"><a href="#cb344-2780" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_lm1)</span>
<span id="cb344-2781"><a href="#cb344-2781" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_lm2)</span>
<span id="cb344-2782"><a href="#cb344-2782" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_lm3)</span>
<span id="cb344-2783"><a href="#cb344-2783" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(legis_lm4)</span>
<span id="cb344-2784"><a href="#cb344-2784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2785"><a href="#cb344-2785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2786"><a href="#cb344-2786" aria-hidden="true" tabindex="-1"></a>adver_lm0 marginal effects</span>
<span id="cb344-2787"><a href="#cb344-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2790"><a href="#cb344-2790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2791"><a href="#cb344-2791" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage marginal effects adver</span></span>
<span id="cb344-2792"><a href="#cb344-2792" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2793"><a href="#cb344-2793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2794"><a href="#cb344-2794" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取变量的预测边际效应</span></span>
<span id="cb344-2795"><a href="#cb344-2795" aria-hidden="true" tabindex="-1"></a>eff_age <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(adver_lm0, <span class="at">terms =</span> <span class="st">"age"</span>)</span>
<span id="cb344-2796"><a href="#cb344-2796" aria-hidden="true" tabindex="-1"></a>eff_ideo <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(adver_lm0, <span class="at">terms =</span> <span class="st">"ideology"</span>)</span>
<span id="cb344-2797"><a href="#cb344-2797" aria-hidden="true" tabindex="-1"></a>eff_sen <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(adver_lm0, <span class="at">terms =</span> <span class="st">"seniority"</span>)</span>
<span id="cb344-2798"><a href="#cb344-2798" aria-hidden="true" tabindex="-1"></a>eff_gender <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(adver_lm0, <span class="at">terms =</span> <span class="st">"gender"</span>)</span>
<span id="cb344-2799"><a href="#cb344-2799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2800"><a href="#cb344-2800" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology</span></span>
<span id="cb344-2801"><a href="#cb344-2801" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(eff_ideo, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb344-2802"><a href="#cb344-2802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb344-2803"><a href="#cb344-2803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb344-2804"><a href="#cb344-2804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-2805"><a href="#cb344-2805" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ideology"</span>,</span>
<span id="cb344-2806"><a href="#cb344-2806" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Domestic Percentage"</span>,</span>
<span id="cb344-2807"><a href="#cb344-2807" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Marginal Effect of Ideology on Domestic Percentage"</span></span>
<span id="cb344-2808"><a href="#cb344-2808" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-2809"><a href="#cb344-2809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb344-2810"><a href="#cb344-2810" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"ideology_marginal_effect_adver.png"</span>, <span class="at">plot =</span> p1, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-2811"><a href="#cb344-2811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2812"><a href="#cb344-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2813"><a href="#cb344-2813" aria-hidden="true" tabindex="-1"></a>legis_lm0 marginal effects</span>
<span id="cb344-2814"><a href="#cb344-2814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2817"><a href="#cb344-2817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2818"><a href="#cb344-2818" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage marginal effects legis</span></span>
<span id="cb344-2819"><a href="#cb344-2819" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2820"><a href="#cb344-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2821"><a href="#cb344-2821" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取变量的预测边际效应</span></span>
<span id="cb344-2822"><a href="#cb344-2822" aria-hidden="true" tabindex="-1"></a>eff_age1 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(legis_lm0, <span class="at">terms =</span> <span class="st">"age"</span>)</span>
<span id="cb344-2823"><a href="#cb344-2823" aria-hidden="true" tabindex="-1"></a>eff_ideo1 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(legis_lm0, <span class="at">terms =</span> <span class="st">"ideology"</span>)</span>
<span id="cb344-2824"><a href="#cb344-2824" aria-hidden="true" tabindex="-1"></a>eff_sen1 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(legis_lm0, <span class="at">terms =</span> <span class="st">"seniority"</span>)</span>
<span id="cb344-2825"><a href="#cb344-2825" aria-hidden="true" tabindex="-1"></a>eff_gender1 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(legis_lm0, <span class="at">terms =</span> <span class="st">"gender"</span>)</span>
<span id="cb344-2826"><a href="#cb344-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2827"><a href="#cb344-2827" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology</span></span>
<span id="cb344-2828"><a href="#cb344-2828" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(eff_ideo1, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb344-2829"><a href="#cb344-2829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb344-2830"><a href="#cb344-2830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb344-2831"><a href="#cb344-2831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-2832"><a href="#cb344-2832" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ideology"</span>,</span>
<span id="cb344-2833"><a href="#cb344-2833" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Domestic Percentage"</span>,</span>
<span id="cb344-2834"><a href="#cb344-2834" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Marginal Effect of Ideology on Domestic Percentage Legis"</span></span>
<span id="cb344-2835"><a href="#cb344-2835" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb344-2836"><a href="#cb344-2836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb344-2837"><a href="#cb344-2837" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"ideology_marginal_effect_legis.png"</span>, <span class="at">plot =</span> p2, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-2838"><a href="#cb344-2838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2839"><a href="#cb344-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2840"><a href="#cb344-2840" aria-hidden="true" tabindex="-1"></a><span class="fu">### single variable regression model</span></span>
<span id="cb344-2841"><a href="#cb344-2841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2842"><a href="#cb344-2842" aria-hidden="true" tabindex="-1"></a>models training - adver</span>
<span id="cb344-2843"><a href="#cb344-2843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2846"><a href="#cb344-2846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2847"><a href="#cb344-2847" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage lm sin1</span></span>
<span id="cb344-2848"><a href="#cb344-2848" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2849"><a href="#cb344-2849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2850"><a href="#cb344-2850" aria-hidden="true" tabindex="-1"></a>adver_cg_age1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span></span>
<span id="cb344-2851"><a href="#cb344-2851" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2852"><a href="#cb344-2852" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2853"><a href="#cb344-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2854"><a href="#cb344-2854" aria-hidden="true" tabindex="-1"></a>adver_cg_ideology1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> ideology <span class="sc">+</span></span>
<span id="cb344-2855"><a href="#cb344-2855" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2856"><a href="#cb344-2856" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2857"><a href="#cb344-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2858"><a href="#cb344-2858" aria-hidden="true" tabindex="-1"></a>adver_cg_is.republican1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> is.republican <span class="sc">+</span></span>
<span id="cb344-2859"><a href="#cb344-2859" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2860"><a href="#cb344-2860" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2861"><a href="#cb344-2861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2862"><a href="#cb344-2862" aria-hidden="true" tabindex="-1"></a>adver_cg_chamber1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> chamber <span class="sc">+</span></span>
<span id="cb344-2863"><a href="#cb344-2863" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2864"><a href="#cb344-2864" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2865"><a href="#cb344-2865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2866"><a href="#cb344-2866" aria-hidden="true" tabindex="-1"></a>adver_cg_gender1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> gender <span class="sc">+</span></span>
<span id="cb344-2867"><a href="#cb344-2867" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2868"><a href="#cb344-2868" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2869"><a href="#cb344-2869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2870"><a href="#cb344-2870" aria-hidden="true" tabindex="-1"></a>adver_cg_seniority1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span></span>
<span id="cb344-2871"><a href="#cb344-2871" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2872"><a href="#cb344-2872" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-2873"><a href="#cb344-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2874"><a href="#cb344-2874" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2875"><a href="#cb344-2875" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2876"><a href="#cb344-2876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2877"><a href="#cb344-2877" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> adver_cg_age1,</span>
<span id="cb344-2878"><a href="#cb344-2878" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> adver_cg_ideology1,</span>
<span id="cb344-2879"><a href="#cb344-2879" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> adver_cg_is.republican1,</span>
<span id="cb344-2880"><a href="#cb344-2880" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> adver_cg_gender1,</span>
<span id="cb344-2881"><a href="#cb344-2881" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="ot">=</span> adver_cg_chamber1,</span>
<span id="cb344-2882"><a href="#cb344-2882" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6"</span> <span class="ot">=</span> adver_cg_seniority1</span>
<span id="cb344-2883"><a href="#cb344-2883" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2884"><a href="#cb344-2884" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2885"><a href="#cb344-2885" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2886"><a href="#cb344-2886" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"lmmodel_adver_seperated_dom.html"</span>,</span>
<span id="cb344-2887"><a href="#cb344-2887" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb344-2888"><a href="#cb344-2888" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2889"><a href="#cb344-2889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2890"><a href="#cb344-2890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2891"><a href="#cb344-2891" aria-hidden="true" tabindex="-1"></a>models training - legis</span>
<span id="cb344-2892"><a href="#cb344-2892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2895"><a href="#cb344-2895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2896"><a href="#cb344-2896" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage lm sin2</span></span>
<span id="cb344-2897"><a href="#cb344-2897" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2898"><a href="#cb344-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2899"><a href="#cb344-2899" aria-hidden="true" tabindex="-1"></a>legis_cg_age1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span></span>
<span id="cb344-2900"><a href="#cb344-2900" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2901"><a href="#cb344-2901" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2902"><a href="#cb344-2902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2903"><a href="#cb344-2903" aria-hidden="true" tabindex="-1"></a>legis_cg_ideology1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> ideology <span class="sc">+</span></span>
<span id="cb344-2904"><a href="#cb344-2904" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2905"><a href="#cb344-2905" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2906"><a href="#cb344-2906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2907"><a href="#cb344-2907" aria-hidden="true" tabindex="-1"></a>legis_cg_is.republican1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> is.republican <span class="sc">+</span></span>
<span id="cb344-2908"><a href="#cb344-2908" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2909"><a href="#cb344-2909" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2910"><a href="#cb344-2910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2911"><a href="#cb344-2911" aria-hidden="true" tabindex="-1"></a>legis_cg_chamber1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> chamber <span class="sc">+</span></span>
<span id="cb344-2912"><a href="#cb344-2912" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2913"><a href="#cb344-2913" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2914"><a href="#cb344-2914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2915"><a href="#cb344-2915" aria-hidden="true" tabindex="-1"></a>legis_cg_gender1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> gender <span class="sc">+</span></span>
<span id="cb344-2916"><a href="#cb344-2916" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2917"><a href="#cb344-2917" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2918"><a href="#cb344-2918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2919"><a href="#cb344-2919" aria-hidden="true" tabindex="-1"></a>legis_cg_seniority1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> seniority <span class="sc">+</span></span>
<span id="cb344-2920"><a href="#cb344-2920" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-2921"><a href="#cb344-2921" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-2922"><a href="#cb344-2922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2923"><a href="#cb344-2923" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb344-2924"><a href="#cb344-2924" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb344-2925"><a href="#cb344-2925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb344-2926"><a href="#cb344-2926" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> legis_cg_age1,</span>
<span id="cb344-2927"><a href="#cb344-2927" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> legis_cg_ideology1,</span>
<span id="cb344-2928"><a href="#cb344-2928" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> legis_cg_is.republican1,</span>
<span id="cb344-2929"><a href="#cb344-2929" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> legis_cg_gender1,</span>
<span id="cb344-2930"><a href="#cb344-2930" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5"</span> <span class="ot">=</span> legis_cg_chamber1,</span>
<span id="cb344-2931"><a href="#cb344-2931" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6"</span> <span class="ot">=</span> legis_cg_seniority1</span>
<span id="cb344-2932"><a href="#cb344-2932" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb344-2933"><a href="#cb344-2933" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">3</span>,</span>
<span id="cb344-2934"><a href="#cb344-2934" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb344-2935"><a href="#cb344-2935" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"lmmodel_legis_seperated_dom.html"</span>,</span>
<span id="cb344-2936"><a href="#cb344-2936" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb344-2937"><a href="#cb344-2937" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2938"><a href="#cb344-2938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-2939"><a href="#cb344-2939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2940"><a href="#cb344-2940" aria-hidden="true" tabindex="-1"></a>single variable model coefficient plot</span>
<span id="cb344-2941"><a href="#cb344-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2944"><a href="#cb344-2944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-2945"><a href="#cb344-2945" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage coefficient plot</span></span>
<span id="cb344-2946"><a href="#cb344-2946" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-2947"><a href="#cb344-2947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2948"><a href="#cb344-2948" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- model lists -----</span></span>
<span id="cb344-2949"><a href="#cb344-2949" aria-hidden="true" tabindex="-1"></a>adver_lm_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2950"><a href="#cb344-2950" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> adver_cg_age1,</span>
<span id="cb344-2951"><a href="#cb344-2951" aria-hidden="true" tabindex="-1"></a>  <span class="at">ideology =</span> adver_cg_ideology1,</span>
<span id="cb344-2952"><a href="#cb344-2952" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_republican =</span> adver_cg_is.republican1,</span>
<span id="cb344-2953"><a href="#cb344-2953" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> adver_cg_gender1,</span>
<span id="cb344-2954"><a href="#cb344-2954" aria-hidden="true" tabindex="-1"></a>  <span class="at">chamber =</span> adver_cg_chamber1,</span>
<span id="cb344-2955"><a href="#cb344-2955" aria-hidden="true" tabindex="-1"></a>  <span class="at">seniority =</span> adver_cg_seniority1</span>
<span id="cb344-2956"><a href="#cb344-2956" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2957"><a href="#cb344-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2958"><a href="#cb344-2958" aria-hidden="true" tabindex="-1"></a>legis_lm_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-2959"><a href="#cb344-2959" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> legis_cg_age1,</span>
<span id="cb344-2960"><a href="#cb344-2960" aria-hidden="true" tabindex="-1"></a>  <span class="at">ideology =</span> legis_cg_ideology1,</span>
<span id="cb344-2961"><a href="#cb344-2961" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_republican =</span> legis_cg_is.republican1,</span>
<span id="cb344-2962"><a href="#cb344-2962" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> legis_cg_gender1,</span>
<span id="cb344-2963"><a href="#cb344-2963" aria-hidden="true" tabindex="-1"></a>  <span class="at">chamber =</span> legis_cg_chamber1,</span>
<span id="cb344-2964"><a href="#cb344-2964" aria-hidden="true" tabindex="-1"></a>  <span class="at">seniority =</span> legis_cg_seniority1</span>
<span id="cb344-2965"><a href="#cb344-2965" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-2966"><a href="#cb344-2966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2967"><a href="#cb344-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2968"><a href="#cb344-2968" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- extract coefficient and clean -----</span></span>
<span id="cb344-2969"><a href="#cb344-2969" aria-hidden="true" tabindex="-1"></a><span class="co"># adver</span></span>
<span id="cb344-2970"><a href="#cb344-2970" aria-hidden="true" tabindex="-1"></a>coef_adver <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="fu">names</span>(adver_lm_models), <span class="cf">function</span>(name) {</span>
<span id="cb344-2971"><a href="#cb344-2971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(adver_lm_models[[name]]) <span class="sc">%&gt;%</span></span>
<span id="cb344-2972"><a href="#cb344-2972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> name)</span>
<span id="cb344-2973"><a href="#cb344-2973" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb344-2974"><a href="#cb344-2974" aria-hidden="true" tabindex="-1"></a>coef_adver_clean <span class="ot">&lt;-</span> coef_adver <span class="sc">%&gt;%</span></span>
<span id="cb344-2975"><a href="#cb344-2975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Intercept|congress"</span>, term))</span>
<span id="cb344-2976"><a href="#cb344-2976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2977"><a href="#cb344-2977" aria-hidden="true" tabindex="-1"></a><span class="co"># legis</span></span>
<span id="cb344-2978"><a href="#cb344-2978" aria-hidden="true" tabindex="-1"></a>coef_legis <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="fu">names</span>(legis_lm_models), <span class="cf">function</span>(name) {</span>
<span id="cb344-2979"><a href="#cb344-2979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(adver_lm_models[[name]]) <span class="sc">%&gt;%</span></span>
<span id="cb344-2980"><a href="#cb344-2980" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> name)</span>
<span id="cb344-2981"><a href="#cb344-2981" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb344-2982"><a href="#cb344-2982" aria-hidden="true" tabindex="-1"></a>coef_legis_clean <span class="ot">&lt;-</span> coef_legis <span class="sc">%&gt;%</span></span>
<span id="cb344-2983"><a href="#cb344-2983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Intercept|congress"</span>, term))</span>
<span id="cb344-2984"><a href="#cb344-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2985"><a href="#cb344-2985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2986"><a href="#cb344-2986" aria-hidden="true" tabindex="-1"></a><span class="co"># ----- estimate and 95% CI -----</span></span>
<span id="cb344-2987"><a href="#cb344-2987" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coef_adver_clean, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(model, estimate))) <span class="sc">+</span></span>
<span id="cb344-2988"><a href="#cb344-2988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2989"><a href="#cb344-2989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb344-2990"><a href="#cb344-2990" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error),</span>
<span id="cb344-2991"><a href="#cb344-2991" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-2992"><a href="#cb344-2992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb344-2993"><a href="#cb344-2993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-2994"><a href="#cb344-2994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-2995"><a href="#cb344-2995" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Coefficient Estimates Across Models"</span>,</span>
<span id="cb344-2996"><a href="#cb344-2996" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate (with 95% CI)"</span>,</span>
<span id="cb344-2997"><a href="#cb344-2997" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictor Variable"</span></span>
<span id="cb344-2998"><a href="#cb344-2998" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-2999"><a href="#cb344-2999" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"adver_lm_single_coefficient.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-3000"><a href="#cb344-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3001"><a href="#cb344-3001" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coef_legis_clean, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(model, estimate))) <span class="sc">+</span></span>
<span id="cb344-3002"><a href="#cb344-3002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-3003"><a href="#cb344-3003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb344-3004"><a href="#cb344-3004" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xmax =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error),</span>
<span id="cb344-3005"><a href="#cb344-3005" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"#2c7fb8"</span>) <span class="sc">+</span></span>
<span id="cb344-3006"><a href="#cb344-3006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb344-3007"><a href="#cb344-3007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb344-3008"><a href="#cb344-3008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb344-3009"><a href="#cb344-3009" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Coefficient Estimates Across Models"</span>,</span>
<span id="cb344-3010"><a href="#cb344-3010" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate (with 95% CI)"</span>,</span>
<span id="cb344-3011"><a href="#cb344-3011" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictor Variable"</span></span>
<span id="cb344-3012"><a href="#cb344-3012" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb344-3013"><a href="#cb344-3013" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"legis_lm_single_coefficient.png"</span>, <span class="at">plot =</span> p1, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-3014"><a href="#cb344-3014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3015"><a href="#cb344-3015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-3016"><a href="#cb344-3016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3017"><a href="#cb344-3017" aria-hidden="true" tabindex="-1"></a><span class="fu">### robustness check</span></span>
<span id="cb344-3018"><a href="#cb344-3018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3021"><a href="#cb344-3021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-3022"><a href="#cb344-3022" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage robust check</span></span>
<span id="cb344-3023"><a href="#cb344-3023" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-3024"><a href="#cb344-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3025"><a href="#cb344-3025" aria-hidden="true" tabindex="-1"></a><span class="co"># 批量生成线性模型的诊断图</span></span>
<span id="cb344-3026"><a href="#cb344-3026" aria-hidden="true" tabindex="-1"></a>plot_lm_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_list, <span class="at">output_dir =</span> <span class="st">"lm_diagnostics_plots"</span>) {</span>
<span id="cb344-3027"><a href="#cb344-3027" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb344-3028"><a href="#cb344-3028" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(output_dir)) {</span>
<span id="cb344-3029"><a href="#cb344-3029" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(output_dir)</span>
<span id="cb344-3030"><a href="#cb344-3030" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-3031"><a href="#cb344-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3032"><a href="#cb344-3032" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(model_list)) {</span>
<span id="cb344-3033"><a href="#cb344-3033" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> model_list[[model_name]]</span>
<span id="cb344-3034"><a href="#cb344-3034" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb344-3035"><a href="#cb344-3035" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. QQ Plot</span></span>
<span id="cb344-3036"><a href="#cb344-3036" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(model, <span class="fu">aes</span>(<span class="at">sample =</span> .stdresid)) <span class="sc">+</span></span>
<span id="cb344-3037"><a href="#cb344-3037" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb344-3038"><a href="#cb344-3038" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"QQ Plot - "</span>, model_name),</span>
<span id="cb344-3039"><a href="#cb344-3039" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>) <span class="sc">+</span></span>
<span id="cb344-3040"><a href="#cb344-3040" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb344-3041"><a href="#cb344-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3042"><a href="#cb344-3042" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. 残差 vs 拟合值</span></span>
<span id="cb344-3043"><a href="#cb344-3043" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">augment</span>(model)</span>
<span id="cb344-3044"><a href="#cb344-3044" aria-hidden="true" tabindex="-1"></a>    p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(.fitted, .resid)) <span class="sc">+</span></span>
<span id="cb344-3045"><a href="#cb344-3045" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb344-3046"><a href="#cb344-3046" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb344-3047"><a href="#cb344-3047" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb344-3048"><a href="#cb344-3048" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Residuals vs Fitted - "</span>, model_name),</span>
<span id="cb344-3049"><a href="#cb344-3049" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>) <span class="sc">+</span></span>
<span id="cb344-3050"><a href="#cb344-3050" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb344-3051"><a href="#cb344-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3052"><a href="#cb344-3052" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Cook's Distance</span></span>
<span id="cb344-3053"><a href="#cb344-3053" aria-hidden="true" tabindex="-1"></a>    p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="fu">seq_along</span>(.cooksd), .cooksd)) <span class="sc">+</span></span>
<span id="cb344-3054"><a href="#cb344-3054" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"tomato"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb344-3055"><a href="#cb344-3055" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Cook's Distance - "</span>, model_name),</span>
<span id="cb344-3056"><a href="#cb344-3056" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Observation"</span>, <span class="at">y =</span> <span class="st">"Cook's D"</span>) <span class="sc">+</span></span>
<span id="cb344-3057"><a href="#cb344-3057" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb344-3058"><a href="#cb344-3058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3059"><a href="#cb344-3059" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. 杠杆图</span></span>
<span id="cb344-3060"><a href="#cb344-3060" aria-hidden="true" tabindex="-1"></a>    p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(.hat, .std.resid)) <span class="sc">+</span></span>
<span id="cb344-3061"><a href="#cb344-3061" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb344-3062"><a href="#cb344-3062" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb344-3063"><a href="#cb344-3063" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Leverage vs Std Residuals - "</span>, model_name),</span>
<span id="cb344-3064"><a href="#cb344-3064" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Leverage"</span>, <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>) <span class="sc">+</span></span>
<span id="cb344-3065"><a href="#cb344-3065" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb344-3066"><a href="#cb344-3066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3067"><a href="#cb344-3067" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 合并图像</span></span>
<span id="cb344-3068"><a href="#cb344-3068" aria-hidden="true" tabindex="-1"></a>    combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4)</span>
<span id="cb344-3069"><a href="#cb344-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3070"><a href="#cb344-3070" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 保存</span></span>
<span id="cb344-3071"><a href="#cb344-3071" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(output_dir, <span class="fu">paste0</span>(<span class="st">"diagnostic_"</span>, model_name, <span class="st">".png"</span>)),</span>
<span id="cb344-3072"><a href="#cb344-3072" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot =</span> combined_plot,</span>
<span id="cb344-3073"><a href="#cb344-3073" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb344-3074"><a href="#cb344-3074" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb344-3075"><a href="#cb344-3075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3076"><a href="#cb344-3076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"所有诊断图已保存至："</span>, output_dir, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb344-3077"><a href="#cb344-3077" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-3078"><a href="#cb344-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3079"><a href="#cb344-3079" aria-hidden="true" tabindex="-1"></a><span class="co"># 调用</span></span>
<span id="cb344-3080"><a href="#cb344-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3081"><a href="#cb344-3081" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建模型列表</span></span>
<span id="cb344-3082"><a href="#cb344-3082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3083"><a href="#cb344-3083" aria-hidden="true" tabindex="-1"></a>model_adver_lm_dom_multiple <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-3084"><a href="#cb344-3084" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom0"</span> <span class="ot">=</span> adver_lm0,</span>
<span id="cb344-3085"><a href="#cb344-3085" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom1"</span> <span class="ot">=</span> adver_lm1,</span>
<span id="cb344-3086"><a href="#cb344-3086" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom2"</span> <span class="ot">=</span> adver_lm2,</span>
<span id="cb344-3087"><a href="#cb344-3087" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom3"</span> <span class="ot">=</span> adver_lm3,</span>
<span id="cb344-3088"><a href="#cb344-3088" aria-hidden="true" tabindex="-1"></a>  <span class="st">"adver_dom4"</span> <span class="ot">=</span> adver_lm4</span>
<span id="cb344-3089"><a href="#cb344-3089" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-3090"><a href="#cb344-3090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3091"><a href="#cb344-3091" aria-hidden="true" tabindex="-1"></a>models_adver_lm_dom <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-3092"><a href="#cb344-3092" aria-hidden="true" tabindex="-1"></a>  <span class="st">"age_dom"</span> <span class="ot">=</span> adver_cg_age1,</span>
<span id="cb344-3093"><a href="#cb344-3093" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ideology_dom"</span> <span class="ot">=</span> adver_cg_ideology1,</span>
<span id="cb344-3094"><a href="#cb344-3094" aria-hidden="true" tabindex="-1"></a>  <span class="st">"is.republican_dom"</span> <span class="ot">=</span> adver_cg_is.republican1,</span>
<span id="cb344-3095"><a href="#cb344-3095" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gender_dom"</span> <span class="ot">=</span> adver_cg_gender1,</span>
<span id="cb344-3096"><a href="#cb344-3096" aria-hidden="true" tabindex="-1"></a>  <span class="st">"chamber_dom"</span> <span class="ot">=</span> adver_cg_chamber1,</span>
<span id="cb344-3097"><a href="#cb344-3097" aria-hidden="true" tabindex="-1"></a>  <span class="st">"seniority_dom"</span> <span class="ot">=</span> adver_cg_seniority1</span>
<span id="cb344-3098"><a href="#cb344-3098" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-3099"><a href="#cb344-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3100"><a href="#cb344-3100" aria-hidden="true" tabindex="-1"></a>model_legis_lm_dom_multiple <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-3101"><a href="#cb344-3101" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom"</span> <span class="ot">=</span> legis_lm0,</span>
<span id="cb344-3102"><a href="#cb344-3102" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom1"</span> <span class="ot">=</span> legis_lm1,</span>
<span id="cb344-3103"><a href="#cb344-3103" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom2"</span> <span class="ot">=</span> legis_lm2,</span>
<span id="cb344-3104"><a href="#cb344-3104" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom3"</span> <span class="ot">=</span> legis_lm3,</span>
<span id="cb344-3105"><a href="#cb344-3105" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_dom4"</span> <span class="ot">=</span> legis_lm4</span>
<span id="cb344-3106"><a href="#cb344-3106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-3107"><a href="#cb344-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3108"><a href="#cb344-3108" aria-hidden="true" tabindex="-1"></a>models_legis_lm_dom <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb344-3109"><a href="#cb344-3109" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_age_dom"</span> <span class="ot">=</span> legis_cg_age1,</span>
<span id="cb344-3110"><a href="#cb344-3110" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_ideology_dom"</span> <span class="ot">=</span> legis_cg_ideology1,</span>
<span id="cb344-3111"><a href="#cb344-3111" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_is.republican_dom"</span> <span class="ot">=</span> legis_cg_is.republican1,</span>
<span id="cb344-3112"><a href="#cb344-3112" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_gender_dom"</span> <span class="ot">=</span> legis_cg_gender1,</span>
<span id="cb344-3113"><a href="#cb344-3113" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_chamber_dom"</span> <span class="ot">=</span> legis_cg_chamber1,</span>
<span id="cb344-3114"><a href="#cb344-3114" aria-hidden="true" tabindex="-1"></a>  <span class="st">"legis_seniority_dom"</span> <span class="ot">=</span> legis_cg_seniority1</span>
<span id="cb344-3115"><a href="#cb344-3115" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb344-3116"><a href="#cb344-3116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3117"><a href="#cb344-3117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3118"><a href="#cb344-3118" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行函数</span></span>
<span id="cb344-3119"><a href="#cb344-3119" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_diagnostics</span>(model_adver_lm_dom_multiple)</span>
<span id="cb344-3120"><a href="#cb344-3120" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_diagnostics</span>(model_legis_lm_dom_multiple)</span>
<span id="cb344-3121"><a href="#cb344-3121" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_diagnostics</span>(models_adver_lm_dom)</span>
<span id="cb344-3122"><a href="#cb344-3122" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_diagnostics</span>(models_legis_lm_dom)</span>
<span id="cb344-3123"><a href="#cb344-3123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3124"><a href="#cb344-3124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-3125"><a href="#cb344-3125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3126"><a href="#cb344-3126" aria-hidden="true" tabindex="-1"></a><span class="fu">## interaction model</span></span>
<span id="cb344-3127"><a href="#cb344-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3128"><a href="#cb344-3128" aria-hidden="true" tabindex="-1"></a><span class="fu">### dependent variable: is.dom</span></span>
<span id="cb344-3129"><a href="#cb344-3129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3130"><a href="#cb344-3130" aria-hidden="true" tabindex="-1"></a>adver</span>
<span id="cb344-3131"><a href="#cb344-3131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3134"><a href="#cb344-3134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-3135"><a href="#cb344-3135" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom interaction adver</span></span>
<span id="cb344-3136"><a href="#cb344-3136" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-3137"><a href="#cb344-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3138"><a href="#cb344-3138" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * gender</span></span>
<span id="cb344-3139"><a href="#cb344-3139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3140"><a href="#cb344-3140" aria-hidden="true" tabindex="-1"></a>adver_inter1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> is.republican <span class="sc">+</span> chamber <span class="sc">+</span> ideology<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3141"><a href="#cb344-3141" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-3142"><a href="#cb344-3142" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3143"><a href="#cb344-3143" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(adver_inter1)</span>
<span id="cb344-3144"><a href="#cb344-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3145"><a href="#cb344-3145" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * gender</span></span>
<span id="cb344-3146"><a href="#cb344-3146" aria-hidden="true" tabindex="-1"></a>adver_inter2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> is.republican <span class="sc">+</span> gender <span class="sc">+</span> chamber<span class="sc">*</span>ideology <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3147"><a href="#cb344-3147" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-3148"><a href="#cb344-3148" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3149"><a href="#cb344-3149" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(adver_inter2)</span>
<span id="cb344-3150"><a href="#cb344-3150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3151"><a href="#cb344-3151" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * gender</span></span>
<span id="cb344-3152"><a href="#cb344-3152" aria-hidden="true" tabindex="-1"></a>adver_inter3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> is.republican<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3153"><a href="#cb344-3153" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-3154"><a href="#cb344-3154" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3155"><a href="#cb344-3155" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter3)</span>
<span id="cb344-3156"><a href="#cb344-3156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3157"><a href="#cb344-3157" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * chamber</span></span>
<span id="cb344-3158"><a href="#cb344-3158" aria-hidden="true" tabindex="-1"></a>adver_inter4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> gender <span class="sc">+</span> is.republican<span class="sc">*</span>chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3159"><a href="#cb344-3159" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg, </span>
<span id="cb344-3160"><a href="#cb344-3160" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3161"><a href="#cb344-3161" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter4)</span>
<span id="cb344-3162"><a href="#cb344-3162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3163"><a href="#cb344-3163" aria-hidden="true" tabindex="-1"></a><span class="co"># effects</span></span>
<span id="cb344-3164"><a href="#cb344-3164" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3165"><a href="#cb344-3165" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(adver_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender)</span>
<span id="cb344-3166"><a href="#cb344-3166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3167"><a href="#cb344-3167" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3168"><a href="#cb344-3168" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(adver_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber)</span>
<span id="cb344-3169"><a href="#cb344-3169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3170"><a href="#cb344-3170" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3171"><a href="#cb344-3171" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(adver_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender)</span>
<span id="cb344-3172"><a href="#cb344-3172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3173"><a href="#cb344-3173" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3174"><a href="#cb344-3174" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(adver_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber)</span>
<span id="cb344-3175"><a href="#cb344-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3176"><a href="#cb344-3176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3177"><a href="#cb344-3177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-3178"><a href="#cb344-3178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3179"><a href="#cb344-3179" aria-hidden="true" tabindex="-1"></a>legis</span>
<span id="cb344-3180"><a href="#cb344-3180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3183"><a href="#cb344-3183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-3184"><a href="#cb344-3184" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: is.dom interaction legis</span></span>
<span id="cb344-3185"><a href="#cb344-3185" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-3186"><a href="#cb344-3186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3187"><a href="#cb344-3187" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * gender</span></span>
<span id="cb344-3188"><a href="#cb344-3188" aria-hidden="true" tabindex="-1"></a>legis_inter1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> is.republican <span class="sc">+</span> chamber <span class="sc">+</span> ideology<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3189"><a href="#cb344-3189" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-3190"><a href="#cb344-3190" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3191"><a href="#cb344-3191" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter1)</span>
<span id="cb344-3192"><a href="#cb344-3192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3193"><a href="#cb344-3193" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * chamber</span></span>
<span id="cb344-3194"><a href="#cb344-3194" aria-hidden="true" tabindex="-1"></a>legis_inter2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> is.republican<span class="sc">*</span>gender <span class="sc">+</span> chamber <span class="sc">+</span> ideology <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3195"><a href="#cb344-3195" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-3196"><a href="#cb344-3196" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3197"><a href="#cb344-3197" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter2)</span>
<span id="cb344-3198"><a href="#cb344-3198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3199"><a href="#cb344-3199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3200"><a href="#cb344-3200" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * gender</span></span>
<span id="cb344-3201"><a href="#cb344-3201" aria-hidden="true" tabindex="-1"></a>legis_inter3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> is.republican<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3202"><a href="#cb344-3202" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-3203"><a href="#cb344-3203" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3204"><a href="#cb344-3204" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter3)</span>
<span id="cb344-3205"><a href="#cb344-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3206"><a href="#cb344-3206" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * chamber</span></span>
<span id="cb344-3207"><a href="#cb344-3207" aria-hidden="true" tabindex="-1"></a>legis_inter4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> gender <span class="sc">+</span> is.republican<span class="sc">*</span>chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3208"><a href="#cb344-3208" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg, </span>
<span id="cb344-3209"><a href="#cb344-3209" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb344-3210"><a href="#cb344-3210" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_logit_model</span>(legis_inter4)</span>
<span id="cb344-3211"><a href="#cb344-3211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3212"><a href="#cb344-3212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3213"><a href="#cb344-3213" aria-hidden="true" tabindex="-1"></a><span class="co"># effects</span></span>
<span id="cb344-3214"><a href="#cb344-3214" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3215"><a href="#cb344-3215" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(legis_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender)</span>
<span id="cb344-3216"><a href="#cb344-3216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3217"><a href="#cb344-3217" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3218"><a href="#cb344-3218" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(legis_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber)</span>
<span id="cb344-3219"><a href="#cb344-3219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3220"><a href="#cb344-3220" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3221"><a href="#cb344-3221" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(legis_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender)</span>
<span id="cb344-3222"><a href="#cb344-3222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3223"><a href="#cb344-3223" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber, <span class="at">interval =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-3224"><a href="#cb344-3224" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_slopes</span>(legis_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber)</span>
<span id="cb344-3225"><a href="#cb344-3225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3226"><a href="#cb344-3226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-3227"><a href="#cb344-3227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3228"><a href="#cb344-3228" aria-hidden="true" tabindex="-1"></a><span class="fu">### dependent variable: dom_percentage</span></span>
<span id="cb344-3229"><a href="#cb344-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3230"><a href="#cb344-3230" aria-hidden="true" tabindex="-1"></a>adver</span>
<span id="cb344-3231"><a href="#cb344-3231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3234"><a href="#cb344-3234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-3235"><a href="#cb344-3235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage interaction adver</span></span>
<span id="cb344-3236"><a href="#cb344-3236" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-3237"><a href="#cb344-3237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3238"><a href="#cb344-3238" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * gender</span></span>
<span id="cb344-3239"><a href="#cb344-3239" aria-hidden="true" tabindex="-1"></a>adver_lm_inter1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> chamber <span class="sc">+</span> is.republican <span class="sc">+</span> ideology<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-3240"><a href="#cb344-3240" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3241"><a href="#cb344-3241" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adver_lm_inter1)</span>
<span id="cb344-3242"><a href="#cb344-3242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3243"><a href="#cb344-3243" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * chamber</span></span>
<span id="cb344-3244"><a href="#cb344-3244" aria-hidden="true" tabindex="-1"></a>adver_lm_inter2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> ideology<span class="sc">*</span>chamber <span class="sc">+</span> is.republican <span class="sc">+</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-3245"><a href="#cb344-3245" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3246"><a href="#cb344-3246" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adver_lm_inter2)</span>
<span id="cb344-3247"><a href="#cb344-3247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3248"><a href="#cb344-3248" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * gender</span></span>
<span id="cb344-3249"><a href="#cb344-3249" aria-hidden="true" tabindex="-1"></a>adver_lm_inter3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> is.republican<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3250"><a href="#cb344-3250" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3251"><a href="#cb344-3251" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adver_lm_inter3)</span>
<span id="cb344-3252"><a href="#cb344-3252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3253"><a href="#cb344-3253" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * chamber</span></span>
<span id="cb344-3254"><a href="#cb344-3254" aria-hidden="true" tabindex="-1"></a>adver_lm_inter4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> gender <span class="sc">+</span> is.republican<span class="sc">*</span>chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3255"><a href="#cb344-3255" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3256"><a href="#cb344-3256" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adver_lm_inter4)</span>
<span id="cb344-3257"><a href="#cb344-3257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3258"><a href="#cb344-3258" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- effect ----</span></span>
<span id="cb344-3259"><a href="#cb344-3259" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_lm_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3260"><a href="#cb344-3260" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_lm_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3261"><a href="#cb344-3261" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_lm_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3262"><a href="#cb344-3262" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(adver_lm_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber, <span class="at">data =</span> adver_cg)</span>
<span id="cb344-3263"><a href="#cb344-3263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb344-3264"><a href="#cb344-3264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3265"><a href="#cb344-3265" aria-hidden="true" tabindex="-1"></a>legis</span>
<span id="cb344-3266"><a href="#cb344-3266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3269"><a href="#cb344-3269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb344-3270"><a href="#cb344-3270" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dom.percentage interaction legis</span></span>
<span id="cb344-3271"><a href="#cb344-3271" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb344-3272"><a href="#cb344-3272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3273"><a href="#cb344-3273" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * gender</span></span>
<span id="cb344-3274"><a href="#cb344-3274" aria-hidden="true" tabindex="-1"></a>legis_lm_inter1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> chamber <span class="sc">+</span> is.republican <span class="sc">+</span> ideology<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-3275"><a href="#cb344-3275" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3276"><a href="#cb344-3276" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(legis_lm_inter1)</span>
<span id="cb344-3277"><a href="#cb344-3277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3278"><a href="#cb344-3278" aria-hidden="true" tabindex="-1"></a><span class="co"># ideology * chamber</span></span>
<span id="cb344-3279"><a href="#cb344-3279" aria-hidden="true" tabindex="-1"></a>legis_lm_inter2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dom_percentage <span class="sc">~</span> age <span class="sc">+</span> ideology<span class="sc">*</span>chamber <span class="sc">+</span> is.republican <span class="sc">+</span> gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress),</span>
<span id="cb344-3280"><a href="#cb344-3280" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3281"><a href="#cb344-3281" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(legis_lm_inter2)</span>
<span id="cb344-3282"><a href="#cb344-3282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3283"><a href="#cb344-3283" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * gender</span></span>
<span id="cb344-3284"><a href="#cb344-3284" aria-hidden="true" tabindex="-1"></a>legis_lm_inter3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> chamber <span class="sc">+</span> is.republican<span class="sc">*</span>gender <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3285"><a href="#cb344-3285" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3286"><a href="#cb344-3286" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(legis_lm_inter3)</span>
<span id="cb344-3287"><a href="#cb344-3287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3288"><a href="#cb344-3288" aria-hidden="true" tabindex="-1"></a><span class="co"># is.republican * chamber</span></span>
<span id="cb344-3289"><a href="#cb344-3289" aria-hidden="true" tabindex="-1"></a>legis_lm_inter4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(is.dom <span class="sc">~</span> age <span class="sc">+</span> seniority <span class="sc">+</span> ideology <span class="sc">+</span> gender <span class="sc">+</span> is.republican<span class="sc">*</span>chamber <span class="sc">+</span> <span class="fu">as.factor</span>(congress), </span>
<span id="cb344-3290"><a href="#cb344-3290" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3291"><a href="#cb344-3291" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(legis_lm_inter4)</span>
<span id="cb344-3292"><a href="#cb344-3292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3293"><a href="#cb344-3293" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- effect ----</span></span>
<span id="cb344-3294"><a href="#cb344-3294" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_lm_inter1, <span class="at">pred =</span> ideology, <span class="at">modx =</span> gender, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3295"><a href="#cb344-3295" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_lm_inter2, <span class="at">pred =</span> ideology, <span class="at">modx =</span> chamber, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3296"><a href="#cb344-3296" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_lm_inter3, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> gender, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3297"><a href="#cb344-3297" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(legis_lm_inter4, <span class="at">pred =</span> is.republican, <span class="at">modx =</span> chamber, <span class="at">data =</span> legis_cg)</span>
<span id="cb344-3298"><a href="#cb344-3298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="descriptive analysis_decodingCompetition_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>